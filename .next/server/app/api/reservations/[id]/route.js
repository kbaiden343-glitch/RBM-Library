"use strict";(()=>{var e={};e.id=665,e.ids=[665],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2600:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>O,patchFetch:()=>E,requestAsyncStorage:()=>f,routeModule:()=>v,serverHooks:()=>N,staticGenerationAsyncStorage:()=>b});var o={};t.r(o),t.d(o,{DELETE:()=>p,GET:()=>d,PUT:()=>u});var n=t(9303),s=t(8716),a=t(670),i=t(7070);async function d(e,{params:r}){try{let e=await Object(function(){var e=Error("Cannot find module '../../../lib/db'");throw e.code="MODULE_NOT_FOUND",e}()).reservation.findUnique({where:{id:r.id},include:{book:!0,person:!0}});if(!e)return i.NextResponse.json({error:"Reservation not found"},{status:404});return i.NextResponse.json(e)}catch(e){return console.error("Get reservation error:",e),i.NextResponse.json({error:"Failed to fetch reservation"},{status:500})}}async function u(e,{params:r}){try{let{action:t}=await e.json();if("cancel"===t)return await c(r.id);if("ready"===t)return await l(r.id);return i.NextResponse.json({error:"Invalid action"},{status:400})}catch(e){return console.error("Update reservation error:",e),i.NextResponse.json({error:"Failed to update reservation"},{status:500})}}async function c(e){try{let r=await Object(function(){var e=Error("Cannot find module '../../../lib/db'");throw e.code="MODULE_NOT_FOUND",e}()).reservation.findUnique({where:{id:e},include:{book:!0}});if(!r)return i.NextResponse.json({error:"Reservation not found"},{status:404});if("WAITING"!==r.status)return i.NextResponse.json({error:"Only waiting reservations can be cancelled"},{status:400});let t=await Object(function(){var e=Error("Cannot find module '../../../lib/db'");throw e.code="MODULE_NOT_FOUND",e}()).reservation.update({where:{id:e},data:{status:"CANCELLED"},include:{book:!0,person:!0}});return"RESERVED"===r.book.status&&await Object(function(){var e=Error("Cannot find module '../../../lib/db'");throw e.code="MODULE_NOT_FOUND",e}()).book.update({where:{id:r.bookId},data:{status:"AVAILABLE"}}),i.NextResponse.json(t)}catch(e){return console.error("Cancel reservation error:",e),i.NextResponse.json({error:"Failed to cancel reservation"},{status:500})}}async function l(e){try{let r=await Object(function(){var e=Error("Cannot find module '../../../lib/db'");throw e.code="MODULE_NOT_FOUND",e}()).reservation.findUnique({where:{id:e},include:{book:!0}});if(!r)return i.NextResponse.json({error:"Reservation not found"},{status:404});if("WAITING"!==r.status)return i.NextResponse.json({error:"Only waiting reservations can be marked as ready"},{status:400});let t=await Object(function(){var e=Error("Cannot find module '../../../lib/db'");throw e.code="MODULE_NOT_FOUND",e}()).reservation.update({where:{id:e},data:{status:"READY"},include:{book:!0,person:!0}});return i.NextResponse.json(t)}catch(e){return console.error("Mark reservation ready error:",e),i.NextResponse.json({error:"Failed to mark reservation as ready"},{status:500})}}async function p(e,{params:r}){try{let e=await Object(function(){var e=Error("Cannot find module '../../../lib/db'");throw e.code="MODULE_NOT_FOUND",e}()).reservation.findUnique({where:{id:r.id},include:{book:!0}});if(!e)return i.NextResponse.json({error:"Reservation not found"},{status:404});if("CANCELLED"!==e.status)return i.NextResponse.json({error:"Cannot delete active reservation"},{status:400});return await Object(function(){var e=Error("Cannot find module '../../../lib/db'");throw e.code="MODULE_NOT_FOUND",e}()).reservation.delete({where:{id:r.id}}),i.NextResponse.json({message:"Reservation deleted successfully"})}catch(e){return console.error("Delete reservation error:",e),i.NextResponse.json({error:"Failed to delete reservation"},{status:500})}}!function(){var e=Error("Cannot find module '../../../lib/db'");throw e.code="MODULE_NOT_FOUND",e}();let v=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/reservations/[id]/route",pathname:"/api/reservations/[id]",filename:"route",bundlePath:"app/api/reservations/[id]/route"},resolvedPagePath:"C:\\Users\\USER\\Desktop\\Library Project\\app\\api\\reservations\\[id]\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:f,staticGenerationAsyncStorage:b,serverHooks:N}=v,O="/api/reservations/[id]/route";function E(){return(0,a.patchFetch)({serverHooks:N,staticGenerationAsyncStorage:b})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[948,972],()=>t(2600));module.exports=o})();