"use strict";(()=>{var e={};e.id=69,e.ids=[69],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4346:(e,r,n)=>{n.r(r),n.d(r,{originalPathname:()=>p,patchFetch:()=>O,requestAsyncStorage:()=>u,routeModule:()=>c,serverHooks:()=>l,staticGenerationAsyncStorage:()=>b});var t={};n.r(t),n.d(t,{POST:()=>d});var o=n(9303),i=n(8716),a=n(670),s=n(7070);async function d(e){try{let{type:r}=await e.json();if("export"===r){let[e,r,n,t,o,i]=await Promise.all([Object(function(){var e=Error("Cannot find module '../../../lib/db'");throw e.code="MODULE_NOT_FOUND",e}()).book.findMany({include:{borrowings:!0,reservations:!0}}),Object(function(){var e=Error("Cannot find module '../../../lib/db'");throw e.code="MODULE_NOT_FOUND",e}()).person.findMany({include:{borrowings:!0,reservations:!0,attendance:!0}}),Object(function(){var e=Error("Cannot find module '../../../lib/db'");throw e.code="MODULE_NOT_FOUND",e}()).borrowing.findMany({include:{book:!0,person:!0,member:!0}}),Object(function(){var e=Error("Cannot find module '../../../lib/db'");throw e.code="MODULE_NOT_FOUND",e}()).reservation.findMany({include:{book:!0,person:!0,member:!0}}),Object(function(){var e=Error("Cannot find module '../../../lib/db'");throw e.code="MODULE_NOT_FOUND",e}()).attendance.findMany({include:{person:!0,member:!0}}),Object(function(){var e=Error("Cannot find module '../../../lib/db'");throw e.code="MODULE_NOT_FOUND",e}()).settings.findFirst()]),a={exportDate:new Date().toISOString(),version:"1.0",libraryName:i?.libraryName||"Library",data:{books:e,persons:r,borrowings:n,reservations:t,attendance:o,settings:i}},d=new Date().toISOString().split("T")[0],c=`library-export-${d}.json`;return new s.NextResponse(JSON.stringify(a,null,2),{status:200,headers:{"Content-Type":"application/json","Content-Disposition":`attachment; filename="${c}"`}})}if("backup"!==r)return s.NextResponse.json({error:'Invalid backup type. Use "export" or "backup"'},{status:400});{let[e,r,n,t,o,i]=await Promise.all([Object(function(){var e=Error("Cannot find module '../../../lib/db'");throw e.code="MODULE_NOT_FOUND",e}()).book.findMany({include:{borrowings:!0,reservations:!0}}),Object(function(){var e=Error("Cannot find module '../../../lib/db'");throw e.code="MODULE_NOT_FOUND",e}()).person.findMany({include:{borrowings:!0,reservations:!0,attendance:!0}}),Object(function(){var e=Error("Cannot find module '../../../lib/db'");throw e.code="MODULE_NOT_FOUND",e}()).borrowing.findMany({include:{book:!0,person:!0,member:!0}}),Object(function(){var e=Error("Cannot find module '../../../lib/db'");throw e.code="MODULE_NOT_FOUND",e}()).reservation.findMany({include:{book:!0,person:!0,member:!0}}),Object(function(){var e=Error("Cannot find module '../../../lib/db'");throw e.code="MODULE_NOT_FOUND",e}()).attendance.findMany({include:{person:!0,member:!0}}),Object(function(){var e=Error("Cannot find module '../../../lib/db'");throw e.code="MODULE_NOT_FOUND",e}()).settings.findFirst()]),a={backupDate:new Date().toISOString(),version:"1.0",libraryName:i?.libraryName||"Library",data:{books:e,persons:r,borrowings:n,reservations:t,attendance:o,settings:i}},d=new Date().toISOString().replace(/[:.]/g,"-"),c=`library-backup-${d}.json`;return new s.NextResponse(JSON.stringify(a,null,2),{status:200,headers:{"Content-Type":"application/json","Content-Disposition":`attachment; filename="${c}"`}})}}catch(e){return console.error("Error creating backup/export:",e),s.NextResponse.json({error:"Failed to create backup/export"},{status:500})}}!function(){var e=Error("Cannot find module '../../../lib/db'");throw e.code="MODULE_NOT_FOUND",e}();let c=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/settings/backup/route",pathname:"/api/settings/backup",filename:"route",bundlePath:"app/api/settings/backup/route"},resolvedPagePath:"C:\\Users\\USER\\Desktop\\Library Project\\app\\api\\settings\\backup\\route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:u,staticGenerationAsyncStorage:b,serverHooks:l}=c,p="/api/settings/backup/route";function O(){return(0,a.patchFetch)({serverHooks:l,staticGenerationAsyncStorage:b})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var n=e=>r(r.s=e),t=r.X(0,[948,972],()=>n(4346));module.exports=t})();