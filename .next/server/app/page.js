(()=>{var e={};e.id=931,e.ids=[931],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5315:e=>{"use strict";e.exports=require("path")},7360:e=>{"use strict";e.exports=require("url")},3353:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>d,routeModule:()=>u,tree:()=>c}),s(908),s(7438),s(5866);var r=s(3191),a=s(8716),l=s(7922),n=s.n(l),i=s(5231),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);s.d(t,o);let c=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,908)),"C:\\Users\\USER\\Desktop\\Library Project\\app\\page.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,7481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,7438)),"C:\\Users\\USER\\Desktop\\Library Project\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,7481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["C:\\Users\\USER\\Desktop\\Library Project\\app\\page.tsx"],x="/page",m={require:s,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},352:(e,t,s)=>{Promise.resolve().then(s.bind(s,2981))},2981:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>eQ});var r=s(326),a=s(7577),l=s(3819),n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();var o=(e,t)=>{let s=(0,a.forwardRef)(({color:s="currentColor",size:r=24,strokeWidth:l=2,absoluteStrokeWidth:o,children:c,...d},x)=>(0,a.createElement)("svg",{ref:x,...n,width:r,height:r,stroke:s,strokeWidth:o?24*Number(l)/Number(r):l,className:`lucide lucide-${i(e)}`,...d},[...t.map(([e,t])=>(0,a.createElement)(e,t)),...(Array.isArray(c)?c:[c])||[]]));return s.displayName=`${e}`,s};let c=o("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),d=o("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),x=o("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),m=o("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),u=()=>{let{login:e,state:t}=(0,l.a)(),[s,n]=(0,a.useState)({email:"",password:""}),[i,o]=(0,a.useState)(!1),u=async t=>{t.preventDefault(),await e(s.email,s.password)},h=e=>{n(t=>({...t,[e.target.name]:e.target.value}))};return r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"mx-auto h-20 w-20 relative",children:[r.jsx("img",{src:"/ST peter.png",alt:"Robert Aboagye Mensah Community Library",className:"h-20 w-20 rounded-full object-cover border-4 border-yellow-400 shadow-lg",onError:e=>{e.currentTarget.style.display="none";let t=e.currentTarget.nextElementSibling;t&&(t.style.display="flex")}}),r.jsx("div",{className:"h-20 w-20 rounded-full bg-gradient-to-br from-blue-800 to-blue-600 border-4 border-yellow-400 hidden items-center justify-center text-white shadow-lg",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"text-red-400 text-2xl font-bold",children:"✚"}),r.jsx("div",{className:"text-sm font-bold text-yellow-200",children:"MC"})]})})]}),r.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Sign in to your account"}),r.jsx("p",{className:"mt-2 text-center text-lg font-semibold text-blue-800",children:"Robert Aboagye Mensah"}),r.jsx("p",{className:"text-center text-sm text-gray-600",children:"Community Library"})]}),(0,r.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:u,children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700",children:"Username"}),(0,r.jsxs)("div",{className:"mt-1 relative",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx(c,{className:"h-5 w-5 text-gray-400"})}),r.jsx("input",{id:"username",name:"email",type:"email",required:!0,value:s.email,onChange:h,className:"appearance-none rounded-lg relative block w-full pl-10 pr-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Enter your email"})]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,r.jsxs)("div",{className:"mt-1 relative",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx(d,{className:"h-5 w-5 text-gray-400"})}),r.jsx("input",{id:"password",name:"password",type:i?"text":"password",required:!0,value:s.password,onChange:h,className:"appearance-none rounded-lg relative block w-full pl-10 pr-10 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Enter your password"}),r.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:r.jsx("button",{type:"button",onClick:()=>o(!i),className:"text-gray-400 hover:text-gray-600",children:i?r.jsx(x,{className:"h-5 w-5"}):r.jsx(m,{className:"h-5 w-5"})})})]})]})]}),t.error&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:r.jsx("p",{className:"text-sm text-red-600",children:t.error})}),r.jsx("div",{children:r.jsx("button",{type:"submit",disabled:t.loading,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:t.loading?(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Signing in..."]}):"Sign in"})}),r.jsx("div",{className:"mt-6",children:(0,r.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[r.jsx("h3",{className:"text-sm font-medium text-blue-800 mb-2",children:"Demo Accounts:"}),(0,r.jsxs)("div",{className:"text-xs text-blue-700 space-y-1",children:[(0,r.jsxs)("div",{children:[r.jsx("strong",{children:"Admin:"})," username: admin, password: password"]}),(0,r.jsxs)("div",{children:[r.jsx("strong",{children:"Librarian:"})," username: librarian, password: password"]}),(0,r.jsxs)("div",{children:[r.jsx("strong",{children:"Member:"})," username: member, password: password"]})]})]})})]})]})})},h=({children:e,requiredPermissions:t=[]})=>{let{state:s,hasPermission:a}=(0,l.a)();return s.isAuthenticated?t.length>0&&!t.every(e=>a(e))?r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"mx-auto h-16 w-16 bg-red-100 rounded-full flex items-center justify-center mb-4",children:r.jsx("svg",{className:"h-8 w-8 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),r.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),r.jsx("p",{className:"text-gray-600",children:"You don't have permission to access this page."})]})}):r.jsx(r.Fragment,{children:e}):r.jsx(u,{})},p=o("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),g=o("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),y=o("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),f=o("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),b=o("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),j=()=>{let{state:e,logout:t}=(0,l.a)(),[s,n]=(0,a.useState)(!1);return e.user?(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("button",{onClick:()=>n(!s),className:"flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-100 transition-colors",children:[r.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center",children:r.jsx(c,{className:"h-5 w-5 text-white"})}),(0,r.jsxs)("div",{className:"text-left",children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.user.name}),r.jsx("p",{className:"text-xs text-gray-600 capitalize",children:e.user.role})]})]}),s&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>n(!1)}),(0,r.jsxs)("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 z-20",children:[r.jsx("div",{className:"p-4 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center",children:r.jsx(c,{className:"h-6 w-6 text-white"})}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"font-medium text-gray-900",children:e.user.name}),r.jsx("p",{className:"text-sm text-gray-600",children:e.user.email}),r.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full mt-1 ${(e=>{switch(e){case"admin":return"bg-red-100 text-red-800";case"librarian":return"bg-blue-100 text-blue-800";case"member":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}})(e.user.role)}`,children:e.user.role})]})]})}),(0,r.jsxs)("div",{className:"py-2",children:[(0,r.jsxs)("button",{className:"w-full flex items-center space-x-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[r.jsx(y,{className:"h-4 w-4"}),r.jsx("span",{children:"Notifications"})]}),(0,r.jsxs)("button",{className:"w-full flex items-center space-x-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[r.jsx(f,{className:"h-4 w-4"}),r.jsx("span",{children:"Settings"})]}),r.jsx("hr",{className:"my-2"}),(0,r.jsxs)("button",{onClick:t,className:"w-full flex items-center space-x-3 px-4 py-2 text-sm text-red-600 hover:bg-red-50",children:[r.jsx(b,{className:"h-4 w-4"}),r.jsx("span",{children:"Sign out"})]})]})]})]})]}):null};var N=s(2807);let v=o("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),w=o("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),k=o("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),S=o("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),C=o("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),E=()=>{let{state:e,markAsRead:t,markAllAsRead:s,removeNotification:l,clearAllNotifications:n}=(0,N.z)(),[i,o]=(0,a.useState)(!1),c=e=>{switch(e){case"success":return r.jsx(v,{className:"h-5 w-5 text-green-600"});case"error":return r.jsx(w,{className:"h-5 w-5 text-red-600"});case"warning":return r.jsx(k,{className:"h-5 w-5 text-yellow-600"});default:return r.jsx(S,{className:"h-5 w-5 text-blue-600"})}};return(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("button",{onClick:()=>o(!i),className:"relative p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:[r.jsx(y,{className:"h-5 w-5"}),e.unreadCount>0&&r.jsx("span",{className:"absolute top-1 right-1 h-2 w-2 bg-red-500 rounded-full"})]}),i&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>o(!1)}),(0,r.jsxs)("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-200 z-20 max-h-96 overflow-hidden",children:[r.jsx("div",{className:"p-4 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Notifications"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[e.unreadCount>0&&r.jsx("button",{onClick:s,className:"text-sm text-blue-600 hover:text-blue-700",children:"Mark all read"}),r.jsx("button",{onClick:n,className:"text-sm text-gray-500 hover:text-gray-700",children:"Clear all"})]})]})}),r.jsx("div",{className:"max-h-80 overflow-y-auto",children:0===e.notifications.length?(0,r.jsxs)("div",{className:"p-6 text-center text-gray-500",children:[r.jsx(y,{className:"h-8 w-8 mx-auto mb-2 text-gray-400"}),r.jsx("p",{children:"No notifications"})]}):r.jsx("div",{className:"divide-y divide-gray-200",children:e.notifications.map(e=>r.jsx("div",{className:`p-4 hover:bg-gray-50 transition-colors ${e.read?"":"bg-blue-50"}`,children:(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[r.jsx("div",{className:"flex-shrink-0",children:c(e.type)}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.title}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[!e.read&&r.jsx("div",{className:"h-2 w-2 bg-blue-600 rounded-full"}),r.jsx("button",{onClick:()=>l(e.id),className:"text-gray-400 hover:text-gray-600",children:r.jsx(p,{className:"h-4 w-4"})})]})]}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.message}),(0,r.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[r.jsx("p",{className:"text-xs text-gray-500",children:e.timestamp.toLocaleString()}),!e.read&&(0,r.jsxs)("button",{onClick:()=>t(e.id),className:"text-xs text-blue-600 hover:text-blue-700 flex items-center space-x-1",children:[r.jsx(C,{className:"h-3 w-3"}),r.jsx("span",{children:"Mark as read"})]})]}),e.action&&r.jsx("button",{onClick:e.action.onClick,className:"mt-2 text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700",children:e.action.label})]})]})},e.id))})})]})]})]})},P=o("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),A=o("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]]),R=o("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),D=o("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),T=o("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),I=({onNavigate:e})=>{let{hasPermission:t}=(0,l.a)(),[s,n]=(0,a.useState)(!1),[i,o]=(0,a.useState)(""),[d,x]=(0,a.useState)([]),[m,u]=(0,a.useState)(!1),[h,g]=(0,a.useState)(-1),y=(0,a.useRef)(null),f=(0,a.useRef)(null);if(!t("members:read")&&!t("users:read"))return null;(0,a.useEffect)(()=>{let e=e=>{y.current&&!y.current.contains(e.target)&&(n(!1),g(-1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,a.useEffect)(()=>{let e=setTimeout(async()=>{if(i.trim().length<2){x([]);return}u(!0);try{let e=localStorage.getItem("token"),t=await fetch(`/api/search?q=${encodeURIComponent(i)}&limit=8`,{headers:{Authorization:`Bearer ${e}`}});if(t.ok){let e=await t.json();x(e.results||[])}else x([])}catch(e){console.error("Search error:",e),x([])}finally{u(!1)}},300);return()=>clearTimeout(e)},[i]);let b=t=>{n(!1),o(""),x([]),g(-1),e(t.navigateTo,t.id),sessionStorage.setItem("highlightPersonId",t.id)},j=e=>{switch(e){case"member":case"legacy_member":return r.jsx(c,{className:"h-4 w-4 text-blue-600"});case"visitor":return r.jsx(P,{className:"h-4 w-4 text-green-600"});case"user":return r.jsx(A,{className:"h-4 w-4 text-purple-600"});default:return r.jsx(c,{className:"h-4 w-4 text-gray-600"})}},N=e=>{switch(e){case"member":case"legacy_member":return"border-l-blue-500 bg-blue-50";case"visitor":return"border-l-green-500 bg-green-50";case"user":return"border-l-purple-500 bg-purple-50";default:return"border-l-gray-500 bg-gray-50"}},v=e=>e?new Date(e).toLocaleDateString():"";return(0,r.jsxs)("div",{className:"relative",ref:y,children:[(0,r.jsxs)("div",{className:"relative",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx(R,{className:"h-4 w-4 text-gray-400"})}),r.jsx("input",{ref:f,type:"text",placeholder:"Search people, members, visitors...",value:i,onChange:e=>{o(e.target.value),n(!0),g(-1)},onFocus:()=>n(!0),onKeyDown:e=>{"ArrowDown"===e.key?(e.preventDefault(),g(e=>Math.min(e+1,d.length-1))):"ArrowUp"===e.key?(e.preventDefault(),g(e=>Math.max(e-1,-1))):"Enter"===e.key?(e.preventDefault(),h>=0&&d[h]&&b(d[h])):"Escape"===e.key&&(n(!1),g(-1),f.current?.blur())},className:"w-full pl-10 pr-10 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),i&&r.jsx("button",{onClick:()=>{o(""),x([]),n(!1),g(-1)},className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:r.jsx(p,{className:"h-4 w-4 text-gray-400 hover:text-gray-600"})})]}),s&&(i.length>=2||d.length>0)&&(0,r.jsxs)("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-50 max-h-96 overflow-y-auto",children:[m&&(0,r.jsxs)("div",{className:"px-4 py-3 text-center text-gray-500",children:[r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600 mx-auto mb-2"}),"Searching..."]}),!m&&i.length>=2&&0===d.length&&(0,r.jsxs)("div",{className:"px-4 py-6 text-center text-gray-500",children:[r.jsx(R,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),(0,r.jsxs)("p",{className:"text-sm",children:['No people found for "',i,'"']}),r.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Try searching by name, email, phone, or library ID"})]}),!m&&d.length>0&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"px-3 py-2 bg-gray-50 border-b border-gray-200",children:(0,r.jsxs)("p",{className:"text-xs font-medium text-gray-600",children:["Found ",d.length," people • Click to navigate"]})}),d.map((e,t)=>r.jsx("div",{onClick:()=>b(e),className:`px-4 py-3 cursor-pointer border-l-4 transition-colors ${t===h?`${N(e.type)} border-l-4`:"hover:bg-gray-50 border-l-transparent"}`,children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[j(e.type),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.name}),e.libraryId&&r.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800",children:e.libraryId}),r.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${"ACTIVE"===e.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:e.status})]}),r.jsx("p",{className:"text-xs text-gray-500 truncate",children:e.subtitle}),e.membershipDate&&(0,r.jsxs)("div",{className:"flex items-center space-x-1 mt-1",children:[r.jsx(D,{className:"h-3 w-3 text-gray-400"}),(0,r.jsxs)("p",{className:"text-xs text-gray-400",children:["Member since ",v(e.membershipDate)]})]})]})]}),r.jsx(T,{className:"h-4 w-4 text-gray-400"})]})},`${e.type}-${e.id}`)),d.length>=8&&r.jsx("div",{className:"px-4 py-2 bg-gray-50 border-t border-gray-200",children:r.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Showing first 8 results. Be more specific to narrow down."})})]}),i.length<2&&i.length>0&&r.jsx("div",{className:"px-4 py-3 text-center text-gray-500",children:r.jsx("p",{className:"text-sm",children:"Type at least 2 characters to search"})})]})]})},M=({onNavigate:e,onMenuToggle:t,isSidebarOpen:s})=>{let{state:n}=(0,l.a)(),[i,o]=(0,a.useState)(!1);return(0,r.jsxs)("nav",{className:"bg-white shadow-sm border-b border-gray-200 px-6 py-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[r.jsx("button",{onClick:t,className:"md:hidden p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:s?r.jsx(p,{className:"h-5 w-5"}):r.jsx(g,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsxs)("div",{className:"relative",children:[r.jsx("img",{src:"/ST peter.png",alt:"Robert Aboagye Mensah Community Library",className:"h-8 w-8 md:h-12 md:w-12 rounded-full object-cover border-2 border-yellow-400",onError:e=>{e.currentTarget.style.display="none";let t=e.currentTarget.nextElementSibling;t&&(t.style.display="flex")}}),r.jsx("div",{className:"h-8 w-8 md:h-12 md:w-12 rounded-full bg-gradient-to-br from-blue-800 to-blue-600 border-2 border-yellow-400 hidden items-center justify-center text-white shadow-lg",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"text-red-400 text-sm md:text-lg font-bold",children:"✚"}),r.jsx("div",{className:"text-xs font-bold text-yellow-200",children:"MC"})]})})]}),(0,r.jsxs)("div",{className:"hidden sm:block",children:[r.jsx("h1",{className:"text-lg md:text-xl font-bold text-gray-900",children:"Robert Aboagye Mensah"}),r.jsx("p",{className:"text-xs md:text-sm text-gray-600",children:"Community Library"})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 md:space-x-4",children:[r.jsx("div",{className:"hidden md:block w-80",children:r.jsx(I,{onNavigate:e})}),r.jsx(E,{}),n.user&&r.jsx(j,{})]})]}),i&&r.jsx("div",{className:"md:hidden mt-4",children:r.jsx(I,{onNavigate:e})})]})},O=o("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),L=o("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),_=o("BookMarked",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20",key:"t4utmx"}],["polyline",{points:"10 2 10 10 13 7 16 10 16 2",key:"13o6vz"}]]),B=o("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),$=o("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),U=o("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),F=({activePage:e,setActivePage:t,onClose:s})=>{let{state:a,hasPermission:n}=(0,l.a)(),i=[{icon:U,label:"Attendance Analytics",action:()=>t("tracking"),permission:"attendance:read"}],o=[{key:"dashboard",icon:O,label:"Dashboard",permission:"dashboard:read"},{key:"catalog",icon:L,label:"Book Catalog",permission:"books:read"},{key:"people",icon:P,label:"People Management",permission:"members:read"},{key:"borrowing",icon:_,label:"Borrowing System",permission:"borrowing:read"},{key:"attendance",icon:B,label:"Attendance (Unified)",permission:"manage_attendance"},{key:"users",icon:A,label:"User Management",permission:"all"},{key:"reports",icon:$,label:"Reports & Analytics",permission:"reports:read"},{key:"settings",icon:f,label:"Settings",permission:"settings:read"}].filter(e=>n(e.permission)),c=i.filter(e=>n(e.permission)),d=e=>{t(e),s&&s()};return r.jsx("aside",{className:"w-64 bg-white shadow-sm border-r border-gray-200 min-h-screen",children:(0,r.jsxs)("div",{className:"p-4 md:p-6",children:[r.jsx("nav",{className:"space-y-2",children:o.map(t=>{let s=t.icon,a=e===t.key;return(0,r.jsxs)("button",{onClick:()=>d(t.key),className:`flex items-center space-x-3 px-3 py-2 rounded-lg transition-colors w-full text-left ${a?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"}`,children:[r.jsx(s,{className:"h-5 w-5"}),r.jsx("span",{className:"font-medium",children:t.label})]},t.key)})}),c.length>0&&(0,r.jsxs)("div",{className:"mt-8 pt-6 border-t border-gray-200",children:[r.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3",children:"Quick Actions"}),r.jsx("div",{className:"space-y-2",children:c.map((e,t)=>{let s=e.icon;return(0,r.jsxs)("button",{onClick:e.action,className:"flex items-center space-x-3 px-3 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors w-full text-left",children:[r.jsx(s,{className:"h-5 w-5"}),r.jsx("span",{className:"font-medium",children:e.label})]},t)})})]}),a.user&&(0,r.jsxs)("div",{className:"mt-8 pt-6 border-t border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[r.jsx(A,{className:"h-4 w-4 text-gray-500"}),r.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Your Role"})]}),(0,r.jsxs)("div",{className:"bg-blue-50 rounded-lg p-3",children:[r.jsx("p",{className:"text-sm font-medium text-blue-900 capitalize",children:a.user.role}),r.jsx("p",{className:"text-xs text-blue-700",children:a.user.name})]})]})]})})},V=()=>{let{addNotification:e}=(0,N.z)();return(0,a.useEffect)(()=>{localStorage.getItem("library_welcome_shown")||(setTimeout(()=>{e({type:"info",title:"Welcome to the Library System!",message:"You can now manage books, members, and borrowing activities. Explore the different sections using the sidebar.",action:{label:"Get Started",onClick:()=>console.log("Getting started...")}})},2e3),setTimeout(()=>{e({type:"warning",title:"System Maintenance",message:"Scheduled maintenance will occur tonight from 2 AM to 4 AM. Some features may be temporarily unavailable."})},5e3),setTimeout(()=>{e({type:"success",title:"New Features Available",message:"Check out the new QR code scanner and enhanced reporting features in the latest update!"})},8e3),localStorage.setItem("library_welcome_shown","true"))},[e]),null};var q=s(8896);let z=o("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Z=o("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]),H=o("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),Y=o("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),W=o("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),G=()=>{let{state:e,addBook:t,addMember:s,borrowBook:n,addAttendance:i}=(0,q.y)(),{hasPermission:o}=(0,l.a)(),{addNotification:c}=(0,N.z)(),{books:d,members:x,borrowings:m,reservations:u,attendance:h}=e,[p,g]=(0,a.useState)({totalBooks:0,totalMembers:0,borrowedBooks:0,overdueBooks:0,todayAttendance:0,pendingReservations:0,availableBooks:0,totalBorrowings:0,monthlyBorrowings:0,popularCategories:[]}),[y,f]=(0,a.useState)([]),[b,j]=(0,a.useState)(!1),[v,w]=(0,a.useState)("7days");(0,a.useEffect)(()=>{S(),C()},[d,x,m,u,h]);let S=()=>{let e=m.filter(e=>"BORROWED"===e.status),t=e.filter(e=>new Date(e.dueDate)<new Date),s=new Date().toDateString(),r=h.filter(e=>new Date(e.checkInTime).toDateString()===s),a=new Date;a.setDate(a.getDate()-30);let l=m.filter(e=>new Date(e.borrowDate)>=a).length,n=Object.entries(d.reduce((e,t)=>(e[t.category]=(e[t.category]||0)+1,e),{})).map(([e,t])=>({category:e,count:t})).sort((e,t)=>t.count-e.count).slice(0,5);g({totalBooks:d.length,totalMembers:x.length,borrowedBooks:e.length,overdueBooks:t.length,todayAttendance:r.length,pendingReservations:u.filter(e=>"WAITING"===e.status).length,availableBooks:d.filter(e=>"AVAILABLE"===e.status).length,totalBorrowings:m.length,monthlyBorrowings:l,popularCategories:n})},C=()=>{let e=[];e.push(...m.sort((e,t)=>new Date(t.borrowDate).getTime()-new Date(e.borrowDate).getTime()).slice(0,5).map(e=>{let t=d.find(t=>t.id===e.bookId),s=x.find(t=>t.id===(e.memberId||e.personId));return{type:"borrow",message:`${s?.name||"Unknown"} borrowed "${t?.title||"Unknown Book"}"`,time:new Date(e.borrowDate).toLocaleString(),icon:_,color:"text-blue-600"}}),...m.filter(e=>"RETURNED"===e.status&&e.returnDate).sort((e,t)=>new Date(t.returnDate).getTime()-new Date(e.returnDate).getTime()).slice(0,3).map(e=>{let t=d.find(t=>t.id===e.bookId),s=x.find(t=>t.id===(e.memberId||e.personId));return{type:"return",message:`${s?.name||"Unknown"} returned "${t?.title||"Unknown Book"}"`,time:new Date(e.returnDate).toLocaleString(),icon:L,color:"text-green-600"}}),...h.sort((e,t)=>new Date(t.checkInTime).getTime()-new Date(e.checkInTime).getTime()).slice(0,3).map(e=>{let t=x.find(t=>t.id===e.memberId);return{type:"attendance",message:`${t?.name||"Unknown"} checked in`,time:new Date(e.checkInTime).toLocaleString(),icon:P,color:"text-purple-600"}})),f(e.sort((e,t)=>new Date(t.time).getTime()-new Date(e.time).getTime()).slice(0,8))},E=async()=>{j(!0),await new Promise(e=>setTimeout(e,1e3)),S(),C(),j(!1),c({type:"success",title:"Dashboard Refreshed",message:"All statistics have been updated."})},A=[{title:"Add New Book",description:"Add a new book to the catalog",icon:z,action:()=>{c({type:"info",title:"Quick Action",message:"Navigate to Book Catalog to add a new book."})},color:"bg-blue-500",permission:"books:write"},{title:"Scan QR Code",description:"Quick book checkout/return",icon:Z,action:()=>{c({type:"info",title:"Quick Action",message:"Navigate to QR Scanner for quick operations."})},color:"bg-green-500",permission:"scanner:use"},{title:"Record Attendance",description:"Log member library visit",icon:U,action:()=>{let e=x[0];e&&i({personId:e.id,memberId:e.id})},color:"bg-purple-500",permission:"attendance:write"},{title:"View Reports",description:"Generate library reports",icon:H,action:()=>{c({type:"info",title:"Quick Action",message:"Navigate to Reports for detailed analytics."})},color:"bg-orange-500",permission:"reports:read"}].filter(e=>o(e.permission));return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard"}),r.jsx("p",{className:"text-gray-600 mt-2",children:"Welcome to Robert Aboagye Mensah Community Library"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsxs)("select",{value:v,onChange:e=>w(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600",children:[r.jsx("option",{value:"7days",children:"Last 7 days"}),r.jsx("option",{value:"30days",children:"Last 30 days"}),r.jsx("option",{value:"90days",children:"Last 90 days"})]}),(0,r.jsxs)("button",{onClick:E,disabled:b,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[r.jsx(Y,{className:`h-4 w-4 ${b?"animate-spin":""}`}),r.jsx("span",{children:"Refresh"})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[r.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Books"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:p.totalBooks}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[p.availableBooks," available"]})]}),r.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:r.jsx(L,{className:"h-6 w-6 text-blue-600"})})]})}),r.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Members"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:p.totalMembers}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[p.todayAttendance," visited today"]})]}),r.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:r.jsx(P,{className:"h-6 w-6 text-green-600"})})]})}),r.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Loans"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:p.borrowedBooks}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[p.overdueBooks," overdue"]})]}),r.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:r.jsx(_,{className:"h-6 w-6 text-yellow-600"})})]})}),r.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Monthly Activity"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:p.monthlyBorrowings}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"borrowings this month"})]}),r.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:r.jsx(W,{className:"h-6 w-6 text-purple-600"})})]})})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Quick Actions"}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:A.map((e,t)=>{let s=e.icon;return(0,r.jsxs)("button",{onClick:e.action,className:"p-4 border border-gray-200 rounded-lg hover:shadow-md transition-shadow text-left group",children:[r.jsx("div",{className:`p-3 ${e.color} rounded-lg inline-block mb-3 group-hover:scale-110 transition-transform`,children:r.jsx(s,{className:"h-6 w-6 text-white"})}),r.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:e.title}),r.jsx("p",{className:"text-sm text-gray-600",children:e.description})]},t)})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Popular Categories"}),r.jsx("div",{className:"space-y-3",children:p.popularCategories.map((e,t)=>{let s=e.count/p.totalBooks*100;return(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{className:"text-gray-600 capitalize",children:e.category}),(0,r.jsxs)("span",{className:"font-medium text-gray-900",children:[e.count," books"]})]}),r.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:r.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-500",style:{width:`${s}%`}})})]},t)})})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Activities"}),r.jsx("div",{className:"space-y-3",children:y.length>0?y.map((e,t)=>{let s=e.icon;return(0,r.jsxs)("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[r.jsx("div",{className:`p-2 rounded-lg ${e.color.replace("text-","bg-").replace("-600","-100")}`,children:r.jsx(s,{className:`h-4 w-4 ${e.color}`})}),(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("p",{className:"text-sm text-gray-900",children:e.message}),r.jsx("p",{className:"text-xs text-gray-500",children:e.time})]})]},t)}):(0,r.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[r.jsx(W,{className:"h-8 w-8 mx-auto mb-2 text-gray-400"}),r.jsx("p",{children:"No recent activities"})]})})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[r.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Overdue Books"}),r.jsx("p",{className:"text-2xl font-bold text-red-600",children:p.overdueBooks})]}),r.jsx(k,{className:"h-8 w-8 text-red-600"})]})}),r.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending Reservations"}),r.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:p.pendingReservations})]}),r.jsx(D,{className:"h-8 w-8 text-yellow-600"})]})}),r.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Borrowings"}),r.jsx("p",{className:"text-2xl font-bold text-blue-600",children:p.totalBorrowings})]}),r.jsx(H,{className:"h-8 w-8 text-blue-600"})]})})]})]})},Q=o("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),X=o("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),J=o("Grid",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["line",{x1:"3",x2:"21",y1:"9",y2:"9",key:"1vqk6q"}],["line",{x1:"3",x2:"21",y1:"15",y2:"15",key:"o2sbyz"}],["line",{x1:"9",x2:"9",y1:"3",y2:"21",key:"13tij5"}],["line",{x1:"15",x2:"15",y1:"3",y2:"21",key:"1hpv9i"}]]),K=o("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]),ee=o("CheckSquare",[["polyline",{points:"9 11 12 14 22 4",key:"19ybtz"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]),et=o("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),es=o("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),er=o("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),ea=o("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),el=e=>["Title,Author,ISBN,Category,Published Year,Status,Description",...e.map(e=>[`"${e.title.replace(/"/g,'""')}"`,`"${e.author.replace(/"/g,'""')}"`,`"${e.isbn}"`,`"${e.category}"`,e.publishedYear,`"${e.status}"`,`"${(e.description||"").replace(/"/g,'""')}"`].join(","))].join("\n"),en=e=>JSON.stringify(e,null,2),ei=(e,t,s)=>{let r=new Blob([e],{type:s}),a=URL.createObjectURL(r),l=document.createElement("a");l.href=a,l.download=t,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a)},eo=e=>{if(e)switch(e.toLowerCase()){case"available":return"AVAILABLE";case"borrowed":return"BORROWED";case"reserved":return"RESERVED";default:return}},ec=e=>{let t=e.split("\n").filter(e=>e.trim());if(t.length<2)return[];let s=t[0].split(",").map(e=>e.replace(/"/g,"").trim()),r=[];for(let e=1;e<t.length;e++){let a=ed(t[e]);if(a.length!==s.length)continue;let l={title:a[0]||"",author:a[1]||"",isbn:a[2]||"",category:a[3]||"fiction",publishedYear:parseInt(a[4])||new Date().getFullYear(),description:a[6]||"",status:eo(a[5])||"AVAILABLE"};r.push(l)}return r},ed=e=>{let t=[],s="",r=!1;for(let a=0;a<e.length;a++){let l=e[a];'"'===l?r&&'"'===e[a+1]?(s+='"',a++):r=!r:","!==l||r?s+=l:(t.push(s.trim()),s="")}return t.push(s.trim()),t},ex=e=>{let t=[];return e.title&&0!==e.title.trim().length||t.push("Title is required"),e.author&&0!==e.author.trim().length||t.push("Author is required"),e.category&&0!==e.category.trim().length||t.push("Category is required"),(!e.publishedYear||e.publishedYear<1e3||e.publishedYear>new Date().getFullYear()+1)&&t.push("Published year must be between 1000 and "+(new Date().getFullYear()+1)),e.isbn&&e.isbn.length>0&&!em(e.isbn)&&t.push("Invalid ISBN format"),t},em=e=>{let t=e.replace(/[-\s]/g,"");return/^(978|979)?\d{9}[\dX]$/.test(t)},eu=e=>{let t={success:!0,imported:0,errors:[],warnings:[]};return e.forEach((e,s)=>{let r=ex(e);r.length>0?(t.errors.push(`Row ${s+2}: ${r.join(", ")}`),t.success=!1):t.imported++}),0===t.imported&&e.length>0&&(t.success=!1),t},eh=()=>"Title,Author,ISBN,Category,Published Year,Status,Description\nThe Great Gatsby,F. Scott Fitzgerald,9780743273565,fiction,1925,available,A classic American novel\n1984,George Orwell,9780451524935,fiction,1949,available,A dystopian social science fiction novel\nTo Kill a Mockingbird,Harper Lee,9780061120084,fiction,1960,available,A novel about racial injustice",ep=({isOpen:e,onClose:t,mode:s,onImportSuccess:l})=>{let{state:n,addBook:i}=(0,q.y)(),{addNotification:o}=(0,N.z)(),[c,d]=(0,a.useState)([]),[x,m]=(0,a.useState)(null),[u,h]=(0,a.useState)(!1),g=(0,a.useRef)(null),y=async()=>{if(0===c.length)return;h(!0);let e=eu(c);if(m(e),e.success){let t=0;for(let s of c)0===e.errors.filter(e=>e.includes(`Row ${c.indexOf(s)+2}`)).length&&(i({...s,status:s.status||"AVAILABLE"}),t++);o({type:"success",title:"Import Successful",message:`Successfully imported ${t} books.`}),l&&l()}else o({type:"error",title:"Import Failed",message:`Found ${e.errors.length} errors. Please fix them and try again.`});h(!1)},f=e=>{let t=n.books,s=new Date().toISOString().split("T")[0];"csv"===e?ei(el(t),`books-export-${s}.csv`,"text/csv"):ei(en(t),`books-export-${s}.json`,"application/json"),o({type:"success",title:"Export Successful",message:`Books exported as ${e.toUpperCase()} file.`})};return e?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:r.jsx("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"import"===s?"Import Books":"Export Books"}),r.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:r.jsx(p,{className:"h-6 w-6"})})]}),"import"===s?(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload File"}),(0,r.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[r.jsx(Q,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"Upload a CSV or JSON file to import books"}),r.jsx("input",{ref:g,type:"file",accept:".csv,.json",onChange:e=>{let t=e.target.files?.[0];if(!t)return;let s=new FileReader;s.onload=e=>{let s=e.target?.result;try{if(t.name.endsWith(".csv")){let e=ec(s);d(e),m(null)}else if(t.name.endsWith(".json")){let e=JSON.parse(s);d(e),m(null)}else o({type:"error",title:"Invalid File Format",message:"Please upload a CSV or JSON file."})}catch(e){o({type:"error",title:"File Parse Error",message:"Could not parse the uploaded file. Please check the format."})}},s.readAsText(t)},className:"hidden"}),r.jsx("button",{onClick:()=>g.current?.click(),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Choose File"})]})]}),(0,r.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[r.jsx(S,{className:"h-5 w-5 text-blue-600"}),r.jsx("h3",{className:"font-medium text-blue-900",children:"Need a Template?"})]}),r.jsx("p",{className:"text-sm text-blue-700 mb-3",children:"Download our CSV template to see the correct format for importing books."}),(0,r.jsxs)("button",{onClick:()=>{ei(eh(),"books-import-template.csv","text/csv"),o({type:"info",title:"Template Downloaded",message:"Import template downloaded. Use this format for importing books."})},className:"flex items-center space-x-2 text-blue-600 hover:text-blue-700 text-sm",children:[r.jsx(X,{className:"h-4 w-4"}),r.jsx("span",{children:"Download Template"})]})]}),c.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:["Import Preview (",c.length," books)"]}),r.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:(0,r.jsxs)("div",{className:"max-h-60 overflow-y-auto",children:[(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Title"}),r.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Author"}),r.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Category"}),r.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Year"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.slice(0,10).map((e,t)=>(0,r.jsxs)("tr",{children:[r.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:e.title}),r.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:e.author}),r.jsx("td",{className:"px-4 py-2 text-sm text-gray-900 capitalize",children:e.category}),r.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:e.publishedYear})]},t))})]}),c.length>10&&(0,r.jsxs)("div",{className:"px-4 py-2 text-sm text-gray-500 text-center",children:["... and ",c.length-10," more books"]})]})})]}),x&&(0,r.jsxs)("div",{className:`border rounded-lg p-4 ${x.success?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[x.success?r.jsx(v,{className:"h-5 w-5 text-green-600"}):r.jsx(w,{className:"h-5 w-5 text-red-600"}),(0,r.jsxs)("h3",{className:`font-medium ${x.success?"text-green-900":"text-red-900"}`,children:["Import ",x.success?"Successful":"Failed"]})]}),(0,r.jsxs)("p",{className:`text-sm ${x.success?"text-green-700":"text-red-700"}`,children:[x.imported," books imported successfully"]}),x.errors.length>0&&(0,r.jsxs)("div",{className:"mt-2",children:[r.jsx("p",{className:"text-sm font-medium text-red-700 mb-1",children:"Errors:"}),(0,r.jsxs)("ul",{className:"text-sm text-red-600 space-y-1",children:[x.errors.slice(0,5).map((e,t)=>(0,r.jsxs)("li",{children:["• ",e]},t)),x.errors.length>5&&(0,r.jsxs)("li",{children:["• ... and ",x.errors.length-5," more errors"]})]})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[r.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),r.jsx("button",{onClick:y,disabled:0===c.length||u,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Importing...":`Import ${c.length} Books`})]})]}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Choose Export Format"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("button",{onClick:()=>f("csv"),className:"flex items-center space-x-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50",children:[r.jsx(er,{className:"h-8 w-8 text-green-600"}),(0,r.jsxs)("div",{className:"text-left",children:[r.jsx("p",{className:"font-medium text-gray-900",children:"CSV Format"}),r.jsx("p",{className:"text-sm text-gray-500",children:"Compatible with Excel, Google Sheets"})]})]}),(0,r.jsxs)("button",{onClick:()=>f("json"),className:"flex items-center space-x-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50",children:[r.jsx(ea,{className:"h-8 w-8 text-blue-600"}),(0,r.jsxs)("div",{className:"text-left",children:[r.jsx("p",{className:"font-medium text-gray-900",children:"JSON Format"}),r.jsx("p",{className:"text-sm text-gray-500",children:"Machine-readable format"})]})]})]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[r.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Export Information"}),(0,r.jsxs)("ul",{className:"text-sm text-gray-600 space-y-1",children:[(0,r.jsxs)("li",{children:["• Total books to export: ",n.books.length]}),(0,r.jsxs)("li",{children:["• Available books: ",n.books.filter(e=>"AVAILABLE"===e.status).length]}),(0,r.jsxs)("li",{children:["• Borrowed books: ",n.books.filter(e=>"BORROWED"===e.status).length]}),(0,r.jsxs)("li",{children:["• Reserved books: ",n.books.filter(e=>"RESERVED"===e.status).length]})]})]}),r.jsx("div",{className:"flex justify-end space-x-3",children:r.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Close"})})]})]})})}):null},eg=()=>{let{state:e,addBook:t,updateBook:s,deleteBook:n,fetchBooks:i}=(0,q.y)(),{hasPermission:o}=(0,l.a)(),{books:c,borrowings:d}=e,[x,u]=(0,a.useState)(""),[h,g]=(0,a.useState)("all"),[y,f]=(0,a.useState)("all"),[b,j]=(0,a.useState)("title"),[N,v]=(0,a.useState)(!1),[w,k]=(0,a.useState)(null),[S,C]=(0,a.useState)(null),[E,P]=(0,a.useState)("grid"),[A,D]=(0,a.useState)([]),[T,I]=(0,a.useState)(!1),[M,O]=(0,a.useState)(!1),_=["all","fiction","non-fiction","science","history","biography","children","technology","art","philosophy"];(0,a.useEffect)(()=>{i()},[]);let B=c.filter(e=>{let t=e.title.toLowerCase().includes(x.toLowerCase())||e.author.toLowerCase().includes(x.toLowerCase())||e.isbn.toLowerCase().includes(x.toLowerCase()),s="all"===h||e.category===h,r="all"===y||e.status===y;return t&&s&&r}).sort((e,t)=>{switch(b){case"title":return e.title.localeCompare(t.title);case"author":return e.author.localeCompare(t.author);case"publishedYear":return t.publishedYear-e.publishedYear;case"category":return e.category.localeCompare(t.category);default:return 0}}),$=async e=>{try{await t(e),v(!1)}catch(e){console.error("Failed to add book:",e)}},U=async e=>{await s(e),k(null)},F=e=>{C(e)},V=async e=>{let t=c.find(t=>t.id===e),s=t?t.title:"this book";if(confirm(`Are you sure you want to delete "${s}"? This action cannot be undone.`))try{await n(e),setTimeout(()=>i(),500)}catch(e){console.error("Failed to delete book:",e)}},Z=async()=>{if(0!==A.length&&confirm(`Are you sure you want to delete ${A.length} books? This action cannot be undone.`))try{for(let e of A)await n(e);D([]),setTimeout(()=>i(),500)}catch(e){console.error("Failed to delete books:",e)}},H=e=>{D(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},W=()=>{A.length===B.length?D([]):D(B.map(e=>e.id))},G=e=>d.filter(t=>t.bookId===e).length;return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Book Catalog"}),(0,r.jsxs)("p",{className:"text-gray-600 mt-2",children:["Manage your library's book collection (",B.length," books)"]})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[o("books:write")&&(0,r.jsxs)("button",{onClick:()=>v(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2",children:[r.jsx(z,{className:"h-5 w-5"}),r.jsx("span",{children:"Add Book"})]}),(0,r.jsxs)("button",{onClick:i,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2",children:[r.jsx(Y,{className:"h-5 w-5"}),r.jsx("span",{children:"Refresh"})]}),(0,r.jsxs)("button",{onClick:()=>I(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center space-x-2",children:[r.jsx(Q,{className:"h-5 w-5"}),r.jsx("span",{children:"Import"})]}),(0,r.jsxs)("button",{onClick:()=>O(!0),className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 flex items-center space-x-2",children:[r.jsx(X,{className:"h-5 w-5"}),r.jsx("span",{children:"Export"})]})]})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[(0,r.jsxs)("div",{className:"relative",children:[r.jsx(R,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),r.jsx("input",{type:"text",placeholder:"Search books...",value:x,onChange:e=>u(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-transparent w-full"})]}),r.jsx("select",{value:h,onChange:e=>g(e.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600",children:_.map(e=>r.jsx("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))}),r.jsx("select",{value:y,onChange:e=>f(e.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600",children:["all","AVAILABLE","BORROWED","RESERVED"].map(e=>r.jsx("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))}),(0,r.jsxs)("select",{value:b,onChange:e=>j(e.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600",children:[r.jsx("option",{value:"title",children:"Sort by Title"}),r.jsx("option",{value:"author",children:"Sort by Author"}),r.jsx("option",{value:"publishedYear",children:"Sort by Year"}),r.jsx("option",{value:"category",children:"Sort by Category"})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("button",{onClick:()=>P("grid"),className:`p-2 rounded-lg ${"grid"===E?"bg-blue-100 text-blue-600":"text-gray-400 hover:text-gray-600"}`,children:r.jsx(J,{className:"h-5 w-5"})}),r.jsx("button",{onClick:()=>P("list"),className:`p-2 rounded-lg ${"list"===E?"bg-blue-100 text-blue-600":"text-gray-400 hover:text-gray-600"}`,children:r.jsx(K,{className:"h-5 w-5"})})]}),o("books:write")&&r.jsx("div",{className:"flex items-center space-x-2",children:(0,r.jsxs)("button",{onClick:W,className:"flex items-center space-x-2 px-3 py-2 text-sm text-gray-600 hover:text-gray-800",children:[r.jsx(ee,{className:"h-4 w-4"}),r.jsx("span",{children:"Select All"})]})})]}),A.length>0&&o("books:delete")&&(0,r.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-center justify-between mt-4",children:[(0,r.jsxs)("span",{className:"text-blue-800 font-medium",children:[A.length," book",A.length>1?"s":""," selected"]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[r.jsx("button",{onClick:Z,className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700",children:"Delete Selected"}),r.jsx("button",{onClick:()=>D([]),className:"bg-gray-600 text-white px-3 py-1 rounded text-sm hover:bg-gray-700",children:"Clear Selection"})]})]})]}),"grid"===E?r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:B.map(e=>r.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[o("books:delete")&&r.jsx("input",{type:"checkbox",checked:A.includes(e.id),onChange:()=>H(e.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),r.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:r.jsx(L,{className:"h-6 w-6 text-blue-600"})})]}),o("books:delete")&&(0,r.jsxs)("div",{className:"flex space-x-1",children:[r.jsx("button",{onClick:()=>k(e),className:"p-1 text-gray-400 hover:text-blue-600",children:r.jsx(et,{className:"h-4 w-4"})}),r.jsx("button",{onClick:()=>V(e.id),className:"p-1 text-gray-400 hover:text-red-600",children:r.jsx(es,{className:"h-4 w-4"})})]})]}),r.jsx("h3",{className:"font-semibold text-gray-900 mb-2 line-clamp-2",children:e.title}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:["by ",e.author]}),r.jsx("p",{className:"text-xs text-gray-500 mb-3 capitalize",children:e.category}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[r.jsx("span",{className:"text-gray-500",children:"Published:"}),r.jsx("span",{className:"font-medium",children:e.publishedYear})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[r.jsx("span",{className:"text-gray-500",children:"Borrowed:"}),(0,r.jsxs)("span",{className:"font-medium",children:[G(e.id)," times"]})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[r.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${"AVAILABLE"===e.status?"bg-green-100 text-green-800":"BORROWED"===e.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:e.status.charAt(0)+e.status.slice(1).toLowerCase()}),(0,r.jsxs)("button",{onClick:()=>F(e),className:"flex items-center space-x-1 text-blue-600 hover:text-blue-700 text-sm",children:[r.jsx(m,{className:"h-4 w-4"}),r.jsx("span",{children:"View"})]})]})]})},e.id))}):r.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:r.jsx("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[o("books:delete")&&r.jsx("th",{className:"px-6 py-3 text-left",children:r.jsx("input",{type:"checkbox",checked:A.length===B.length&&B.length>0,onChange:W,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Book"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Author"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Year"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Borrowed"}),o("books:delete")&&r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:B.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[o("books:delete")&&r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("input",{type:"checkbox",checked:A.includes(e.id),onChange:()=>H(e.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:r.jsx("div",{className:"h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center",children:r.jsx(L,{className:"h-5 w-5 text-blue-600"})})}),(0,r.jsxs)("div",{className:"ml-4",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.title}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["ISBN: ",e.isbn]})]})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.author}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 capitalize",children:e.category}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.publishedYear}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${"AVAILABLE"===e.status?"bg-green-100 text-green-800":"BORROWED"===e.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:e.status.charAt(0)+e.status.slice(1).toLowerCase()})}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[G(e.id)," times"]}),o("books:delete")&&r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,r.jsxs)("div",{className:"flex space-x-2",children:[r.jsx("button",{onClick:()=>F(e),className:"text-green-600 hover:text-green-900",title:"View book details",children:r.jsx(m,{className:"h-4 w-4"})}),r.jsx("button",{onClick:()=>k(e),className:"text-blue-600 hover:text-blue-900",title:"Edit book",children:r.jsx(et,{className:"h-4 w-4"})}),r.jsx("button",{onClick:()=>V(e.id),className:"text-red-600 hover:text-red-900",title:"Delete book",children:r.jsx(es,{className:"h-4 w-4"})})]})})]},e.id))})]})})}),0===B.length&&(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx(L,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No books found"}),r.jsx("p",{className:"text-gray-600",children:"Try adjusting your search or filter criteria"})]}),N&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[r.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Add New Book"}),(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault();let t=new FormData(e.target);$({title:t.get("title")?.toString()||"",author:t.get("author")?.toString()||"",isbn:t.get("isbn")?.toString()||"",category:t.get("category")?.toString()||"",publishedYear:parseInt(t.get("publishedYear")?.toString()||"0")||new Date().getFullYear(),description:t.get("description")?.toString()||null,coverImage:t.get("coverImage")?.toString()||null})},children:[(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx("input",{name:"title",placeholder:"Book Title",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"}),r.jsx("input",{name:"author",placeholder:"Author",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"}),r.jsx("input",{name:"isbn",placeholder:"ISBN (e.g., 978-0-123456-78-9)",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"}),(0,r.jsxs)("select",{name:"category",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600",children:[r.jsx("option",{value:"",children:"Select Category"}),_.slice(1).map(e=>r.jsx("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))]}),r.jsx("input",{name:"publishedYear",type:"number",placeholder:"Published Year",min:"1000",max:new Date().getFullYear()+1,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"}),r.jsx("textarea",{name:"description",placeholder:"Description",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"}),r.jsx("input",{name:"coverImage",placeholder:"Cover Image URL (optional)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[r.jsx("button",{type:"button",onClick:()=>v(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),r.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Add Book"})]})]})]})}),w&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[r.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Edit Book"}),(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault();let t=new FormData(e.target);U({...w,title:t.get("title")?.toString()||"",author:t.get("author")?.toString()||"",isbn:t.get("isbn")?.toString()||"",category:t.get("category")?.toString()||"",publishedYear:parseInt(t.get("publishedYear")?.toString()||"")||new Date().getFullYear(),description:t.get("description")?.toString()||null,coverImage:t.get("coverImage")?.toString()||null,status:t.get("status")?.toString()||"AVAILABLE"})},children:[(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx("input",{name:"title",defaultValue:w.title,placeholder:"Book Title",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"}),r.jsx("input",{name:"author",defaultValue:w.author,placeholder:"Author",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"}),r.jsx("input",{name:"isbn",defaultValue:w.isbn,placeholder:"ISBN (e.g., 978-0-123456-78-9)",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"}),r.jsx("select",{name:"category",defaultValue:w.category,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600",children:_.slice(1).map(e=>r.jsx("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))}),r.jsx("input",{name:"publishedYear",type:"number",defaultValue:w.publishedYear,placeholder:"Published Year",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"}),(0,r.jsxs)("select",{name:"status",defaultValue:w.status,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600",children:[r.jsx("option",{value:"AVAILABLE",children:"Available"}),r.jsx("option",{value:"BORROWED",children:"Borrowed"}),r.jsx("option",{value:"RESERVED",children:"Reserved"})]}),r.jsx("textarea",{name:"description",defaultValue:w.description||"",placeholder:"Description",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"}),r.jsx("input",{name:"coverImage",defaultValue:w.coverImage||"",placeholder:"Cover Image URL (optional)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[r.jsx("button",{type:"button",onClick:()=>k(null),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),r.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Update Book"})]})]})]})}),r.jsx(ep,{isOpen:T,onClose:()=>I(!1),mode:"import",onImportSuccess:()=>{i(),I(!1)}}),r.jsx(ep,{isOpen:M,onClose:()=>O(!1),mode:"export"}),S&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-6",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Book Details"}),r.jsx("button",{onClick:()=>C(null),className:"text-gray-400 hover:text-gray-600",children:r.jsx(p,{className:"h-6 w-6"})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsx("div",{className:"flex justify-center",children:S.coverImage?r.jsx("img",{src:S.coverImage,alt:S.title,className:"w-48 h-64 object-cover rounded-lg shadow-md"}):r.jsx("div",{className:"w-48 h-64 bg-gray-200 rounded-lg flex items-center justify-center",children:r.jsx(L,{className:"h-16 w-16 text-gray-400"})})}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:S.title}),(0,r.jsxs)("p",{className:"text-gray-600",children:["by ",S.author]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"font-medium text-gray-700",children:"ISBN:"}),r.jsx("span",{className:"text-gray-900",children:S.isbn})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"font-medium text-gray-700",children:"Category:"}),r.jsx("span",{className:"text-gray-900 capitalize",children:S.category})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"font-medium text-gray-700",children:"Published Year:"}),r.jsx("span",{className:"text-gray-900",children:S.publishedYear})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"font-medium text-gray-700",children:"Status:"}),r.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${"AVAILABLE"===S.status?"bg-green-100 text-green-800":"BORROWED"===S.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:S.status.charAt(0)+S.status.slice(1).toLowerCase()})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"font-medium text-gray-700",children:"Borrowed:"}),(0,r.jsxs)("span",{className:"text-gray-900",children:[G(S.id)," times"]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"font-medium text-gray-700",children:"Added:"}),r.jsx("span",{className:"text-gray-900",children:new Date(S.createdAt).toLocaleDateString()})]})]}),S.description&&(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Description:"}),r.jsx("p",{className:"text-gray-900 text-sm leading-relaxed",children:S.description})]})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 mt-6 pt-6 border-t border-gray-200",children:[r.jsx("button",{onClick:()=>C(null),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Close"}),o("books:update")&&r.jsx("button",{onClick:()=>{C(null),k(S)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Edit Book"})]})]})})]})},ey=o("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),ef=o("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),eb=o("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]),ej=o("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]),eN=o("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),ev=o("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);var ew=s(381);let ek=()=>{let{state:e,addMember:t,updateMember:s,deleteMember:l,fetchMembers:n}=(0,q.y)(),[i,o]=(0,a.useState)([]),[c,d]=(0,a.useState)(!1),[x,u]=(0,a.useState)(""),[h,g]=(0,a.useState)("all"),[y,f]=(0,a.useState)("all"),[b,j]=(0,a.useState)(!1),[N,k]=(0,a.useState)(null),[S,C]=(0,a.useState)(null),[E,A]=(0,a.useState)("table"),[T,I]=(0,a.useState)(null),[M,O]=(0,a.useState)(!1),[L,_]=(0,a.useState)({name:"",email:"",phone:"",address:"",personType:"VISITOR",status:"ACTIVE",notes:"",emergencyContact:""});(0,a.useEffect)(()=>{F(),B()},[]);let B=async()=>{try{let e=await fetch("/api/persons/stats");if(e.ok){let t=await e.json();I(t)}}catch(e){console.error("Error fetching stats:",e)}},F=async()=>{d(!0);try{let e=await fetch("/api/persons");if(e.ok){let t=await e.json();o(t.persons||[])}else ew.ZP.error("Failed to fetch people data")}catch(e){console.error("Error fetching persons:",e),ew.ZP.error("Failed to fetch people data")}finally{d(!1)}},V=(i||[]).filter(e=>{let t=e.name.toLowerCase().includes(x.toLowerCase())||e.email.toLowerCase().includes(x.toLowerCase())||e.phone&&e.phone.includes(x),s="all"===h||e.personType===h,r="all"===y||e.status===y;return t&&s&&r}),Z=async e=>{e.preventDefault(),d(!0);try{let e=await fetch("/api/persons",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(L)});if(e.ok)ew.ZP.success("Person added successfully!"),_({name:"",email:"",phone:"",address:"",personType:"VISITOR",status:"ACTIVE",notes:"",emergencyContact:""}),j(!1),F();else{let t=await e.json();ew.ZP.error(t.error||"Failed to add person")}}catch(e){console.error("Error adding person:",e),ew.ZP.error("Failed to add person")}finally{d(!1)}},W=async e=>{if(e.preventDefault(),N){d(!0);try{let e=await fetch(`/api/persons/${N.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(N)});if(e.ok)ew.ZP.success("Person updated successfully!"),k(null),F();else{let t=await e.json();ew.ZP.error(t.error||"Failed to update person")}}catch(e){console.error("Error updating person:",e),ew.ZP.error("Failed to update person")}finally{d(!1)}}},G=async e=>{if(confirm("Are you sure you want to delete this person?")){d(!0);try{let t=await fetch(`/api/persons/${e}`,{method:"DELETE"});if(t.ok)ew.ZP.success("Person deleted successfully!"),F();else{let e=await t.json();ew.ZP.error(e.error||"Failed to delete person")}}catch(e){console.error("Error deleting person:",e),ew.ZP.error("Failed to delete person")}finally{d(!1)}}},Q=e=>{switch(e){case"ACTIVE":return"bg-green-100 text-green-800";case"INACTIVE":default:return"bg-gray-100 text-gray-800";case"BANNED":return"bg-red-100 text-red-800";case"SUSPENDED":return"bg-yellow-100 text-yellow-800"}},ee=e=>{switch(e){case"MEMBER":return"bg-blue-100 text-blue-800";case"VISITOR":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-center gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-gray-900",children:"People Management"}),r.jsx("p",{className:"text-gray-600 mt-2",children:"Manage library members and visitors"})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,r.jsxs)("button",{onClick:F,disabled:c,className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2 w-full sm:w-auto justify-center",children:[c?r.jsx(Y,{className:"h-5 w-5 animate-spin"}):r.jsx(Y,{className:"h-5 w-5"}),r.jsx("span",{children:"Refresh"})]}),(0,r.jsxs)("button",{onClick:()=>O(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center space-x-2 w-full sm:w-auto justify-center",children:[r.jsx($,{className:"h-5 w-5"}),r.jsx("span",{children:"Statistics"})]}),(0,r.jsxs)("button",{onClick:()=>j(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2 w-full sm:w-auto justify-center",children:[r.jsx(z,{className:"h-5 w-5"}),r.jsx("span",{children:"Add Person"})]})]})]}),(0,r.jsxs)("div",{className:"bg-white p-4 lg:p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[r.jsx("div",{className:"lg:col-span-1",children:(0,r.jsxs)("div",{className:"relative",children:[r.jsx(R,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),r.jsx("input",{type:"text",placeholder:"Search people...",value:x,onChange:e=>u(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})]})}),r.jsx("div",{children:r.jsx("select",{value:h,onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",children:["all","MEMBER","VISITOR"].map(e=>r.jsx("option",{value:e,children:"all"===e?"All Types":e},e))})}),r.jsx("div",{children:r.jsx("select",{value:y,onChange:e=>f(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",children:["all","ACTIVE","INACTIVE","BANNED","SUSPENDED"].map(e=>r.jsx("option",{value:e,children:"all"===e?"All Statuses":e},e))})})]}),r.jsx("div",{className:"flex justify-end mt-4",children:(0,r.jsxs)("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[(0,r.jsxs)("button",{onClick:()=>A("table"),className:`px-3 py-1 rounded-md flex items-center space-x-2 text-sm ${"table"===E?"bg-white text-gray-900 shadow-sm":"text-gray-600"}`,children:[r.jsx(K,{className:"h-4 w-4"}),r.jsx("span",{children:"Table"})]}),(0,r.jsxs)("button",{onClick:()=>A("cards"),className:`px-3 py-1 rounded-md flex items-center space-x-2 text-sm ${"cards"===E?"bg-white text-gray-900 shadow-sm":"text-gray-600"}`,children:[r.jsx(J,{className:"h-4 w-4"}),r.jsx("span",{children:"Cards"})]})]})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[r.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:r.jsx(P,{className:"h-6 w-6 text-blue-600"})}),(0,r.jsxs)("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total People"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(i||[]).length}),r.jsx("p",{className:"text-xs text-gray-500",children:"All registered"})]})]})}),r.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:r.jsx(v,{className:"h-6 w-6 text-green-600"})}),(0,r.jsxs)("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(i||[]).filter(e=>"ACTIVE"===e.status).length}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:[((i||[]).filter(e=>"ACTIVE"===e.status).length/Math.max((i||[]).length,1)*100).toFixed(1),"%"]})]})]})}),r.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:r.jsx(ey,{className:"h-6 w-6 text-purple-600"})}),(0,r.jsxs)("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Members"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(i||[]).filter(e=>"MEMBER"===e.personType).length}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:[((i||[]).filter(e=>"MEMBER"===e.personType).length/Math.max((i||[]).length,1)*100).toFixed(1),"%"]})]})]})}),r.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:r.jsx(P,{className:"h-6 w-6 text-orange-600"})}),(0,r.jsxs)("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Visitors"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(i||[]).filter(e=>"VISITOR"===e.personType).length}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:[((i||[]).filter(e=>"VISITOR"===e.personType).length/Math.max((i||[]).length,1)*100).toFixed(1),"%"]})]})]})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:r.jsx(ef,{className:"h-6 w-6 text-gray-600"})}),(0,r.jsxs)("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Inactive"}),r.jsx("p",{className:"text-xl font-bold text-gray-900",children:(i||[]).filter(e=>"INACTIVE"===e.status).length})]})]})}),r.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:r.jsx(eb,{className:"h-6 w-6 text-red-600"})}),(0,r.jsxs)("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Banned"}),r.jsx("p",{className:"text-xl font-bold text-gray-900",children:(i||[]).filter(e=>"BANNED"===e.status).length})]})]})}),r.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:r.jsx(ej,{className:"h-6 w-6 text-yellow-600"})}),(0,r.jsxs)("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Suspended"}),r.jsx("p",{className:"text-xl font-bold text-gray-900",children:(i||[]).filter(e=>"SUSPENDED"===e.status).length})]})]})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[c?(0,r.jsxs)("div",{className:"flex items-center justify-center h-64",children:[r.jsx(Y,{className:"h-8 w-8 animate-spin text-blue-600"}),r.jsx("span",{className:"ml-2 text-gray-600",children:"Loading people..."})]}):"table"===E?r.jsx("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Person"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:V.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:r.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center",children:r.jsx(P,{className:"h-5 w-5 text-gray-600"})})}),(0,r.jsxs)("div",{className:"ml-4",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name}),r.jsx("div",{className:"text-sm text-gray-500",children:e.email})]})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${ee(e.personType)}`,children:e.personType})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${Q(e.status)}`,children:e.status})}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[e.phone&&(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(eN,{className:"h-4 w-4 mr-1"}),e.phone]}),e.address&&(0,r.jsxs)("div",{className:"flex items-center mt-1",children:[r.jsx(ev,{className:"h-4 w-4 mr-1"}),r.jsx("span",{className:"truncate max-w-32",children:e.address})]})]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("button",{onClick:()=>C(e),className:"text-blue-600 hover:text-blue-900",children:r.jsx(m,{className:"h-4 w-4"})}),r.jsx("button",{onClick:()=>k(e),className:"text-indigo-600 hover:text-indigo-900",children:r.jsx(et,{className:"h-4 w-4"})}),r.jsx("button",{onClick:()=>G(e.id),className:"text-red-600 hover:text-red-900",children:r.jsx(es,{className:"h-4 w-4"})})]})})]},e.id))})]})}):r.jsx("div",{className:"p-4 lg:p-6",children:r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:V.map(e=>(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 hover:bg-gray-100 transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center",children:r.jsx(P,{className:"h-5 w-5 text-gray-600"})}),(0,r.jsxs)("div",{className:"ml-3",children:[r.jsx("h3",{className:"text-sm font-medium text-gray-900",children:e.name}),r.jsx("p",{className:"text-sm text-gray-500",children:e.email})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[r.jsx("button",{onClick:()=>C(e),className:"text-blue-600 hover:text-blue-900",children:r.jsx(m,{className:"h-4 w-4"})}),r.jsx("button",{onClick:()=>k(e),className:"text-indigo-600 hover:text-indigo-900",children:r.jsx(et,{className:"h-4 w-4"})}),r.jsx("button",{onClick:()=>G(e.id),className:"text-red-600 hover:text-red-900",children:r.jsx(es,{className:"h-4 w-4"})})]})]}),(0,r.jsxs)("div",{className:"mt-3 flex flex-wrap gap-2",children:[r.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${ee(e.personType)}`,children:e.personType}),r.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${Q(e.status)}`,children:e.status})]}),e.phone&&(0,r.jsxs)("div",{className:"mt-2 flex items-center text-sm text-gray-500",children:[r.jsx(eN,{className:"h-4 w-4 mr-1"}),e.phone]})]},e.id))})}),0===V.length&&!c&&(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx(P,{className:"mx-auto h-12 w-12 text-gray-400"}),r.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No people found"}),r.jsx("p",{className:"mt-1 text-sm text-gray-500",children:x||"all"!==h||"all"!==y?"Try adjusting your search or filters.":"Get started by adding a new person."})]})]}),b&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:r.jsx("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:(0,r.jsxs)("div",{className:"p-6",children:[r.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Add New Person"}),(0,r.jsxs)("form",{onSubmit:Z,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name *"}),r.jsx("input",{type:"text",required:!0,value:L.name,onChange:e=>_({...L,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),r.jsx("input",{type:"email",required:!0,value:L.email,onChange:e=>_({...L,email:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),r.jsx("input",{type:"tel",value:L.phone,onChange:e=>_({...L,phone:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),r.jsx("textarea",{value:L.address,onChange:e=>_({...L,address:e.target.value}),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Person Type *"}),(0,r.jsxs)("select",{required:!0,value:L.personType,onChange:e=>_({...L,personType:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",children:[r.jsx("option",{value:"VISITOR",children:"Visitor"}),r.jsx("option",{value:"MEMBER",children:"Member"})]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,r.jsxs)("select",{value:L.status,onChange:e=>_({...L,status:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",children:[r.jsx("option",{value:"ACTIVE",children:"Active"}),r.jsx("option",{value:"INACTIVE",children:"Inactive"}),r.jsx("option",{value:"BANNED",children:"Banned"}),r.jsx("option",{value:"SUSPENDED",children:"Suspended"})]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),r.jsx("textarea",{value:L.notes,onChange:e=>_({...L,notes:e.target.value}),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Emergency Contact"}),r.jsx("input",{type:"text",value:L.emergencyContact,onChange:e=>_({...L,emergencyContact:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[r.jsx("button",{type:"button",onClick:()=>j(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg",children:"Cancel"}),r.jsx("button",{type:"submit",disabled:c,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg",children:c?"Adding...":"Add Person"})]})]})]})})}),N&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:r.jsx("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:(0,r.jsxs)("div",{className:"p-6",children:[r.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Edit Person"}),(0,r.jsxs)("form",{onSubmit:W,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name *"}),r.jsx("input",{type:"text",required:!0,value:N.name,onChange:e=>k({...N,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),r.jsx("input",{type:"email",required:!0,value:N.email,onChange:e=>k({...N,email:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),r.jsx("input",{type:"tel",value:N.phone||"",onChange:e=>k({...N,phone:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),r.jsx("textarea",{value:N.address||"",onChange:e=>k({...N,address:e.target.value}),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Person Type *"}),(0,r.jsxs)("select",{required:!0,value:N.personType,onChange:e=>k({...N,personType:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",children:[r.jsx("option",{value:"VISITOR",children:"Visitor"}),r.jsx("option",{value:"MEMBER",children:"Member"})]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,r.jsxs)("select",{value:N.status,onChange:e=>k({...N,status:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",children:[r.jsx("option",{value:"ACTIVE",children:"Active"}),r.jsx("option",{value:"INACTIVE",children:"Inactive"}),r.jsx("option",{value:"BANNED",children:"Banned"}),r.jsx("option",{value:"SUSPENDED",children:"Suspended"})]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),r.jsx("textarea",{value:N.notes||"",onChange:e=>k({...N,notes:e.target.value}),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Emergency Contact"}),r.jsx("input",{type:"text",value:N.emergencyContact||"",onChange:e=>k({...N,emergencyContact:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[r.jsx("button",{type:"button",onClick:()=>k(null),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg",children:"Cancel"}),r.jsx("button",{type:"submit",disabled:c,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg",children:c?"Updating...":"Update Person"})]})]})]})})}),S&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:r.jsx("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:(0,r.jsxs)("div",{className:"p-6",children:[r.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Person Details"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),r.jsx("p",{className:"text-sm text-gray-900",children:S.name})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),r.jsx("p",{className:"text-sm text-gray-900",children:S.email})]}),S.phone&&(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),r.jsx("p",{className:"text-sm text-gray-900",children:S.phone})]}),S.address&&(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),r.jsx("p",{className:"text-sm text-gray-900",children:S.address})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Person Type"}),r.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${ee(S.personType)}`,children:S.personType})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),r.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${Q(S.status)}`,children:S.status})]}),S.notes&&(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Notes"}),r.jsx("p",{className:"text-sm text-gray-900",children:S.notes})]}),S.emergencyContact&&(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Emergency Contact"}),r.jsx("p",{className:"text-sm text-gray-900",children:S.emergencyContact})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Created"}),r.jsx("p",{className:"text-sm text-gray-900",children:new Date(S.createdAt).toLocaleDateString()})]})]}),r.jsx("div",{className:"flex justify-end pt-4",children:r.jsx("button",{onClick:()=>C(null),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg",children:"Close"})})]})})}),M&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:r.jsx("div",{className:"bg-white rounded-lg max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsxs)("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"People Analytics Dashboard"}),r.jsx("p",{className:"text-gray-600 mt-1",children:"Comprehensive statistics and insights"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)("button",{onClick:()=>{let e=new Blob([JSON.stringify(T,null,2)],{type:"application/json"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download=`people-statistics-${new Date().toISOString().split("T")[0]}.json`,s.click(),URL.revokeObjectURL(t),ew.ZP.success("Statistics exported successfully!")},className:"bg-green-600 text-white px-3 py-2 rounded-lg hover:bg-green-700 flex items-center space-x-2",children:[r.jsx(X,{className:"h-4 w-4"}),r.jsx("span",{children:"Export"})]}),r.jsx("button",{onClick:()=>O(!1),className:"text-gray-400 hover:text-gray-600 p-2",children:r.jsx(p,{className:"h-6 w-6"})})]})]}),T&&(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[r.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 p-6 rounded-xl border border-blue-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-blue-600",children:"Total People"}),r.jsx("p",{className:"text-3xl font-bold text-blue-900",children:T.overview.totalPeople}),r.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"All registered"})]}),r.jsx(P,{className:"h-12 w-12 text-blue-600 opacity-80"})]})}),r.jsx("div",{className:"bg-gradient-to-r from-green-50 to-green-100 p-6 rounded-xl border border-green-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-green-600",children:"Active"}),r.jsx("p",{className:"text-3xl font-bold text-green-900",children:T.overview.activePeople}),(0,r.jsxs)("p",{className:"text-xs text-green-700 mt-1",children:[(T.overview.activePeople/Math.max(T.overview.totalPeople,1)*100).toFixed(1),"% of total"]})]}),r.jsx(v,{className:"h-12 w-12 text-green-600 opacity-80"})]})}),r.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-purple-100 p-6 rounded-xl border border-purple-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-purple-600",children:"Members"}),r.jsx("p",{className:"text-3xl font-bold text-purple-900",children:T.overview.totalMembers}),(0,r.jsxs)("p",{className:"text-xs text-purple-700 mt-1",children:[(T.overview.totalMembers/Math.max(T.overview.totalPeople,1)*100).toFixed(1),"% of total"]})]}),r.jsx(ey,{className:"h-12 w-12 text-purple-600 opacity-80"})]})}),r.jsx("div",{className:"bg-gradient-to-r from-orange-50 to-orange-100 p-6 rounded-xl border border-orange-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-orange-600",children:"Visitors"}),r.jsx("p",{className:"text-3xl font-bold text-orange-900",children:T.overview.totalVisitors}),(0,r.jsxs)("p",{className:"text-xs text-orange-700 mt-1",children:[(T.overview.totalVisitors/Math.max(T.overview.totalPeople,1)*100).toFixed(1),"% of total"]})]}),r.jsx(P,{className:"h-12 w-12 text-orange-600 opacity-80"})]})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[r.jsx($,{className:"h-5 w-5 mr-2 text-blue-600"}),"Person Types Distribution"]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-4 h-4 bg-purple-500 rounded-full mr-3"}),r.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Members"})]}),(0,r.jsxs)("div",{className:"text-right",children:[r.jsx("span",{className:"text-lg font-bold text-gray-900",children:T.overview.totalMembers}),r.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2 mt-1",children:r.jsx("div",{className:"bg-purple-500 h-2 rounded-full",style:{width:`${T.overview.totalMembers/Math.max(T.overview.totalPeople,1)*100}%`}})})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-4 h-4 bg-orange-500 rounded-full mr-3"}),r.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Visitors"})]}),(0,r.jsxs)("div",{className:"text-right",children:[r.jsx("span",{className:"text-lg font-bold text-gray-900",children:T.overview.totalVisitors}),r.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2 mt-1",children:r.jsx("div",{className:"bg-orange-500 h-2 rounded-full",style:{width:`${T.overview.totalVisitors/Math.max(T.overview.totalPeople,1)*100}%`}})})]})]})]})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[r.jsx(w,{className:"h-5 w-5 mr-2 text-green-600"}),"Status Breakdown"]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(v,{className:"h-4 w-4 text-green-600 mr-3"}),r.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Active"})]}),r.jsx("span",{className:"text-lg font-bold text-green-600",children:T.overview.activePeople})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(ef,{className:"h-4 w-4 text-gray-600 mr-3"}),r.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Inactive"})]}),r.jsx("span",{className:"text-lg font-bold text-gray-600",children:T.overview.inactivePeople})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(eb,{className:"h-4 w-4 text-red-600 mr-3"}),r.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Banned"})]}),r.jsx("span",{className:"text-lg font-bold text-red-600",children:T.overview.bannedPeople||0})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(ej,{className:"h-4 w-4 text-yellow-600 mr-3"}),r.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Suspended"})]}),r.jsx("span",{className:"text-lg font-bold text-yellow-600",children:T.overview.suspendedPeople||0})]})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[r.jsx(H,{className:"h-5 w-5 mr-2 text-blue-600"}),"Recent Activity"]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(U,{className:"h-4 w-4 text-blue-600 mr-3"}),r.jsx("span",{className:"text-sm font-medium text-gray-700",children:"New people (last 30 days)"})]}),r.jsx("span",{className:"text-xl font-bold text-blue-600",children:T.overview.recentPeople})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(D,{className:"h-4 w-4 text-green-600 mr-3"}),r.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Growth rate"})]}),(0,r.jsxs)("span",{className:"text-xl font-bold text-green-600",children:[T.overview.totalPeople>0?(T.overview.recentPeople/T.overview.totalPeople*100).toFixed(1):0,"%"]})]})]})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[r.jsx($,{className:"h-5 w-5 mr-2 text-purple-600"}),"Quick Insights"]}),(0,r.jsxs)("div",{className:"space-y-3",children:[r.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[r.jsx("strong",{children:"Member Conversion Rate:"})," ",T.insights?.memberConversionRate||0,"%"]})}),r.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[r.jsx("strong",{children:"Active Rate:"})," ",T.insights?.activeRate||0,"%"]})}),r.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[r.jsx("strong",{children:"Average Daily Registrations:"})," ",T.insights?.averageDailyRegistrations||0," people/day"]})}),r.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[r.jsx("strong",{children:"Growth Rate (30 days):"})," ",T.insights?.growthRate||0,"%"]})})]})]})]})]})]})})})]})},eS=()=>{let{state:e,borrowBook:t,returnBook:s,fetchBooks:l,fetchMembers:n,fetchBorrowings:i}=(0,q.y)(),{books:o,members:c,borrowings:d}=e,[x,m]=(0,a.useState)(""),[u,h]=(0,a.useState)(!1);(0,a.useEffect)(()=>{l(),n(),i()},[]);let p=d.filter(e=>"BORROWED"===e.status),g=p.filter(e=>new Date(e.dueDate)<new Date),y=p.filter(e=>{let t=o.find(t=>t.id===e.bookId),s=c.find(t=>t.id===(e.memberId||e.personId));if(!x)return!0;let r=x.toLowerCase();return t?.title.toLowerCase().includes(r)||t?.author.toLowerCase().includes(r)||s?.name.toLowerCase().includes(r)||s?.email.toLowerCase().includes(r)||e.id.toLowerCase().includes(r)}),f=e=>{let s=new Date;s.setDate(s.getDate()+14),console.log("Borrowing data:",e);let r={bookId:e.bookId,personId:e.personId,memberId:e.memberId,dueDate:s.toISOString()};console.log("Borrowing payload:",r),t(r),h(!1)},b=e=>{s(e)};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Borrowing System"}),r.jsx("p",{className:"text-gray-600 mt-2",children:"Manage book loans and returns"})]}),(0,r.jsxs)("button",{onClick:()=>h(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2",children:[r.jsx(z,{className:"h-5 w-5"}),r.jsx("span",{children:"New Loan"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[r.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:r.jsx(_,{className:"h-6 w-6 text-blue-600"})}),(0,r.jsxs)("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Loans"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:p.length})]})]})}),r.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-3 bg-red-100 rounded-lg",children:r.jsx(k,{className:"h-6 w-6 text-red-600"})}),(0,r.jsxs)("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Overdue"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:g.length})]})]})}),r.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:r.jsx(v,{className:"h-6 w-6 text-green-600"})}),(0,r.jsxs)("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Available Books"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.filter(e=>"AVAILABLE"===e.status).length})]})]})})]}),r.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,r.jsxs)("div",{className:"relative",children:[r.jsx(R,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),r.jsx("input",{type:"text",placeholder:"Search by book title, member name, or loan ID...",value:x,onChange:e=>m(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-transparent w-full"})]})}),r.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:r.jsx("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Book"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Member"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Borrow Date"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Due Date"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y.map(e=>{let t=o.find(t=>t.id===e.bookId),s=c.find(t=>t.id===(e.memberId||e.personId)),a=new Date(e.dueDate)<new Date;return(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:t?.title}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["by ",t?.author]})]}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[r.jsx("div",{className:"text-sm text-gray-900",children:s?.name}),r.jsx("div",{className:"text-sm text-gray-500",children:s?.email})]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(e.borrowDate).toLocaleDateString()}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[r.jsx("div",{className:`text-sm ${a?"text-red-600 font-medium":"text-gray-900"}`,children:new Date(e.dueDate).toLocaleDateString()}),a&&(0,r.jsxs)("div",{className:"text-xs text-red-500 flex items-center",children:[r.jsx(D,{className:"h-3 w-3 mr-1"}),"Overdue"]})]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${a?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:a?"Overdue":"Borrowed"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:r.jsx("button",{onClick:()=>b(e.id),className:"text-green-600 hover:text-green-900",children:"Return"})})]},e.id)})})]})})}),0===p.length&&(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx(_,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No active loans"}),r.jsx("p",{className:"text-gray-600",children:"All books are currently available"})]}),p.length>0&&0===y.length&&x&&(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx(R,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No loans found"}),r.jsx("p",{className:"text-gray-600",children:"Try adjusting your search criteria"})]}),u&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[r.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Borrow Book"}),(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault();let t=new FormData(e.target);f({bookId:t.get("bookId"),personId:t.get("personId")})},children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("select",{name:"bookId",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600",children:[r.jsx("option",{value:"",children:"Select Book"}),o.filter(e=>"AVAILABLE"===e.status).map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.title," by ",e.author]},e.id))]}),(0,r.jsxs)("select",{name:"personId",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600",children:[r.jsx("option",{value:"",children:"Select Member"}),c.filter(e=>"ACTIVE"===e.status).map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.name," (",e.email,")"]},e.id))]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[r.jsx("button",{type:"button",onClick:()=>h(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),r.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Borrow Book"})]})]})]})})]})},eC=o("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),eE=({onSubmit:e,onClose:t})=>r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h2",{className:"text-xl font-semibold",children:"Add Person & Check In"}),r.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:r.jsx(z,{className:"h-6 w-6 transform rotate-45"})})]}),(0,r.jsxs)("form",{onSubmit:t=>{t.preventDefault();let s=new FormData(t.target),r={name:s.get("name")?.toString()||"",email:s.get("email")?.toString()||"",phone:s.get("phone")?.toString()||"",address:s.get("address")?.toString()||"",personType:s.get("personType")?.toString()||"VISITOR",notes:s.get("notes")?.toString()||""};if(!r.name||!r.email){ew.ZP.error("Name and email are required");return}e(r)},children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name *"}),r.jsx("input",{name:"name",type:"text",required:!0,placeholder:"Enter person's full name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address *"}),r.jsx("input",{name:"email",type:"email",required:!0,placeholder:"Enter person's email",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),r.jsx("input",{name:"phone",type:"tel",placeholder:"Enter phone number (optional)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Person Type"}),(0,r.jsxs)("select",{name:"personType",defaultValue:"VISITOR",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600",children:[r.jsx("option",{value:"VISITOR",children:"Visitor"}),r.jsx("option",{value:"MEMBER",children:"Member"}),r.jsx("option",{value:"STUDENT",children:"Student"}),r.jsx("option",{value:"VIP",children:"VIP"}),r.jsx("option",{value:"STAFF",children:"Staff"})]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),r.jsx("textarea",{name:"address",placeholder:"Enter address (optional)",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[r.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),(0,r.jsxs)("button",{type:"submit",className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[r.jsx(eC,{className:"h-4 w-4"}),r.jsx("span",{children:"Add & Check In"})]})]})]})]})}),eP=()=>{let{hasPermission:e}=(0,l.a)(),[t,s]=(0,a.useState)([]),[n,i]=(0,a.useState)([]),[o,c]=(0,a.useState)(!1),[d,x]=(0,a.useState)(""),[m,u]=(0,a.useState)(new Date().toISOString().split("T")[0]),[h,p]=(0,a.useState)(!1);if(!e("manage_attendance"))return r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx(w,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),r.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),r.jsx("p",{className:"text-gray-600",children:"You need librarian privileges to access attendance management."})]})});(0,a.useEffect)(()=>{g(),y()},[m]);let g=async()=>{try{c(!0);let e=localStorage.getItem("token"),t=await fetch("/api/persons?limit=100",{headers:{Authorization:`Bearer ${e}`}});if(t.ok){let e=await t.json();s(e.persons||[])}else ew.ZP.error("Failed to fetch persons")}catch(e){console.error("Error fetching persons:",e),ew.ZP.error("Failed to fetch persons")}finally{c(!1)}},y=async()=>{try{let e=localStorage.getItem("token"),t=await fetch(`/api/attendance?date=${m}&limit=100`,{headers:{Authorization:`Bearer ${e}`}});if(t.ok){let e=await t.json();i(e.attendance||[])}else ew.ZP.error("Failed to fetch attendance records")}catch(e){console.error("Error fetching attendance:",e),ew.ZP.error("Failed to fetch attendance records")}},f=async e=>{try{let t=localStorage.getItem("token"),s=await fetch("/api/attendance",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({action:"check-in",personId:e})});if(s.ok)ew.ZP.success("Person checked in successfully!"),y();else{let e=await s.json();ew.ZP.error(e.error||"Failed to check in person")}}catch(e){console.error("Error checking in person:",e),ew.ZP.error("Failed to check in person")}},j=async e=>{try{let t=localStorage.getItem("token"),s=await fetch("/api/attendance",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({action:"check-out",personId:e.personId})});if(s.ok)ew.ZP.success("Check-out successful!"),y();else{let e=await s.json();ew.ZP.error(e.error||"Failed to check out")}}catch(e){console.error("Error checking out:",e),ew.ZP.error("Failed to check out")}},N=async e=>{try{let r=localStorage.getItem("token"),a=await fetch("/api/persons",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify(e)});if(a.ok){let e=await a.json();s([e,...t]),p(!1),ew.ZP.success("Person added successfully!"),f(e.id)}else{let e=await a.json();ew.ZP.error(e.error||"Failed to add person")}}catch(e){console.error("Error adding person:",e),ew.ZP.error("Failed to add person")}},v=t.filter(e=>e.name.toLowerCase().includes(d.toLowerCase())||e.email.toLowerCase().includes(d.toLowerCase())||e.phone&&e.phone.includes(d)),k=e=>n.find(t=>t.personId===e&&!t.checkOutTime),S=e=>new Date(e).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),C=(e,t)=>{let s=new Date(e),r=(t?new Date(t):new Date).getTime()-s.getTime();return`${Math.floor(r/36e5)}h ${Math.floor(r%36e5/6e4)}m`},E=e=>{switch(e){case"MEMBER":return"bg-blue-100 text-blue-800";case"VISITOR":return"bg-green-100 text-green-800";case"VIP":return"bg-purple-100 text-purple-800";case"STUDENT":return"bg-yellow-100 text-yellow-800";case"STAFF":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-4xl font-bold text-gray-900",children:"\uD83D\uDCCB Daily Attendance System"}),r.jsx("p",{className:"text-lg text-gray-600 mt-2",children:"Search, Sign In & Sign Out Library Visitors"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx("input",{type:"date",value:m,onChange:e=>u(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"}),(0,r.jsxs)("button",{onClick:()=>p(!0),className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[r.jsx(ey,{className:"h-4 w-4"}),r.jsx("span",{children:"Add Person"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,r.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"\uD83D\uDC65 Search & Sign In People"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 text-sm font-semibold text-blue-600 bg-blue-50 px-3 py-1 rounded-lg",children:[r.jsx(P,{className:"h-4 w-4"}),(0,r.jsxs)("span",{children:[v.length," registered people"]})]})]}),(0,r.jsxs)("div",{className:"relative",children:[r.jsx(R,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),r.jsx("input",{type:"text",placeholder:"Search by name, email, or phone...",value:d,onChange:e=>x(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"})]})]}),r.jsx("div",{className:"max-h-80 overflow-y-auto border-t border-gray-100 scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100",children:o?(0,r.jsxs)("div",{className:"text-center py-8",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),r.jsx("p",{className:"text-gray-600 mt-2",children:"Loading people..."})]}):0===d.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx(R,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),r.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Start typing to search for people"}),r.jsx("p",{className:"text-gray-500",children:"Type a person's name, email, or phone number to find them and sign them in"})]}):(0,r.jsxs)("div",{children:[v.length>5&&(0,r.jsxs)("div",{className:"bg-blue-50 px-4 py-2 text-sm text-blue-700 font-medium border-b border-blue-100",children:["\uD83D\uDCDD Found ",v.length," people - scroll to see all results"]}),(0,r.jsxs)("div",{className:"divide-y divide-gray-200",children:[v.map(e=>{let t=k(e.id),s=!!t;return r.jsx("div",{className:"p-4 hover:bg-gray-50",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:r.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:r.jsx(P,{className:"h-5 w-5 text-blue-600"})})}),(0,r.jsxs)("div",{children:[r.jsx("div",{className:"text-lg font-bold text-gray-900 mb-1",children:e.name}),r.jsx("div",{className:"text-sm text-gray-600 mb-1",children:e.email}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[r.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-lg text-xs font-semibold ${E(e.personType)} border`,children:e.personType}),e.libraryId&&(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-mono font-semibold bg-gray-100 text-gray-800 border",children:["ID: ",e.libraryId]})]})]})]}),r.jsx("div",{className:"flex items-center space-x-3",children:s?(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"text-center",children:(0,r.jsxs)("div",{className:"inline-flex items-center px-3 py-2 rounded-lg text-sm font-semibold bg-green-100 text-green-800 border border-green-200",children:[r.jsx(D,{className:"h-4 w-4 mr-2"}),(0,r.jsxs)("div",{children:[r.jsx("div",{className:"font-bold",children:"CHECKED IN"}),(0,r.jsxs)("div",{className:"text-xs",children:["at ",S(t.checkInTime)]})]})]})}),(0,r.jsxs)("button",{onClick:()=>j(t),className:"flex items-center space-x-2 px-4 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 text-sm font-semibold shadow-md transition-all duration-200 hover:shadow-lg",children:[r.jsx(b,{className:"h-4 w-4"}),r.jsx("span",{children:"SIGN OUT"})]})]}):(0,r.jsxs)("button",{onClick:()=>f(e.id),className:"flex items-center space-x-2 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm font-semibold shadow-md transition-all duration-200 hover:shadow-lg",children:[r.jsx(eC,{className:"h-4 w-4"}),r.jsx("span",{children:"SIGN IN"})]})})]})},e.id)}),d.length>0&&0===v.length&&(0,r.jsxs)("div",{className:"text-center py-8",children:[r.jsx(P,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-700 mb-2",children:"No people found"}),(0,r.jsxs)("p",{className:"text-gray-500 mb-4",children:['No one matches "',d,'"']}),(0,r.jsxs)("button",{onClick:()=>p(!0),className:"inline-flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm font-semibold",children:[r.jsx(ey,{className:"h-4 w-4"}),r.jsx("span",{children:"Add New Person"})]})]})]})]})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[r.jsx("div",{className:"p-6 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("h2",{className:"text-2xl font-bold text-gray-900",children:["\uD83D\uDD50 ",m===new Date().toISOString().split("T")[0]?"Today's Attendance":"Daily Attendance"]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 text-sm font-semibold text-green-600 bg-green-50 px-3 py-1 rounded-lg",children:[r.jsx(B,{className:"h-4 w-4"}),(0,r.jsxs)("span",{children:[n.length," total visits"]})]})]})}),r.jsx("div",{className:"max-h-96 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100",children:0===n.length?(0,r.jsxs)("div",{className:"text-center py-8",children:[r.jsx(U,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No attendance records"}),r.jsx("p",{className:"text-gray-600",children:"No one has visited the library on this date"})]}):(0,r.jsxs)("div",{children:[n.length>5&&(0,r.jsxs)("div",{className:"bg-green-50 px-4 py-2 text-sm text-green-700 font-medium border-b border-green-100",children:["\uD83D\uDCCB ",n.length," total visits today - scroll to see all records"]}),r.jsx("div",{className:"divide-y divide-gray-200",children:n.map(e=>r.jsx("div",{className:"p-4 hover:bg-gray-50",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:r.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:r.jsx(P,{className:"h-5 w-5 text-blue-600"})})}),(0,r.jsxs)("div",{children:[r.jsx("div",{className:"text-lg font-bold text-gray-900 mb-1",children:e.person?.name||"Unknown Person"}),r.jsx("div",{className:"text-sm text-gray-600 mb-1",children:e.person?.email||"No email"}),e.person?.libraryId&&(0,r.jsxs)("div",{className:"text-xs font-mono font-semibold text-blue-600 mb-2",children:["Library ID: ",e.person.libraryId]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4 text-sm font-medium text-gray-700 bg-gray-50 px-3 py-2 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("span",{className:"text-green-600 font-semibold",children:"IN:"}),r.jsx("span",{className:"ml-1",children:S(e.checkInTime)})]}),e.checkOutTime&&(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("span",{className:"text-red-600 font-semibold",children:"OUT:"}),r.jsx("span",{className:"ml-1",children:S(e.checkOutTime)})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("span",{className:"text-blue-600 font-semibold",children:"TIME:"}),r.jsx("span",{className:"ml-1",children:C(e.checkInTime,e.checkOutTime)})]})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[e.person&&r.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-lg text-xs font-semibold ${E(e.person.personType)} border`,children:e.person.personType}),!e.checkOutTime&&(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-lg text-xs font-semibold bg-green-100 text-green-800 border border-green-200",children:"✓ CURRENTLY IN LIBRARY"}),(0,r.jsxs)("button",{onClick:()=>j(e),className:"flex items-center space-x-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 text-sm font-semibold shadow-md transition-all duration-200 hover:shadow-lg",children:[r.jsx(b,{className:"h-4 w-4"}),r.jsx("span",{children:"SIGN OUT"})]})]}),e.checkOutTime&&r.jsx("span",{className:"inline-flex items-center px-3 py-2 rounded-lg text-sm font-semibold bg-gray-100 text-gray-800 border border-gray-200",children:"✓ VISIT COMPLETED"})]})]})},e.id))})]})})]})]}),h&&r.jsx(eE,{onSubmit:N,onClose:()=>p(!1)})]})},eA=o("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),eR=o("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),eD=o("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]),eT=()=>{let{hasPermission:e}=(0,l.a)(),[t,s]=(0,a.useState)(null),[n,i]=(0,a.useState)(!1),[o,c]=(0,a.useState)("week"),[d,x]=(0,a.useState)(""),[m,u]=(0,a.useState)("");if(!e("attendance:read"))return r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx(w,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),r.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),r.jsx("p",{className:"text-gray-600",children:"You need appropriate privileges to view attendance analytics."})]})});(0,a.useEffect)(()=>{h()},[o]);let h=async()=>{try{i(!0);let e=localStorage.getItem("token"),t=`/api/attendance/stats?period=${o}`;d&&m&&(t+=`&startDate=${d}&endDate=${m}`);let r=await fetch(t,{headers:{Authorization:`Bearer ${e}`}});if(r.ok){let e=await r.json();s(e)}else ew.ZP.error("Failed to fetch attendance statistics")}catch(e){console.error("Error fetching attendance stats:",e),ew.ZP.error("Failed to fetch attendance statistics")}finally{i(!1)}},p=async e=>{ew.ZP.success(`Exporting ${e.toUpperCase()} report...`)},g=e=>{let t=Math.floor(e/60),s=e%60;return t>0?`${t}h ${s}m`:`${s}m`},y=()=>t?.hourlyStats?Object.entries(t.hourlyStats).map(([e,t])=>({hour:parseInt(e),count:t,timeSlot:`${e}:00 - ${parseInt(e)+1}:00`})).sort((e,t)=>t.count-e.count).slice(0,5):[],f=()=>t?.dailyStats?Object.entries(t.dailyStats).map(([e,t])=>({date:new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric"}),visits:t})).sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()):[];return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-center gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900",children:"\uD83D\uDCCA Attendance Analytics"}),r.jsx("p",{className:"text-sm sm:text-base lg:text-lg text-gray-600 mt-1 sm:mt-2",children:"Track patterns, insights, and generate reports"})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,r.jsxs)("select",{value:o,onChange:e=>c(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-base w-full sm:w-auto",children:[r.jsx("option",{value:"week",children:"Last 7 Days"}),r.jsx("option",{value:"month",children:"Last 30 Days"}),r.jsx("option",{value:"year",children:"Last Year"}),r.jsx("option",{value:"custom",children:"Custom Range"})]}),"custom"===o&&(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[r.jsx("input",{type:"date",value:d,onChange:e=>x(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-base w-full sm:w-auto"}),r.jsx("input",{type:"date",value:m,onChange:e=>u(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-base w-full sm:w-auto"})]}),(0,r.jsxs)("button",{onClick:h,className:"flex items-center justify-center space-x-2 px-3 sm:px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm sm:text-base w-full sm:w-auto",children:[r.jsx(Y,{className:"h-4 w-4"}),r.jsx("span",{children:"Refresh"})]})]})]}),n?(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),r.jsx("p",{className:"text-gray-600 mt-4",children:"Loading analytics..."})]}):t?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Visits"}),r.jsx("p",{className:"text-3xl font-bold text-gray-900",children:t.summary.totalVisits})]}),r.jsx("div",{className:"bg-blue-100 rounded-full p-3",children:r.jsx(P,{className:"h-6 w-6 text-blue-600"})})]}),r.jsx("div",{className:"mt-4",children:r.jsx("span",{className:"text-sm text-gray-500",children:"week"===o?"Past 7 days":"month"===o?"Past 30 days":"year"===o?"Past year":"Custom period"})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Currently In Library"}),r.jsx("p",{className:"text-3xl font-bold text-green-600",children:t.summary.activeVisitors})]}),r.jsx("div",{className:"bg-green-100 rounded-full p-3",children:r.jsx(eA,{className:"h-6 w-6 text-green-600"})})]}),r.jsx("div",{className:"mt-4",children:r.jsx("span",{className:"text-sm text-gray-500",children:"Right now"})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Avg. Visit Duration"}),r.jsx("p",{className:"text-3xl font-bold text-purple-600",children:g(t.summary.averageDuration)})]}),r.jsx("div",{className:"bg-purple-100 rounded-full p-3",children:r.jsx(D,{className:"h-6 w-6 text-purple-600"})})]}),r.jsx("div",{className:"mt-4",children:r.jsx("span",{className:"text-sm text-gray-500",children:"Completed visits only"})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Completed Visits"}),r.jsx("p",{className:"text-3xl font-bold text-orange-600",children:t.summary.completedVisits})]}),r.jsx("div",{className:"bg-orange-100 rounded-full p-3",children:r.jsx(eR,{className:"h-6 w-6 text-orange-600"})})]}),r.jsx("div",{className:"mt-4",children:(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:[Math.round(t.summary.completedVisits/t.summary.totalVisits*100),"% completion rate"]})})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"\uD83D\uDCC8 Daily Attendance Trend"}),r.jsx($,{className:"h-5 w-5 text-gray-400"})]}),r.jsx("div",{className:"space-y-4",children:f().slice(-7).map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm font-medium text-gray-700 w-20",children:e.date}),r.jsx("div",{className:"flex-1 mx-4",children:r.jsx("div",{className:"bg-gray-200 rounded-full h-4 relative overflow-hidden",children:r.jsx("div",{className:"bg-blue-600 h-full rounded-full transition-all duration-500",style:{width:`${Math.max(e.visits/Math.max(...f().map(e=>e.visits))*100,5)}%`}})})}),r.jsx("span",{className:"text-sm font-bold text-gray-900 w-12 text-right",children:e.visits})]},e.date))})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"\uD83C\uDFC6 Most Frequent Visitors"}),r.jsx(eR,{className:"h-5 w-5 text-gray-400"})]}),r.jsx("div",{className:"space-y-3",children:t.topVisitors.slice(0,8).map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${0===t?"bg-yellow-100 text-yellow-800":1===t?"bg-gray-100 text-gray-800":2===t?"bg-orange-100 text-orange-800":"bg-blue-100 text-blue-800"}`,children:t+1}),(0,r.jsxs)("div",{children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name}),r.jsx("div",{className:"text-xs text-gray-500",children:e.type})]})]}),r.jsx("div",{className:"text-right",children:(0,r.jsxs)("div",{className:"text-sm font-bold text-gray-900",children:[e.visits," visits"]})})]},e.id))})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"\uD83D\uDD50 Peak Hours Analysis"}),r.jsx(D,{className:"h-5 w-5 text-gray-400"})]}),r.jsx("div",{className:"space-y-3",children:y().map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${0===t?"bg-red-100 text-red-800":1===t?"bg-orange-100 text-orange-800":"bg-blue-100 text-blue-800"}`,children:t+1}),r.jsx("span",{className:"text-sm font-medium text-gray-700",children:e.timeSlot})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"w-20 bg-gray-200 rounded-full h-2",children:r.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${e.count/y()[0]?.count*100}%`}})}),r.jsx("span",{className:"text-sm font-bold text-gray-900 w-8",children:e.count})]})]},e.hour))})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"\uD83D\uDC65 Visitor Type Breakdown"}),r.jsx(eD,{className:"h-5 w-5 text-gray-400"})]}),r.jsx("div",{className:"space-y-4",children:t.typeBreakdown.map(e=>{let s=Math.round(e.count/t.summary.totalVisits*100);return(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:[e.type,"s"]}),(0,r.jsxs)("span",{className:"text-sm font-bold text-gray-900",children:[e.count," (",s,"%)"]})]}),r.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:r.jsx("div",{className:`h-3 rounded-full transition-all duration-500 ${"Member"===e.type?"bg-blue-600":"bg-green-600"}`,style:{width:`${s}%`}})})]},e.type)})}),0===t.typeBreakdown.length&&(0,r.jsxs)("div",{className:"text-center py-8",children:[r.jsx(eD,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-500",children:"No visitor data available for this period"})]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"\uD83D\uDCC4 Export Reports"}),r.jsx(X,{className:"h-5 w-5 text-gray-400"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("button",{onClick:()=>p("pdf"),className:"flex items-center justify-center space-x-2 px-4 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[r.jsx(X,{className:"h-4 w-4"}),r.jsx("span",{children:"Export PDF Report"})]}),(0,r.jsxs)("button",{onClick:()=>p("excel"),className:"flex items-center justify-center space-x-2 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[r.jsx(X,{className:"h-4 w-4"}),r.jsx("span",{children:"Export Excel Data"})]}),(0,r.jsxs)("button",{onClick:()=>{let e=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),s=URL.createObjectURL(e),r=document.createElement("a");r.href=s,r.download=`attendance-data-${new Date().toISOString().split("T")[0]}.json`,r.click(),URL.revokeObjectURL(s),ew.ZP.success("JSON data downloaded!")},className:"flex items-center justify-center space-x-2 px-4 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:[r.jsx(X,{className:"h-4 w-4"}),r.jsx("span",{children:"Export JSON Data"})]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"\uD83D\uDCA1 Insights & Recommendations"}),r.jsx(H,{className:"h-5 w-5 text-gray-400"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"\uD83D\uDCCA Key Insights"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-start space-x-2",children:[r.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full mt-2"}),(0,r.jsxs)("p",{className:"text-sm text-gray-700",children:[r.jsx("span",{className:"font-semibold",children:"Busiest time:"})," ",y()[0]?.timeSlot||"No data","(",y()[0]?.count||0," visits)"]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-2",children:[r.jsx("div",{className:"w-2 h-2 bg-green-600 rounded-full mt-2"}),(0,r.jsxs)("p",{className:"text-sm text-gray-700",children:[r.jsx("span",{className:"font-semibold",children:"Completion rate:"})," ",Math.round(t.summary.completedVisits/t.summary.totalVisits*100),"% of visitors properly sign out"]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-2",children:[r.jsx("div",{className:"w-2 h-2 bg-purple-600 rounded-full mt-2"}),(0,r.jsxs)("p",{className:"text-sm text-gray-700",children:[r.jsx("span",{className:"font-semibold",children:"Average stay:"})," ",g(t.summary.averageDuration)," per visit"]})]})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"\uD83C\uDFAF Recommendations"}),(0,r.jsxs)("div",{className:"space-y-3",children:[t.summary.completedVisits/t.summary.totalVisits<.8&&r.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:(0,r.jsxs)("p",{className:"text-sm text-yellow-800",children:[r.jsx("span",{className:"font-semibold",children:"⚠️ Low sign-out rate:"})," Consider reminding visitors to sign out when leaving."]})}),y().length>0&&r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:(0,r.jsxs)("p",{className:"text-sm text-blue-800",children:[r.jsx("span",{className:"font-semibold",children:"\uD83D\uDCCA Peak hours:"})," Consider having more staff during ",y()[0]?.timeSlot," for better service."]})}),r.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:(0,r.jsxs)("p",{className:"text-sm text-green-800",children:[r.jsx("span",{className:"font-semibold",children:"✅ Good attendance:"})," ",t.summary.totalVisits," total visits show healthy library usage."]})})]})]})]})]})]}):(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx($,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No data available"}),r.jsx("p",{className:"text-gray-600",children:"Try selecting a different time period or check if there are attendance records."})]})]})},eI=o("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);var eM=s(6324);let eO=({title:e,user:t,onSubmit:s,onClose:l})=>{let[n,i]=(0,a.useState)(!1);return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[r.jsx("h2",{className:"text-xl font-semibold mb-4",children:e}),(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault();let t=new FormData(e.target),r={name:t.get("name")?.toString()||"",email:t.get("email")?.toString()||"",role:t.get("role")?.toString()||"LIBRARIAN"},a=t.get("password")?.toString();a&&(r.password=a),s(r)},children:[(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx("input",{name:"name",defaultValue:t?.name||"",placeholder:"Full Name",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"}),r.jsx("input",{name:"email",type:"email",defaultValue:t?.email||"",placeholder:"Email Address",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"}),(0,r.jsxs)("select",{name:"role",defaultValue:t?.role||"LIBRARIAN",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600",children:[r.jsx("option",{value:"ADMIN",children:"Admin"}),r.jsx("option",{value:"LIBRARIAN",children:"Librarian"})]}),(0,r.jsxs)("div",{className:"relative",children:[r.jsx("input",{name:"password",type:n?"text":"password",placeholder:t?"New Password (leave blank to keep current)":"Password",required:!t,className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"}),r.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:r.jsx("button",{type:"button",onClick:()=>i(!n),className:"text-gray-400 hover:text-gray-600 focus:outline-none",children:n?r.jsx(x,{className:"h-5 w-5"}):r.jsx(m,{className:"h-5 w-5"})})})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[r.jsx("button",{type:"button",onClick:l,className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),r.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:t?"Update User":"Create User"})]})]})]})})},eL=()=>{let{hasPermission:e}=(0,l.a)(),[t,s]=(0,a.useState)([]),[n,i]=(0,a.useState)(!1),[o,c]=(0,a.useState)(""),[d,x]=(0,a.useState)("all"),[m,u]=(0,a.useState)(!1),[h,p]=(0,a.useState)(null);if(!e("all"))return r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx(w,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),r.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),r.jsx("p",{className:"text-gray-600",children:"You need admin privileges to access user management."})]})});(0,a.useEffect)(()=>{g()},[d]);let g=async()=>{try{if(i(!0),!eM.Z.isAuthenticated()){ew.ZP.error("Please log in to view users");return}let e=await eM.Z.get(`/api/users?role=${d}`);e.error?ew.ZP.error(e.error):s(e.data?.users||[])}catch(e){console.error("Error fetching users:",e),ew.ZP.error("Failed to fetch users")}finally{i(!1)}},y=async e=>{try{let r=await eM.Z.post("/api/users",e);r.error?ew.ZP.error(r.error):(s([r.data,...t]),u(!1),ew.ZP.success("User created successfully!"))}catch(e){console.error("Error creating user:",e),ew.ZP.error("Failed to create user")}},f=async e=>{if(h)try{let r=await eM.Z.put(`/api/users/${h.id}`,e);r.error?ew.ZP.error(r.error):(s(t.map(e=>e.id===r.data.id?r.data:e)),p(null),ew.ZP.success("User updated successfully!"))}catch(e){console.error("Error updating user:",e),ew.ZP.error("Failed to update user")}},b=async e=>{if(confirm("Are you sure you want to delete this user? This action cannot be undone."))try{let r=await eM.Z.delete(`/api/users/${e}`);r.error?ew.ZP.error(r.error):(s(t.filter(t=>t.id!==e)),ew.ZP.success("User deleted successfully!"))}catch(e){console.error("Error deleting user:",e),ew.ZP.error("Failed to delete user")}},j=t.filter(e=>e.name.toLowerCase().includes(o.toLowerCase())||e.email.toLowerCase().includes(o.toLowerCase())),N=e=>{switch(e){case"ADMIN":return r.jsx(A,{className:"h-4 w-4 text-red-500"});case"LIBRARIAN":return r.jsx(eI,{className:"h-4 w-4 text-blue-500"});case"MEMBER":return r.jsx(B,{className:"h-4 w-4 text-green-500"});default:return r.jsx(B,{className:"h-4 w-4 text-gray-500"})}},v=e=>{switch(e){case"ADMIN":return"bg-red-100 text-red-800";case"LIBRARIAN":return"bg-blue-100 text-blue-800";case"MEMBER":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"User Management"}),r.jsx("p",{className:"text-gray-600 mt-1",children:"Manage admin and librarian accounts"})]}),(0,r.jsxs)("button",{onClick:()=>u(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[r.jsx(z,{className:"h-4 w-4"}),r.jsx("span",{children:"Add User"})]})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,r.jsxs)("div",{className:"flex-1 relative",children:[r.jsx(R,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),r.jsx("input",{type:"text",placeholder:"Search users...",value:o,onChange:e=>c(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"})]}),r.jsx("select",{value:d,onChange:e=>x(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600",children:["all","ADMIN","LIBRARIAN","MEMBER"].map(e=>r.jsx("option",{value:e,children:"all"===e?"All Roles":e.charAt(0)+e.slice(1).toLowerCase()},e))})]}),n?(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),r.jsx("p",{className:"text-gray-600 mt-4",children:"Loading users..."})]}):r.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),r.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:j.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:r.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center",children:r.jsx(P,{className:"h-5 w-5 text-gray-600"})})}),(0,r.jsxs)("div",{className:"ml-4",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name}),r.jsx("div",{className:"text-sm text-gray-500",children:e.email})]})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[N(e.role),r.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${v(e.role)}`,children:e.role})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.createdAt).toLocaleDateString()}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,r.jsxs)("div",{className:"flex items-center justify-end space-x-2",children:[r.jsx("button",{onClick:()=>p(e),className:"text-blue-600 hover:text-blue-900",children:r.jsx(et,{className:"h-4 w-4"})}),e.id!==e?.id&&r.jsx("button",{onClick:()=>b(e.id),className:"text-red-600 hover:text-red-900",children:r.jsx(es,{className:"h-4 w-4"})})]})})]},e.id))})]})}),0===j.length&&!n&&(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx(P,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No users found"}),r.jsx("p",{className:"text-gray-600",children:"Try adjusting your search or filter criteria"})]}),m&&r.jsx(eO,{title:"Add New User",onSubmit:y,onClose:()=>u(!1)}),h&&r.jsx(eO,{title:"Edit User",user:h,onSubmit:f,onClose:()=>p(null)})]})},e_=o("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),eB=()=>{let{state:e}=(0,q.y)(),{books:t,members:s,borrowings:l,attendance:n}=e,[i,o]=(0,a.useState)("30days"),c=t.length,d=s.length,x=l.filter(e=>"BORROWED"===e.status).length,u=l.filter(e=>new Date(e.dueDate)<new Date&&"BORROWED"===e.status).length,h=new Date(new Date().getTime()-2592e6),p=l.filter(e=>new Date(e.borrowDate)>=h).length,g=n.filter(e=>new Date(e.checkInTime)>=h).length,y=t.reduce((e,t)=>(e[t.category]=(e[t.category]||0)+1,e),{}),f=[{title:"Library Overview",icon:L,stats:[{label:"Total Books",value:c,color:"text-blue-600"},{label:"Total Members",value:d,color:"text-green-600"},{label:"Active Loans",value:x,color:"text-yellow-600"},{label:"Overdue Books",value:u,color:"text-red-600"}]},{title:"Activity (Last 30 Days)",icon:H,stats:[{label:"New Borrowings",value:p,color:"text-blue-600"},{label:"Library Visits",value:g,color:"text-green-600"},{label:"Available Books",value:c-x,color:"text-purple-600"},{label:"Return Rate",value:"94%",color:"text-orange-600"}]}];return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-center gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Reports & Analytics"}),r.jsx("p",{className:"text-sm sm:text-base text-gray-600 mt-1 sm:mt-2",children:"Library performance and usage statistics"})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,r.jsxs)("select",{value:i,onChange:e=>o(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-base w-full sm:w-auto",children:[r.jsx("option",{value:"7days",children:"Last 7 days"}),r.jsx("option",{value:"30days",children:"Last 30 days"}),r.jsx("option",{value:"90days",children:"Last 90 days"}),r.jsx("option",{value:"1year",children:"Last year"})]}),(0,r.jsxs)("button",{className:"bg-blue-600 text-white px-3 sm:px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center justify-center space-x-2 text-sm sm:text-base w-full sm:w-auto",children:[r.jsx(X,{className:"h-4 w-4 sm:h-5 sm:w-5"}),r.jsx("span",{children:"Export"})]})]})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:f.map((e,t)=>(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center mb-4",children:[r.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:r.jsx(e.icon,{className:"h-6 w-6 text-blue-600"})}),r.jsx("h3",{className:"text-lg font-semibold text-gray-900 ml-3",children:e.title})]}),r.jsx("div",{className:"space-y-3",children:e.stats.map((e,t)=>(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"text-sm text-gray-600",children:e.label}),r.jsx("span",{className:`text-lg font-bold ${e.color}`,children:e.value})]},t))})]},t))}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Books by Category"}),r.jsx("div",{className:"space-y-3",children:Object.entries(y).map(([e,t])=>{let s=t/c*100;return(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{className:"text-gray-600 capitalize",children:e}),(0,r.jsxs)("span",{className:"font-medium text-gray-900",children:[t," books"]})]}),r.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:r.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${s}%`}})})]},e)})})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Activity"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:r.jsx(L,{className:"h-4 w-4 text-blue-600"})}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:"New Book Added"}),r.jsx("p",{className:"text-xs text-gray-500",children:'"The Great Gatsby" by F. Scott Fitzgerald'})]})]}),r.jsx("span",{className:"text-xs text-gray-500",children:"2 hours ago"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:r.jsx(P,{className:"h-4 w-4 text-green-600"})}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:"New Member Registered"}),r.jsx("p",{className:"text-xs text-gray-500",children:"John Doe joined the library"})]})]}),r.jsx("span",{className:"text-xs text-gray-500",children:"4 hours ago"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-yellow-50 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:r.jsx(H,{className:"h-4 w-4 text-yellow-600"})}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Book Returned"}),r.jsx("p",{className:"text-xs text-gray-500",children:'"1984" by George Orwell'})]})]}),r.jsx("span",{className:"text-xs text-gray-500",children:"6 hours ago"})]})]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[r.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Detailed Reports"}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[r.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600",children:r.jsx(e_,{className:"h-4 w-4"})}),r.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600",children:r.jsx(m,{className:"h-4 w-4"})})]})]})}),r.jsx("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Report Type"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Period"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Generated"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsxs)("tbody",{className:"bg-white divide-y divide-gray-200",children:[(0,r.jsxs)("tr",{children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"Borrowing Report"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"Last 30 days"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date().toLocaleDateString()}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:r.jsx("button",{className:"text-blue-600 hover:text-blue-900",children:"View"})})]}),(0,r.jsxs)("tr",{children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"Member Activity"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"Last 30 days"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date().toLocaleDateString()}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:r.jsx("button",{className:"text-blue-600 hover:text-blue-900",children:"View"})})]}),(0,r.jsxs)("tr",{children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"Overdue Books"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"Current"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date().toLocaleDateString()}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:r.jsx("button",{className:"text-blue-600 hover:text-blue-900",children:"View"})})]})]})]})})]})]})},e$=o("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),eU=o("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),eF=o("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),eV=o("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),eq=o("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),ez=o("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);class eZ{constructor(e){this.settings=e}isChannelEnabled(e){return this.settings[e]||!1}isNotificationEnabled(e){return this.settings[e]||!1}isInQuietHours(){if(!this.settings.quietHours.enabled)return!1;let e=new Date,t=60*e.getHours()+e.getMinutes(),[s,r]=this.settings.quietHours.start.split(":").map(Number),[a,l]=this.settings.quietHours.end.split(":").map(Number),n=60*s+r,i=60*a+l;return n>i?t>=n||t<=i:t>=n&&t<=i}async sendEmailNotification(e,t,s){if(!this.isChannelEnabled("email")||this.isInQuietHours())return!1;try{return console.log(`📧 Email sent to ${e}: ${t}`),console.log(`Message: ${s}`),(await fetch("/api/notifications/email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:e,subject:t,message:s})})).ok}catch(e){return console.error("Failed to send email notification:",e),!1}}async sendSMSNotification(e,t){if(!this.isChannelEnabled("sms")||this.isInQuietHours())return!1;try{return console.log(`📱 SMS sent to ${e}: ${t}`),(await fetch("/api/notifications/sms",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:e,message:t})})).ok}catch(e){return console.error("Failed to send SMS notification:",e),!1}}async sendPushNotification(e,t,s){if(!this.isChannelEnabled("push")||this.isInQuietHours())return!1;try{if(!("Notification"in window))return console.warn("This browser does not support notifications"),!1;if("default"===Notification.permission){let e=await Notification.requestPermission();if("granted"!==e)return console.warn("Notification permission denied"),!1}if("granted"===Notification.permission){let r=new Notification(e,{body:t,icon:"/favicon.ico",data:s});return setTimeout(()=>r.close(),5e3),!0}return!1}catch(e){return console.error("Failed to send push notification:",e),!1}}async sendNotification(e,t,s,r){if(!this.isNotificationEnabled(e))return{email:!1,sms:!1,push:!1};let a={email:!1,sms:!1,push:!1};return this.isChannelEnabled("email")&&r?.email&&(a.email=await this.sendEmailNotification(r.email,t,s)),this.isChannelEnabled("sms")&&r?.phone&&(a.sms=await this.sendSMSNotification(r.phone,s)),this.isChannelEnabled("push")&&(a.push=await this.sendPushNotification(t,s)),a}updateSettings(e){this.settings={...this.settings,...e}}getSettings(){return{...this.settings}}}let eH=()=>{let{user:e}=(0,l.a)(),[t,s]=(0,a.useState)(null);(0,a.useEffect)(()=>{s(new eZ(e?.settings?.notifications||{email:!0,sms:!0,push:!0,overdue:!0,reservations:!0,newBooks:!0,systemUpdates:!0,borrowingReminders:!0,returnReminders:!0,overdueAlerts:!0,frequency:"immediate",quietHours:{enabled:!1,start:"22:00",end:"08:00"},emailSettings:{overdueReminders:!0,reservationAlerts:!0,borrowingConfirmations:!0,returnReminders:!0}}))},[e?.settings?.notifications]);let r=(0,a.useCallback)(async()=>"Notification"in window?"granted"===Notification.permission||("denied"===Notification.permission?(ew.ZP.error("Notification permission denied. Please enable notifications in your browser settings."),!1):"granted"===await Notification.requestPermission()?(ew.ZP.success("✅ Notification permission granted!"),!0):(ew.ZP.error("❌ Notification permission denied"),!1)):(ew.ZP.error("This browser does not support notifications"),!1),[]),n=(0,a.useCallback)(async(e,s,r,a)=>{if(!t){console.warn("Notification service not initialized");return}try{let l=await t.sendNotification(e,s,r,a),n=Object.values(l).filter(Boolean).length;n>0?ew.ZP.success(`✅ Notification sent via ${n} channel(s)`):ew.ZP.error("❌ Failed to send notification")}catch(e){console.error("Error sending notification:",e),ew.ZP.error("❌ Error sending notification")}},[t]),i=(0,a.useCallback)(async()=>{if(!t){ew.ZP.error("Notification service not initialized");return}try{await t.sendEmailNotification(e?.email||"test@example.com","Test Email Notification","This is a test email notification from the library management system.")?ew.ZP.success("✅ Test email notification sent successfully!"):ew.ZP.error("❌ Failed to send test email notification")}catch(e){ew.ZP.error("❌ Error sending test email notification")}},[t,e?.email]),o=(0,a.useCallback)(async()=>{if(!t){ew.ZP.error("Notification service not initialized");return}try{await t.sendSMSNotification(e?.phone||"+1234567890","Test SMS notification from library system")?ew.ZP.success("✅ Test SMS notification sent successfully!"):ew.ZP.error("❌ Failed to send test SMS notification")}catch(e){ew.ZP.error("❌ Error sending test SMS notification")}},[t,e?.phone]),c=(0,a.useCallback)(async()=>{if(!t){ew.ZP.error("Notification service not initialized");return}try{await t.sendPushNotification("Test Push Notification","This is a test push notification from the library management system.")?ew.ZP.success("✅ Test push notification sent successfully!"):ew.ZP.error("❌ Failed to send test push notification")}catch(e){ew.ZP.error("❌ Error sending test push notification")}},[t]);return{notificationService:t,sendNotification:n,testEmailNotification:i,testSMSNotification:o,testPushNotification:c,requestNotificationPermission:r}},eY=()=>{let{sendNotification:e}=eH(),{user:t}=(0,l.a)();return{notifyBookBorrowed:async(s,r,a)=>{await e("borrowingReminders","\uD83D\uDCDA Book Borrowed",`${r} has borrowed "${s}". Due date: ${a}`,{email:t?.email})},notifyBookReturned:async(s,r)=>{await e("returnReminders","\uD83D\uDCD6 Book Returned",`${r} has returned "${s}"`,{email:t?.email})},notifyBookOverdue:async(s,r,a)=>{await e("overdueAlerts","⚠️ Book Overdue",`"${s}" borrowed by ${r} is ${a} days overdue`,{email:t?.email,phone:t?.phone})},notifyNewBookAdded:async(s,r)=>{await e("newBooks","\uD83C\uDD95 New Book Added",`New book "${s}" by ${r} has been added to the library`,{email:t?.email})},notifyReservationMade:async(s,r)=>{await e("reservations","\uD83D\uDCCB Book Reserved",`${r} has reserved "${s}"`,{email:t?.email})},notifyReservationReady:async(s,r)=>{await e("reservations","✅ Reservation Ready",`"${s}" is now available for ${r}`,{email:t?.email,phone:t?.phone})},notifySystemUpdate:async s=>{await e("systemUpdates","⚙️ System Update",s,{email:t?.email})},notifyMaintenance:async s=>{await e("systemUpdates","\uD83D\uDD27 System Maintenance",s,{email:t?.email})},notifyReminder:async(s,r,a="borrowingReminders")=>{await e(a,`🔔 ${s}`,r,{email:t?.email,phone:t?.phone})}}},eW=()=>{let{notificationService:e,testEmailNotification:t,testSMSNotification:s,testPushNotification:l,requestNotificationPermission:n}=eH(),{notifyBookBorrowed:i,notifyBookReturned:o,notifyBookOverdue:c,notifyNewBookAdded:d,notifyReservationMade:x}=eY(),[m,u]=(0,a.useState)([]),[h,p]=(0,a.useState)(!1),[g,f]=(0,a.useState)(!0);(0,a.useEffect)(()=>{e&&f(!1)},[e]);let b=e=>{let t={...e,id:Date.now().toString(),timestamp:new Date};u(e=>[t,...e.slice(0,49)])},j=async()=>{p(!0);try{await t(),b({type:"email",title:"Test Email Notification",message:"This is a test email notification",status:"sent",channels:{email:!0,sms:!1,push:!1}}),await s(),b({type:"sms",title:"Test SMS Notification",message:"This is a test SMS notification",status:"sent",channels:{email:!1,sms:!0,push:!1}}),await l(),b({type:"push",title:"Test Push Notification",message:"This is a test push notification",status:"sent",channels:{email:!1,sms:!1,push:!0}}),await i("Test Book","John Doe","2025-10-23"),b({type:"borrowingReminders",title:"Book Borrowed",message:'John Doe has borrowed "Test Book"',status:"sent",channels:{email:!0,sms:!1,push:!0}}),await d("New Test Book","Test Author"),b({type:"newBooks",title:"New Book Added",message:'New book "New Test Book" by Test Author has been added',status:"sent",channels:{email:!0,sms:!1,push:!0}})}catch(e){console.error("Error testing notifications:",e)}finally{p(!1)}},N=e=>{switch(e){case"sent":return r.jsx(v,{className:"w-4 h-4 text-green-500"});case"failed":return r.jsx(ef,{className:"w-4 h-4 text-red-500"});case"pending":return r.jsx(D,{className:"w-4 h-4 text-yellow-500"});default:return r.jsx(D,{className:"w-4 h-4 text-gray-500"})}},w=e=>{switch(e){case"email":return r.jsx(eV,{className:"w-3 h-3 text-blue-500"});case"sms":return r.jsx(eq,{className:"w-3 h-3 text-green-500"});case"push":return r.jsx(ez,{className:"w-3 h-3 text-purple-500"});default:return null}};return g?r.jsx("div",{className:"space-y-6",children:r.jsx("div",{className:"flex items-center justify-center py-12",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"w-6 h-6 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),r.jsx("span",{className:"text-gray-600",children:"Initializing notification service..."})]})})}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx(y,{className:"w-6 h-6 text-blue-600"}),r.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Notification Dashboard"})]}),r.jsx("button",{onClick:j,disabled:h,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:h?(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),r.jsx("span",{children:"Testing..."})]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(y,{className:"w-4 h-4"}),r.jsx("span",{children:"Test All Notifications"})]})})]}),e&&(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Current Settings"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx(eV,{className:"w-5 h-5 text-blue-500"}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Email Notifications"}),r.jsx("p",{className:"text-sm text-gray-500",children:e.isChannelEnabled("email")?"Enabled":"Disabled"})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx(eq,{className:"w-5 h-5 text-green-500"}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:"SMS Notifications"}),r.jsx("p",{className:"text-sm text-gray-500",children:e.isChannelEnabled("sms")?"Enabled":"Disabled"})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx(ez,{className:"w-5 h-5 text-purple-500"}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Push Notifications"}),r.jsx("p",{className:"text-sm text-gray-500",children:e.isChannelEnabled("push")?"Enabled":"Disabled"})]})]})]}),e.isInQuietHours()&&r.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:r.jsx("p",{className:"text-sm text-yellow-800",children:"\uD83D\uDD15 Currently in quiet hours - notifications are suppressed"})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200",children:[r.jsx("div",{className:"p-6 border-b border-gray-200",children:r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Notifications"})}),r.jsx("div",{className:"divide-y divide-gray-200",children:0===m.length?(0,r.jsxs)("div",{className:"p-6 text-center text-gray-500",children:[r.jsx(y,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),r.jsx("p",{children:"No notifications sent yet"}),r.jsx("p",{className:"text-sm",children:'Click "Test All Notifications" to see how notifications work'})]}):m.map(e=>r.jsx("div",{className:"p-6 hover:bg-gray-50",children:r.jsx("div",{className:"flex items-start justify-between",children:(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[N(e.status),r.jsx("h4",{className:"text-sm font-medium text-gray-900",children:e.title}),r.jsx("span",{className:"text-xs text-gray-500",children:e.timestamp.toLocaleTimeString()})]}),r.jsx("p",{className:"text-sm text-gray-600 mb-3",children:e.message}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("span",{className:"text-xs text-gray-500",children:"Channels:"}),Object.entries(e.channels).map(([e,t])=>t&&(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[w(e),r.jsx("span",{className:"text-xs text-gray-600 capitalize",children:e})]},e))]}),(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:["Type: ",e.type]})]})]})})},e.id))})]})]})},eG=()=>{let[e,t]=(0,a.useState)("general"),[s,l]=(0,a.useState)(!1),[n,i]=(0,a.useState)(!1),[o,d]=(0,a.useState)({current:!1,new:!1,confirm:!1}),{testEmailNotification:u,testSMSNotification:h,testPushNotification:p,requestNotificationPermission:g}=eH(),[b,j]=(0,a.useState)({libraryName:"Robert Aboagye Mensah Community Library",libraryAddress:"",libraryEmail:"",libraryPhone:"",maxBorrowDays:14,maxBooksPerMember:5,overdueFinePerDay:.5,notifications:{email:!0,sms:!1,push:!0,overdue:!0,reservations:!0,newBooks:!0,systemUpdates:!0,borrowingReminders:!0,returnReminders:!0,overdueAlerts:!0,frequency:"immediate",quietHours:{enabled:!1,start:"22:00",end:"08:00"},emailSettings:{overdueReminders:!0,weeklyDigest:!1,systemAlerts:!0,marketingEmails:!1}},theme:"light",language:"en"}),[N,v]=(0,a.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),w=[{id:"general",label:"General",icon:f},{id:"borrowing",label:"Borrowing Rules",icon:c},{id:"notifications",label:"Notifications",icon:y},{id:"security",label:"Security",icon:A},{id:"backup",label:"Backup & Export",icon:ea},{id:"appearance",label:"Appearance",icon:e$}];(0,a.useEffect)(()=>{k()},[]),(0,a.useEffect)(()=>{},[b.theme]);let k=async()=>{l(!0);try{let e=await fetch("/api/settings");if(e.ok){let t=await e.json();j(t)}else ew.ZP.error("Failed to load settings")}catch(e){console.error("Error loading settings:",e),ew.ZP.error("Failed to load settings")}finally{l(!1)}},S=(e,t)=>{if(e.includes(".")){let[s,r]=e.split(".");j(e=>({...e,[s]:{...e[s],[r]:t}}))}else j(s=>({...s,[e]:t}))},C=async()=>{if(!b.libraryName.trim()){ew.ZP.error("Library name is required");return}if(b.maxBorrowDays<1){ew.ZP.error("Maximum borrow days must be at least 1");return}if(b.maxBooksPerMember<1){ew.ZP.error("Maximum books per member must be at least 1");return}if(b.overdueFinePerDay<0){ew.ZP.error("Overdue fine cannot be negative");return}i(!0);try{let e=await fetch("/api/settings",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(e.ok){let t=await e.json();j(t),ew.ZP.success("Settings saved successfully!")}else{let t=await e.json();ew.ZP.error(t.error||"Failed to save settings")}}catch(e){console.error("Error saving settings:",e),ew.ZP.error("Failed to save settings. Please check your connection.")}finally{i(!1)}},E=async()=>{try{let e=await fetch("/api/settings/backup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"export"})});if(e.ok){let t=await e.blob(),s=window.URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download=`library-export-${new Date().toISOString().split("T")[0]}.json`,r.style.display="none",document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(s),document.body.removeChild(r),ew.ZP.success("Library data exported successfully!")}else{let t=await e.json();ew.ZP.error(t.error||"Failed to export data")}}catch(e){console.error("Error exporting data:",e),ew.ZP.error("Failed to export data. Please check your connection.")}},P=async()=>{try{let e=await fetch("/api/settings/backup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"backup"})});if(e.ok){let t=await e.blob(),s=window.URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download=`library-backup-${new Date().toISOString().replace(/[:.]/g,"-")}.json`,r.style.display="none",document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(s),document.body.removeChild(r),ew.ZP.success("Backup created successfully!")}else{let t=await e.json();ew.ZP.error(t.error||"Failed to create backup")}}catch(e){console.error("Error creating backup:",e),ew.ZP.error("Failed to create backup. Please check your connection.")}},R=async e=>{if(e.preventDefault(),N.newPassword!==N.confirmPassword){ew.ZP.error("New passwords do not match");return}if(N.newPassword.length<6){ew.ZP.error("New password must be at least 6 characters long");return}try{let e=await fetch("/api/auth/change-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:N.currentPassword,newPassword:N.newPassword})});if(e.ok)ew.ZP.success("Password changed successfully!"),v({currentPassword:"",newPassword:"",confirmPassword:""});else{let t=await e.json();ew.ZP.error(t.error||"Failed to change password")}}catch(e){console.error("Error changing password:",e),ew.ZP.error("Failed to change password")}},D=e=>{d(t=>({...t,[e]:!t[e]}))},T=()=>(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Library Name *"}),r.jsx("input",{type:"text",value:b.libraryName,onChange:e=>S("libraryName",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",required:!0})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Library Address"}),r.jsx("textarea",{rows:3,value:b.libraryAddress,onChange:e=>S("libraryAddress",e.target.value),placeholder:"Enter library address...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Information"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx("div",{children:r.jsx("input",{type:"email",value:b.libraryEmail,onChange:e=>S("libraryEmail",e.target.value),placeholder:"Email address",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})}),r.jsx("div",{children:r.jsx("input",{type:"tel",value:b.libraryPhone,onChange:e=>S("libraryPhone",e.target.value),placeholder:"Phone number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})})]})]})]}),I=()=>(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Maximum Borrow Days *"}),r.jsx("input",{type:"number",min:"1",value:b.maxBorrowDays,onChange:e=>S("maxBorrowDays",parseInt(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",required:!0}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Number of days a book can be borrowed"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Maximum Books Per Member *"}),r.jsx("input",{type:"number",min:"1",value:b.maxBooksPerMember,onChange:e=>S("maxBooksPerMember",parseInt(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",required:!0}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Maximum number of books a member can borrow at once"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Overdue Fine Per Day ($) *"}),r.jsx("input",{type:"number",step:"0.01",min:"0",value:b.overdueFinePerDay,onChange:e=>S("overdueFinePerDay",parseFloat(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",required:!0}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Fine amount charged per day for overdue books"})]})]}),M=()=>r.jsx("div",{className:"space-y-6",children:(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Change Password"}),(0,r.jsxs)("form",{onSubmit:R,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Password"}),(0,r.jsxs)("div",{className:"relative",children:[r.jsx("input",{type:o.current?"text":"password",value:N.currentPassword,onChange:e=>v(t=>({...t,currentPassword:e.target.value})),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",required:!0}),r.jsx("button",{type:"button",onClick:()=>D("current"),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:o.current?r.jsx(x,{className:"h-5 w-5 text-gray-400"}):r.jsx(m,{className:"h-5 w-5 text-gray-400"})})]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password"}),(0,r.jsxs)("div",{className:"relative",children:[r.jsx("input",{type:o.new?"text":"password",value:N.newPassword,onChange:e=>v(t=>({...t,newPassword:e.target.value})),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",required:!0,minLength:6}),r.jsx("button",{type:"button",onClick:()=>D("new"),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:o.new?r.jsx(x,{className:"h-5 w-5 text-gray-400"}):r.jsx(m,{className:"h-5 w-5 text-gray-400"})})]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm New Password"}),(0,r.jsxs)("div",{className:"relative",children:[r.jsx("input",{type:o.confirm?"text":"password",value:N.confirmPassword,onChange:e=>v(t=>({...t,confirmPassword:e.target.value})),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",required:!0,minLength:6}),r.jsx("button",{type:"button",onClick:()=>D("confirm"),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:o.confirm?r.jsx(x,{className:"h-5 w-5 text-gray-400"}):r.jsx(m,{className:"h-5 w-5 text-gray-400"})})]})]}),(0,r.jsxs)("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2",children:[r.jsx(A,{className:"h-5 w-5"}),r.jsx("span",{children:"Change Password"})]})]})]})}),O=()=>r.jsx("div",{className:"space-y-6",children:(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Backup & Export"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"p-4 border border-gray-200 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx(X,{className:"h-8 w-8 text-green-600"}),(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"font-medium text-gray-900",children:"Export Library Data"}),r.jsx("p",{className:"text-sm text-gray-500",children:"Download all library data as JSON"})]})]}),(0,r.jsxs)("button",{onClick:E,className:"w-full bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center justify-center space-x-2",children:[r.jsx(X,{className:"h-5 w-5"}),r.jsx("span",{children:"Export Data"})]})]}),(0,r.jsxs)("div",{className:"p-4 border border-gray-200 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx(ea,{className:"h-8 w-8 text-blue-600"}),(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"font-medium text-gray-900",children:"Create Backup"}),r.jsx("p",{className:"text-sm text-gray-500",children:"Create a complete backup with timestamp"})]})]}),(0,r.jsxs)("button",{onClick:P,className:"w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center justify-center space-x-2",children:[r.jsx(ea,{className:"h-5 w-5"}),r.jsx("span",{children:"Create Backup"})]})]})]})]})}),L=()=>r.jsx("div",{className:"space-y-6",children:(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Appearance"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Theme"}),(0,r.jsxs)("select",{value:b.theme,onChange:e=>S("theme",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",children:[r.jsx("option",{value:"light",children:"Light"}),r.jsx("option",{value:"dark",children:"Dark"}),r.jsx("option",{value:"auto",children:"Auto (System)"})]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Language"}),(0,r.jsxs)("select",{value:b.language,onChange:e=>S("language",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",children:[r.jsx("option",{value:"en",children:"English"}),r.jsx("option",{value:"es",children:"Espa\xf1ol"}),r.jsx("option",{value:"fr",children:"Fran\xe7ais"}),r.jsx("option",{value:"de",children:"Deutsch"})]})]})]})]})});return s?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 space-y-4",children:[r.jsx(eU,{className:"h-8 w-8 animate-spin text-blue-600"}),(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("p",{className:"text-gray-600 font-medium",children:"Loading settings..."}),r.jsx("p",{className:"text-sm text-gray-500",children:"Please wait while we fetch your preferences"})]})]}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-center gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-gray-900",children:"Settings"}),r.jsx("p",{className:"text-gray-600 mt-2",children:"Manage your library system preferences"})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,r.jsxs)("button",{onClick:C,disabled:n,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2 w-full sm:w-auto justify-center",children:[n?r.jsx(eU,{className:"h-5 w-5 animate-spin"}):r.jsx(eF,{className:"h-5 w-5"}),r.jsx("span",{children:n?"Saving...":"Save Changes"})]}),(0,r.jsxs)("button",{onClick:k,disabled:s,className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2 w-full sm:w-auto justify-center",children:[s?r.jsx(eU,{className:"h-5 w-5 animate-spin"}):r.jsx(Y,{className:"h-5 w-5"}),r.jsx("span",{children:"Reset"})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[r.jsx("div",{className:"lg:col-span-1",children:r.jsx("nav",{className:"space-y-1",children:w.map(s=>{let a=s.icon;return(0,r.jsxs)("button",{onClick:()=>t(s.id),className:`w-full flex items-center space-x-3 px-3 py-2 text-left rounded-lg transition-colors ${e===s.id?"bg-blue-100 text-blue-700":"text-gray-700 hover:bg-gray-100"}`,children:[r.jsx(a,{className:"h-5 w-5"}),r.jsx("span",{className:"font-medium",children:s.label})]},s.id)})})}),r.jsx("div",{className:"lg:col-span-3",children:r.jsx("div",{className:"bg-white p-4 lg:p-6 rounded-lg shadow-sm border border-gray-200",children:(()=>{switch(e){case"general":default:return T();case"borrowing":return I();case"notifications":return r.jsx(eW,{});case"security":return M();case"backup":return O();case"appearance":return L()}})()})})]})]})};function eQ(){let[e,t]=(0,a.useState)("dashboard"),[s,n]=(0,a.useState)(!1),{state:i}=(0,l.a)();return(0,r.jsxs)(h,{children:[r.jsx(V,{}),(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(M,{onNavigate:(e,s)=>{t(e),n(!1),s&&(sessionStorage.setItem("highlightPersonId",s),setTimeout(()=>{let e=document.getElementById(`person-${s}`);e&&(e.scrollIntoView({behavior:"smooth",block:"center"}),e.classList.add("bg-yellow-100","border-yellow-300","border-2"),setTimeout(()=>{e.classList.remove("bg-yellow-100","border-yellow-300","border-2")},3e3))},500))},onMenuToggle:()=>n(!s),isSidebarOpen:s}),s&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden",onClick:()=>n(!1)}),(0,r.jsxs)("div",{className:"flex",children:[r.jsx("div",{className:`
            ${s?"translate-x-0":"-translate-x-full"}
            md:translate-x-0
            fixed md:relative 
            z-50 md:z-auto
            transition-transform duration-300 ease-in-out
            w-64
          `,children:r.jsx(F,{activePage:e,setActivePage:e=>{t(e),n(!1)},onClose:()=>n(!1)})}),r.jsx("main",{className:"flex-1 p-4 md:p-6 min-h-screen",children:(()=>{switch(e){case"dashboard":default:return r.jsx(G,{});case"catalog":return r.jsx(eg,{});case"people":return r.jsx(ek,{});case"borrowing":return r.jsx(eS,{});case"attendance":return r.jsx(eP,{});case"tracking":return r.jsx(eT,{});case"users":return r.jsx(eL,{});case"reports":return r.jsx(eB,{});case"settings":return r.jsx(eG,{})}})()})]})]})]})}},908:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(8570).createProxy)(String.raw`C:\Users\USER\Desktop\Library Project\app\page.tsx#default`)},338:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{ACTION:function(){return r},FLIGHT_PARAMETERS:function(){return o},NEXT_DID_POSTPONE_HEADER:function(){return d},NEXT_ROUTER_PREFETCH_HEADER:function(){return l},NEXT_ROUTER_STATE_TREE:function(){return a},NEXT_RSC_UNION_QUERY:function(){return c},NEXT_URL:function(){return n},RSC_CONTENT_TYPE_HEADER:function(){return i},RSC_HEADER:function(){return s}});let s="RSC",r="Next-Action",a="Next-Router-State-Tree",l="Next-Router-Prefetch",n="Next-Url",i="text/x-component",o=[[s],[a],[l]],c="_rsc",d="x-nextjs-postponed";("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},7255:e=>{(()=>{"use strict";"undefined"!=typeof __nccwpck_require__&&(__nccwpck_require__.ab=__dirname+"/");var t={};(()=>{t.parse=function(t,s){if("string"!=typeof t)throw TypeError("argument str must be a string");for(var a={},l=t.split(r),n=(s||{}).decode||e,i=0;i<l.length;i++){var o=l[i],c=o.indexOf("=");if(!(c<0)){var d=o.substr(0,c).trim(),x=o.substr(++c,o.length).trim();'"'==x[0]&&(x=x.slice(1,-1)),void 0==a[d]&&(a[d]=function(e,t){try{return t(e)}catch(t){return e}}(x,n))}}return a},t.serialize=function(e,t,r){var l=r||{},n=l.encode||s;if("function"!=typeof n)throw TypeError("option encode is invalid");if(!a.test(e))throw TypeError("argument name is invalid");var i=n(t);if(i&&!a.test(i))throw TypeError("argument val is invalid");var o=e+"="+i;if(null!=l.maxAge){var c=l.maxAge-0;if(isNaN(c)||!isFinite(c))throw TypeError("option maxAge is invalid");o+="; Max-Age="+Math.floor(c)}if(l.domain){if(!a.test(l.domain))throw TypeError("option domain is invalid");o+="; Domain="+l.domain}if(l.path){if(!a.test(l.path))throw TypeError("option path is invalid");o+="; Path="+l.path}if(l.expires){if("function"!=typeof l.expires.toUTCString)throw TypeError("option expires is invalid");o+="; Expires="+l.expires.toUTCString()}if(l.httpOnly&&(o+="; HttpOnly"),l.secure&&(o+="; Secure"),l.sameSite)switch("string"==typeof l.sameSite?l.sameSite.toLowerCase():l.sameSite){case!0:case"strict":o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"none":o+="; SameSite=None";break;default:throw TypeError("option sameSite is invalid")}return o};var e=decodeURIComponent,s=encodeURIComponent,r=/; */,a=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/})(),e.exports=t})()},1792:(e,t)=>{"use strict";function s(e,t){void 0===t&&(t={});for(var s=function(e){for(var t=[],s=0;s<e.length;){var r=e[s];if("*"===r||"+"===r||"?"===r){t.push({type:"MODIFIER",index:s,value:e[s++]});continue}if("\\"===r){t.push({type:"ESCAPED_CHAR",index:s++,value:e[s++]});continue}if("{"===r){t.push({type:"OPEN",index:s,value:e[s++]});continue}if("}"===r){t.push({type:"CLOSE",index:s,value:e[s++]});continue}if(":"===r){for(var a="",l=s+1;l<e.length;){var n=e.charCodeAt(l);if(n>=48&&n<=57||n>=65&&n<=90||n>=97&&n<=122||95===n){a+=e[l++];continue}break}if(!a)throw TypeError("Missing parameter name at "+s);t.push({type:"NAME",index:s,value:a}),s=l;continue}if("("===r){var i=1,o="",l=s+1;if("?"===e[l])throw TypeError('Pattern cannot start with "?" at '+l);for(;l<e.length;){if("\\"===e[l]){o+=e[l++]+e[l++];continue}if(")"===e[l]){if(0==--i){l++;break}}else if("("===e[l]&&(i++,"?"!==e[l+1]))throw TypeError("Capturing groups are not allowed at "+l);o+=e[l++]}if(i)throw TypeError("Unbalanced pattern at "+s);if(!o)throw TypeError("Missing pattern at "+s);t.push({type:"PATTERN",index:s,value:o}),s=l;continue}t.push({type:"CHAR",index:s,value:e[s++]})}return t.push({type:"END",index:s,value:""}),t}(e),r=t.prefixes,a=void 0===r?"./":r,n="[^"+l(t.delimiter||"/#?")+"]+?",i=[],o=0,c=0,d="",x=function(e){if(c<s.length&&s[c].type===e)return s[c++].value},m=function(e){var t=x(e);if(void 0!==t)return t;var r=s[c];throw TypeError("Unexpected "+r.type+" at "+r.index+", expected "+e)},u=function(){for(var e,t="";e=x("CHAR")||x("ESCAPED_CHAR");)t+=e;return t};c<s.length;){var h=x("CHAR"),p=x("NAME"),g=x("PATTERN");if(p||g){var y=h||"";-1===a.indexOf(y)&&(d+=y,y=""),d&&(i.push(d),d=""),i.push({name:p||o++,prefix:y,suffix:"",pattern:g||n,modifier:x("MODIFIER")||""});continue}var f=h||x("ESCAPED_CHAR");if(f){d+=f;continue}if(d&&(i.push(d),d=""),x("OPEN")){var y=u(),b=x("NAME")||"",j=x("PATTERN")||"",N=u();m("CLOSE"),i.push({name:b||(j?o++:""),pattern:b&&!j?n:j,prefix:y,suffix:N,modifier:x("MODIFIER")||""});continue}m("END")}return i}function r(e,t){void 0===t&&(t={});var s=n(t),r=t.encode,a=void 0===r?function(e){return e}:r,l=t.validate,i=void 0===l||l,o=e.map(function(e){if("object"==typeof e)return RegExp("^(?:"+e.pattern+")$",s)});return function(t){for(var s="",r=0;r<e.length;r++){var l=e[r];if("string"==typeof l){s+=l;continue}var n=t?t[l.name]:void 0,c="?"===l.modifier||"*"===l.modifier,d="*"===l.modifier||"+"===l.modifier;if(Array.isArray(n)){if(!d)throw TypeError('Expected "'+l.name+'" to not repeat, but got an array');if(0===n.length){if(c)continue;throw TypeError('Expected "'+l.name+'" to not be empty')}for(var x=0;x<n.length;x++){var m=a(n[x],l);if(i&&!o[r].test(m))throw TypeError('Expected all "'+l.name+'" to match "'+l.pattern+'", but got "'+m+'"');s+=l.prefix+m+l.suffix}continue}if("string"==typeof n||"number"==typeof n){var m=a(String(n),l);if(i&&!o[r].test(m))throw TypeError('Expected "'+l.name+'" to match "'+l.pattern+'", but got "'+m+'"');s+=l.prefix+m+l.suffix;continue}if(!c){var u=d?"an array":"a string";throw TypeError('Expected "'+l.name+'" to be '+u)}}return s}}function a(e,t,s){void 0===s&&(s={});var r=s.decode,a=void 0===r?function(e){return e}:r;return function(s){var r=e.exec(s);if(!r)return!1;for(var l=r[0],n=r.index,i=Object.create(null),o=1;o<r.length;o++)!function(e){if(void 0!==r[e]){var s=t[e-1];"*"===s.modifier||"+"===s.modifier?i[s.name]=r[e].split(s.prefix+s.suffix).map(function(e){return a(e,s)}):i[s.name]=a(r[e],s)}}(o);return{path:l,index:n,params:i}}}function l(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function n(e){return e&&e.sensitive?"":"i"}function i(e,t,s){void 0===s&&(s={});for(var r=s.strict,a=void 0!==r&&r,i=s.start,o=s.end,c=s.encode,d=void 0===c?function(e){return e}:c,x="["+l(s.endsWith||"")+"]|$",m="["+l(s.delimiter||"/#?")+"]",u=void 0===i||i?"^":"",h=0;h<e.length;h++){var p=e[h];if("string"==typeof p)u+=l(d(p));else{var g=l(d(p.prefix)),y=l(d(p.suffix));if(p.pattern){if(t&&t.push(p),g||y){if("+"===p.modifier||"*"===p.modifier){var f="*"===p.modifier?"?":"";u+="(?:"+g+"((?:"+p.pattern+")(?:"+y+g+"(?:"+p.pattern+"))*)"+y+")"+f}else u+="(?:"+g+"("+p.pattern+")"+y+")"+p.modifier}else u+="("+p.pattern+")"+p.modifier}else u+="(?:"+g+y+")"+p.modifier}}if(void 0===o||o)a||(u+=m+"?"),u+=s.endsWith?"(?="+x+")":"$";else{var b=e[e.length-1],j="string"==typeof b?m.indexOf(b[b.length-1])>-1:void 0===b;a||(u+="(?:"+m+"(?="+x+"))?"),j||(u+="(?="+m+"|"+x+")")}return new RegExp(u,n(s))}function o(e,t,r){return e instanceof RegExp?function(e,t){if(!t)return e;var s=e.source.match(/\((?!\?)/g);if(s)for(var r=0;r<s.length;r++)t.push({name:r,prefix:"",suffix:"",modifier:"",pattern:""});return e}(e,t):Array.isArray(e)?RegExp("(?:"+e.map(function(e){return o(e,t,r).source}).join("|")+")",n(r)):i(s(e,r),t,r)}Object.defineProperty(t,"__esModule",{value:!0}),t.parse=s,t.compile=function(e,t){return r(s(e,t),t)},t.tokensToFunction=r,t.match=function(e,t){var s=[];return a(o(e,s,t),s,t)},t.regexpToFunction=a,t.tokensToRegexp=i,t.pathToRegexp=o},6621:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{fillMetadataSegment:function(){return x},normalizeMetadataRoute:function(){return m}});let r=s(616),a=function(e){return e&&e.__esModule?e:{default:e}}(s(1293)),l=s(7262),n=s(5679),i=s(8785),o=s(8168),c=s(1040);function d(e){let t="";return(e.includes("(")&&e.includes(")")||e.includes("@"))&&(t=(0,i.djb2Hash)(e).toString(36).slice(0,6)),t}function x(e,t,s){let r=(0,o.normalizeAppPath)(e),i=(0,n.getNamedRouteRegex)(r,!1),x=(0,l.interpolateDynamicPath)(r,t,i),m=d(e),u=m?`-${m}`:"",{name:h,ext:p}=a.default.parse(s);return(0,c.normalizePathSep)(a.default.join(x,`${h}${u}${p}`))}function m(e){if(!(0,r.isMetadataRoute)(e))return e;let t=e,s="";if("/robots"===e?t+=".txt":"/manifest"===e?t+=".webmanifest":e.endsWith("/sitemap")?t+=".xml":s=d(e.slice(0,-(a.default.basename(e).length+1))),!t.endsWith("/route")){let{dir:l,name:n,ext:i}=a.default.parse(t),o=(0,r.isStaticMetadataRoute)(e);t=a.default.posix.join(l,`${n}${s?`-${s}`:""}${i}`,o?"":"[[...__metadata_id__]]","route")}return t}},616:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{STATIC_METADATA_IMAGES:function(){return a},isMetadataRoute:function(){return d},isMetadataRouteFile:function(){return i},isStaticMetadataRoute:function(){return c},isStaticMetadataRouteFile:function(){return o}});let r=s(1040),a={icon:{filename:"icon",extensions:["ico","jpg","jpeg","png","svg"]},apple:{filename:"apple-icon",extensions:["jpg","jpeg","png"]},favicon:{filename:"favicon",extensions:["ico"]},openGraph:{filename:"opengraph-image",extensions:["jpg","jpeg","png","gif"]},twitter:{filename:"twitter-image",extensions:["jpg","jpeg","png","gif"]}},l=["js","jsx","ts","tsx"],n=e=>`(?:${e.join("|")})`;function i(e,t,s){let l=[RegExp(`^[\\\\/]robots${s?`\\.${n(t.concat("txt"))}$`:""}`),RegExp(`^[\\\\/]manifest${s?`\\.${n(t.concat("webmanifest","json"))}$`:""}`),RegExp("^[\\\\/]favicon\\.ico$"),RegExp(`[\\\\/]sitemap${s?`\\.${n(t.concat("xml"))}$`:""}`),RegExp(`[\\\\/]${a.icon.filename}\\d?${s?`\\.${n(t.concat(a.icon.extensions))}$`:""}`),RegExp(`[\\\\/]${a.apple.filename}\\d?${s?`\\.${n(t.concat(a.apple.extensions))}$`:""}`),RegExp(`[\\\\/]${a.openGraph.filename}\\d?${s?`\\.${n(t.concat(a.openGraph.extensions))}$`:""}`),RegExp(`[\\\\/]${a.twitter.filename}\\d?${s?`\\.${n(t.concat(a.twitter.extensions))}$`:""}`)],i=(0,r.normalizePathSep)(e);return l.some(e=>e.test(i))}function o(e){return i(e,[],!0)}function c(e){return"/robots"===e||"/manifest"===e||o(e)}function d(e){let t=e.replace(/^\/?app\//,"").replace(/\/route$/,"");return"/"!==t[0]&&(t="/"+t),!t.endsWith("/page")&&i(t,l,!1)}},6975:(e,t,s)=>{"use strict";function r(e){return function(){let{cookie:t}=e;if(!t)return{};let{parse:r}=s(7255);return r(Array.isArray(t)?t.join("; "):t)}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getCookieParser",{enumerable:!0,get:function(){return r}})},594:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{INTERCEPTION_ROUTE_MARKERS:function(){return a},extractInterceptionRouteInformation:function(){return n},isInterceptionRouteAppPath:function(){return l}});let r=s(8168),a=["(..)(..)","(.)","(..)","(...)"];function l(e){return void 0!==e.split("/").find(e=>a.find(t=>e.startsWith(t)))}function n(e){let t,s,l;for(let r of e.split("/"))if(s=a.find(e=>r.startsWith(e))){[t,l]=e.split(s,2);break}if(!t||!s||!l)throw Error(`Invalid interception route: ${e}. Must be in the format /<intercepting route>/(..|...|..)(..)/<intercepted route>`);switch(t=(0,r.normalizeAppPath)(t),s){case"(.)":l="/"===t?`/${l}`:t+"/"+l;break;case"(..)":if("/"===t)throw Error(`Invalid interception route: ${e}. Cannot use (..) marker at the root level, use (.) instead.`);l=t.split("/").slice(0,-1).concat(l).join("/");break;case"(...)":l="/"+l;break;case"(..)(..)":let n=t.split("/");if(n.length<=2)throw Error(`Invalid interception route: ${e}. Cannot use (..)(..) marker at the root level or one level up.`);l=n.slice(0,-2).concat(l).join("/");break;default:throw Error("Invariant: unexpected marker")}return{interceptingRoute:t,interceptedRoute:l}}},7262:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{getUtils:function(){return p},interpolateDynamicPath:function(){return u},normalizeDynamicRouteParams:function(){return h},normalizeVercelUrl:function(){return m}});let r=s(7360),a=s(5014),l=s(3707),n=s(5679),i=s(3525),o=s(5257),c=s(7847),d=s(8168),x=s(1943);function m(e,t,s,a,l){if(a&&t&&l){let t=(0,r.parse)(e.url,!0);for(let e of(delete t.search,Object.keys(t.query))){let r=e!==x.NEXT_QUERY_PARAM_PREFIX&&e.startsWith(x.NEXT_QUERY_PARAM_PREFIX),a=e!==x.NEXT_INTERCEPTION_MARKER_PREFIX&&e.startsWith(x.NEXT_INTERCEPTION_MARKER_PREFIX);(r||a||(s||Object.keys(l.groups)).includes(e))&&delete t.query[e]}e.url=(0,r.format)(t)}}function u(e,t,s){if(!s)return e;for(let r of Object.keys(s.groups)){let{optional:a,repeat:l}=s.groups[r],n=`[${l?"...":""}${r}]`;a&&(n=`[${n}]`);let i=e.indexOf(n);if(i>-1){let s;let a=t[r];s=Array.isArray(a)?a.map(e=>e&&encodeURIComponent(e)).join("/"):a?encodeURIComponent(a):"",e=e.slice(0,i)+s+e.slice(i+n.length)}}return e}function h(e,t,s,r){let a=!0;return s?{params:e=Object.keys(s.groups).reduce((l,n)=>{let i=e[n];"string"==typeof i&&(i=(0,d.normalizeRscURL)(i)),Array.isArray(i)&&(i=i.map(e=>("string"==typeof e&&(e=(0,d.normalizeRscURL)(e)),e)));let o=r[n],c=s.groups[n].optional;return((Array.isArray(o)?o.some(e=>Array.isArray(i)?i.some(t=>t.includes(e)):null==i?void 0:i.includes(e)):null==i?void 0:i.includes(o))||void 0===i&&!(c&&t))&&(a=!1),c&&(!i||Array.isArray(i)&&1===i.length&&("index"===i[0]||i[0]===`[[...${n}]]`))&&(i=void 0,delete e[n]),i&&"string"==typeof i&&s.groups[n].repeat&&(i=i.split("/")),i&&(l[n]=i),l},{}),hasValidParams:a}:{params:e,hasValidParams:!1}}function p({page:e,i18n:t,basePath:s,rewrites:r,pageIsDynamic:d,trailingSlash:p,caseSensitive:g}){let y,f,b;return d&&(y=(0,n.getNamedRouteRegex)(e,!1),b=(f=(0,i.getRouteMatcher)(y))(e)),{handleRewrites:function(n,i){let x={},m=i.pathname,u=r=>{let c=(0,l.getPathMatch)(r.source+(p?"(/)?":""),{removeUnnamedParams:!0,strict:!0,sensitive:!!g})(i.pathname);if((r.has||r.missing)&&c){let e=(0,o.matchHas)(n,i.query,r.has,r.missing);e?Object.assign(c,e):c=!1}if(c){let{parsedDestination:l,destQuery:n}=(0,o.prepareDestination)({appendParamsToQuery:!0,destination:r.destination,params:c,query:i.query});if(l.protocol)return!0;if(Object.assign(x,n,c),Object.assign(i.query,l.query),delete l.query,Object.assign(i,l),m=i.pathname,s&&(m=m.replace(RegExp(`^${s}`),"")||"/"),t){let e=(0,a.normalizeLocalePath)(m,t.locales);m=e.pathname,i.query.nextInternalLocale=e.detectedLocale||c.nextInternalLocale}if(m===e)return!0;if(d&&f){let e=f(m);if(e)return i.query={...i.query,...e},!0}}return!1};for(let e of r.beforeFiles||[])u(e);if(m!==e){let t=!1;for(let e of r.afterFiles||[])if(t=u(e))break;if(!t&&!(()=>{let t=(0,c.removeTrailingSlash)(m||"");return t===(0,c.removeTrailingSlash)(e)||(null==f?void 0:f(t))})()){for(let e of r.fallback||[])if(t=u(e))break}}return x},defaultRouteRegex:y,dynamicRouteMatcher:f,defaultRouteMatches:b,getParamsFromRouteMatches:function(e,s,r){return(0,i.getRouteMatcher)(function(){let{groups:e,routeKeys:a}=y;return{re:{exec:l=>{let n=Object.fromEntries(new URLSearchParams(l)),i=t&&r&&n["1"]===r;for(let e of Object.keys(n)){let t=n[e];e!==x.NEXT_QUERY_PARAM_PREFIX&&e.startsWith(x.NEXT_QUERY_PARAM_PREFIX)&&(n[e.substring(x.NEXT_QUERY_PARAM_PREFIX.length)]=t,delete n[e])}let o=Object.keys(a||{}),c=e=>{if(t){let a=Array.isArray(e),l=a?e[0]:e;if("string"==typeof l&&t.locales.some(e=>e.toLowerCase()===l.toLowerCase()&&(r=e,s.locale=r,!0)))return a&&e.splice(0,1),!a||0===e.length}return!1};return o.every(e=>n[e])?o.reduce((t,s)=>{let r=null==a?void 0:a[s];return r&&!c(n[s])&&(t[e[r].pos]=n[s]),t},{}):Object.keys(n).reduce((e,t)=>{if(!c(n[t])){let s=t;return i&&(s=parseInt(t,10)-1+""),Object.assign(e,{[s]:n[t]})}return e},{})}},groups:e}}())(e.headers["x-now-route-matches"])},normalizeDynamicRouteParams:(e,t)=>h(e,t,y,b),normalizeVercelUrl:(e,t,s)=>m(e,t,s,d,y),interpolateDynamicPath:(e,t)=>u(e,t,y)}}},4080:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"escapeStringRegexp",{enumerable:!0,get:function(){return a}});let s=/[|\\{}()[\]^$+*?.-]/,r=/[|\\{}()[\]^$+*?.-]/g;function a(e){return s.test(e)?e.replace(r,"\\$&"):e}},8785:(e,t)=>{"use strict";function s(e){let t=5381;for(let s=0;s<e.length;s++)t=(t<<5)+t+e.charCodeAt(s)&4294967295;return t>>>0}function r(e){return s(e).toString(36).slice(0,5)}Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{djb2Hash:function(){return s},hexHash:function(){return r}})},5014:(e,t)=>{"use strict";function s(e,t){let s;let r=e.split("/");return(t||[]).some(t=>!!r[1]&&r[1].toLowerCase()===t.toLowerCase()&&(s=t,r.splice(1,1),e=r.join("/")||"/",!0)),{pathname:e,detectedLocale:s}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"normalizeLocalePath",{enumerable:!0,get:function(){return s}})},1293:(e,t,s)=>{"use strict";let r;r=s(5315),e.exports=r},1555:(e,t)=>{"use strict";function s(e){return e.startsWith("/")?e:"/"+e}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ensureLeadingSlash",{enumerable:!0,get:function(){return s}})},1040:(e,t)=>{"use strict";function s(e){return e.replace(/\\/g,"/")}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"normalizePathSep",{enumerable:!0,get:function(){return s}})},8168:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{normalizeAppPath:function(){return l},normalizeRscURL:function(){return n}});let r=s(1555),a=s(5406);function l(e){return(0,r.ensureLeadingSlash)(e.split("/").reduce((e,t,s,r)=>!t||(0,a.isGroupSegment)(t)||"@"===t[0]||("page"===t||"route"===t)&&s===r.length-1?e:e+"/"+t,""))}function n(e){return e.replace(/\.rsc($|\?)/,"$1")}},1942:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"parseRelativeUrl",{enumerable:!0,get:function(){return a}}),s(2569);let r=s(4869);function a(e,t){let s=new URL("http://n"),a=t?new URL(t,s):e.startsWith(".")?new URL("http://n"):s,{pathname:l,searchParams:n,search:i,hash:o,href:c,origin:d}=new URL(e,a);if(d!==s.origin)throw Error("invariant: invalid relative URL, router received "+e);return{pathname:l,query:(0,r.searchParamsToUrlQuery)(n),search:i,hash:o,href:c.slice(s.origin.length)}}},3226:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"parseUrl",{enumerable:!0,get:function(){return l}});let r=s(4869),a=s(1942);function l(e){if(e.startsWith("/"))return(0,a.parseRelativeUrl)(e);let t=new URL(e);return{hash:t.hash,hostname:t.hostname,href:t.href,pathname:t.pathname,port:t.port,protocol:t.protocol,query:(0,r.searchParamsToUrlQuery)(t.searchParams),search:t.search}}},3707:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getPathMatch",{enumerable:!0,get:function(){return a}});let r=s(1792);function a(e,t){let s=[],a=(0,r.pathToRegexp)(e,s,{delimiter:"/",sensitive:"boolean"==typeof(null==t?void 0:t.sensitive)&&t.sensitive,strict:null==t?void 0:t.strict}),l=(0,r.regexpToFunction)((null==t?void 0:t.regexModifier)?new RegExp(t.regexModifier(a.source),a.flags):a,s);return(e,r)=>{if("string"!=typeof e)return!1;let a=l(e);if(!a)return!1;if(null==t?void 0:t.removeUnnamedParams)for(let e of s)"number"==typeof e.name&&delete a.params[e.name];return{...r,...a.params}}}},5257:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{compileNonPath:function(){return x},matchHas:function(){return d},prepareDestination:function(){return m}});let r=s(1792),a=s(4080),l=s(3226),n=s(594),i=s(338),o=s(6975);function c(e){return e.replace(/__ESC_COLON_/gi,":")}function d(e,t,s,r){void 0===s&&(s=[]),void 0===r&&(r=[]);let a={},l=s=>{let r;let l=s.key;switch(s.type){case"header":l=l.toLowerCase(),r=e.headers[l];break;case"cookie":r="cookies"in e?e.cookies[s.key]:(0,o.getCookieParser)(e.headers)()[s.key];break;case"query":r=t[l];break;case"host":{let{host:t}=(null==e?void 0:e.headers)||{};r=null==t?void 0:t.split(":",1)[0].toLowerCase()}}if(!s.value&&r)return a[function(e){let t="";for(let s=0;s<e.length;s++){let r=e.charCodeAt(s);(r>64&&r<91||r>96&&r<123)&&(t+=e[s])}return t}(l)]=r,!0;if(r){let e=RegExp("^"+s.value+"$"),t=Array.isArray(r)?r.slice(-1)[0].match(e):r.match(e);if(t)return Array.isArray(t)&&(t.groups?Object.keys(t.groups).forEach(e=>{a[e]=t.groups[e]}):"host"===s.type&&t[0]&&(a.host=t[0])),!0}return!1};return!!s.every(e=>l(e))&&!r.some(e=>l(e))&&a}function x(e,t){if(!e.includes(":"))return e;for(let s of Object.keys(t))e.includes(":"+s)&&(e=e.replace(RegExp(":"+s+"\\*","g"),":"+s+"--ESCAPED_PARAM_ASTERISKS").replace(RegExp(":"+s+"\\?","g"),":"+s+"--ESCAPED_PARAM_QUESTION").replace(RegExp(":"+s+"\\+","g"),":"+s+"--ESCAPED_PARAM_PLUS").replace(RegExp(":"+s+"(?!\\w)","g"),"--ESCAPED_PARAM_COLON"+s));return e=e.replace(/(:|\*|\?|\+|\(|\)|\{|\})/g,"\\$1").replace(/--ESCAPED_PARAM_PLUS/g,"+").replace(/--ESCAPED_PARAM_COLON/g,":").replace(/--ESCAPED_PARAM_QUESTION/g,"?").replace(/--ESCAPED_PARAM_ASTERISKS/g,"*"),(0,r.compile)("/"+e,{validate:!1})(t).slice(1)}function m(e){let t;let s=Object.assign({},e.query);delete s.__nextLocale,delete s.__nextDefaultLocale,delete s.__nextDataReq,delete s.__nextInferredLocaleFromDefault,delete s[i.NEXT_RSC_UNION_QUERY];let o=e.destination;for(let t of Object.keys({...e.params,...s}))o=o.replace(RegExp(":"+(0,a.escapeStringRegexp)(t),"g"),"__ESC_COLON_"+t);let d=(0,l.parseUrl)(o),m=d.query,u=c(""+d.pathname+(d.hash||"")),h=c(d.hostname||""),p=[],g=[];(0,r.pathToRegexp)(u,p),(0,r.pathToRegexp)(h,g);let y=[];p.forEach(e=>y.push(e.name)),g.forEach(e=>y.push(e.name));let f=(0,r.compile)(u,{validate:!1}),b=(0,r.compile)(h,{validate:!1});for(let[t,s]of Object.entries(m))Array.isArray(s)?m[t]=s.map(t=>x(c(t),e.params)):"string"==typeof s&&(m[t]=x(c(s),e.params));let j=Object.keys(e.params).filter(e=>"nextInternalLocale"!==e);if(e.appendParamsToQuery&&!j.some(e=>y.includes(e)))for(let t of j)t in m||(m[t]=e.params[t]);if((0,n.isInterceptionRouteAppPath)(u))for(let t of u.split("/")){let s=n.INTERCEPTION_ROUTE_MARKERS.find(e=>t.startsWith(e));if(s){e.params["0"]=s;break}}try{let[s,r]=(t=f(e.params)).split("#",2);d.hostname=b(e.params),d.pathname=s,d.hash=(r?"#":"")+(r||""),delete d.search}catch(e){if(e.message.match(/Expected .*? to not repeat, but got an array/))throw Error("To use a multi-match in the destination you must add `*` at the end of the param name to signify it should repeat. https://nextjs.org/docs/messages/invalid-multi-match");throw e}return d.query={...s,...d.query},{newUrl:t,destQuery:m,parsedDestination:d}}},4869:(e,t)=>{"use strict";function s(e){let t={};return e.forEach((e,s)=>{void 0===t[s]?t[s]=e:Array.isArray(t[s])?t[s].push(e):t[s]=[t[s],e]}),t}function r(e){return"string"!=typeof e&&("number"!=typeof e||isNaN(e))&&"boolean"!=typeof e?"":String(e)}function a(e){let t=new URLSearchParams;return Object.entries(e).forEach(e=>{let[s,a]=e;Array.isArray(a)?a.forEach(e=>t.append(s,r(e))):t.set(s,r(a))}),t}function l(e){for(var t=arguments.length,s=Array(t>1?t-1:0),r=1;r<t;r++)s[r-1]=arguments[r];return s.forEach(t=>{Array.from(t.keys()).forEach(t=>e.delete(t)),t.forEach((t,s)=>e.append(s,t))}),e}Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{assign:function(){return l},searchParamsToUrlQuery:function(){return s},urlQueryToSearchParams:function(){return a}})},7847:(e,t)=>{"use strict";function s(e){return e.replace(/\/$/,"")||"/"}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"removeTrailingSlash",{enumerable:!0,get:function(){return s}})},3525:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getRouteMatcher",{enumerable:!0,get:function(){return a}});let r=s(2569);function a(e){let{re:t,groups:s}=e;return e=>{let a=t.exec(e);if(!a)return!1;let l=e=>{try{return decodeURIComponent(e)}catch(e){throw new r.DecodeError("failed to decode param")}},n={};return Object.keys(s).forEach(e=>{let t=s[e],r=a[t.pos];void 0!==r&&(n[e]=~r.indexOf("/")?r.split("/").map(e=>l(e)):t.repeat?[l(r)]:l(r))}),n}}},5679:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{getNamedMiddlewareRegex:function(){return u},getNamedRouteRegex:function(){return m},getRouteRegex:function(){return c},parseParameter:function(){return i}});let r=s(1943),a=s(594),l=s(4080),n=s(7847);function i(e){let t=e.startsWith("[")&&e.endsWith("]");t&&(e=e.slice(1,-1));let s=e.startsWith("...");return s&&(e=e.slice(3)),{key:e,repeat:s,optional:t}}function o(e){let t=(0,n.removeTrailingSlash)(e).slice(1).split("/"),s={},r=1;return{parameterizedRoute:t.map(e=>{let t=a.INTERCEPTION_ROUTE_MARKERS.find(t=>e.startsWith(t)),n=e.match(/\[((?:\[.*\])|.+)\]/);if(t&&n){let{key:e,optional:a,repeat:o}=i(n[1]);return s[e]={pos:r++,repeat:o,optional:a},"/"+(0,l.escapeStringRegexp)(t)+"([^/]+?)"}if(!n)return"/"+(0,l.escapeStringRegexp)(e);{let{key:e,repeat:t,optional:a}=i(n[1]);return s[e]={pos:r++,repeat:t,optional:a},t?a?"(?:/(.+?))?":"/(.+?)":"/([^/]+?)"}}).join(""),groups:s}}function c(e){let{parameterizedRoute:t,groups:s}=o(e);return{re:RegExp("^"+t+"(?:/)?$"),groups:s}}function d(e){let{interceptionMarker:t,getSafeRouteKey:s,segment:r,routeKeys:a,keyPrefix:n}=e,{key:o,optional:c,repeat:d}=i(r),x=o.replace(/\W/g,"");n&&(x=""+n+x);let m=!1;(0===x.length||x.length>30)&&(m=!0),isNaN(parseInt(x.slice(0,1)))||(m=!0),m&&(x=s()),n?a[x]=""+n+o:a[x]=o;let u=t?(0,l.escapeStringRegexp)(t):"";return d?c?"(?:/"+u+"(?<"+x+">.+?))?":"/"+u+"(?<"+x+">.+?)":"/"+u+"(?<"+x+">[^/]+?)"}function x(e,t){let s;let i=(0,n.removeTrailingSlash)(e).slice(1).split("/"),o=(s=0,()=>{let e="",t=++s;for(;t>0;)e+=String.fromCharCode(97+(t-1)%26),t=Math.floor((t-1)/26);return e}),c={};return{namedParameterizedRoute:i.map(e=>{let s=a.INTERCEPTION_ROUTE_MARKERS.some(t=>e.startsWith(t)),n=e.match(/\[((?:\[.*\])|.+)\]/);if(s&&n){let[s]=e.split(n[0]);return d({getSafeRouteKey:o,interceptionMarker:s,segment:n[1],routeKeys:c,keyPrefix:t?r.NEXT_INTERCEPTION_MARKER_PREFIX:void 0})}return n?d({getSafeRouteKey:o,segment:n[1],routeKeys:c,keyPrefix:t?r.NEXT_QUERY_PARAM_PREFIX:void 0}):"/"+(0,l.escapeStringRegexp)(e)}).join(""),routeKeys:c}}function m(e,t){let s=x(e,t);return{...c(e),namedRegex:"^"+s.namedParameterizedRoute+"(?:/)?$",routeKeys:s.routeKeys}}function u(e,t){let{parameterizedRoute:s}=o(e),{catchAll:r=!0}=t;if("/"===s)return{namedRegex:"^/"+(r?".*":"")+"$"};let{namedParameterizedRoute:a}=x(e,!1);return{namedRegex:"^"+a+(r?"(?:(/.*)?)":"")+"$"}}},5406:(e,t)=>{"use strict";function s(e){return"("===e[0]&&e.endsWith(")")}Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{DEFAULT_SEGMENT_KEY:function(){return a},PAGE_SEGMENT_KEY:function(){return r},isGroupSegment:function(){return s}});let r="__PAGE__",a="__DEFAULT__"},2569:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{DecodeError:function(){return h},MiddlewareNotFoundError:function(){return f},MissingStaticPage:function(){return y},NormalizeError:function(){return p},PageNotFoundError:function(){return g},SP:function(){return m},ST:function(){return u},WEB_VITALS:function(){return s},execOnce:function(){return r},getDisplayName:function(){return o},getLocationOrigin:function(){return n},getURL:function(){return i},isAbsoluteUrl:function(){return l},isResSent:function(){return c},loadGetInitialProps:function(){return x},normalizeRepeatedSlashes:function(){return d},stringifyError:function(){return b}});let s=["CLS","FCP","FID","INP","LCP","TTFB"];function r(e){let t,s=!1;return function(){for(var r=arguments.length,a=Array(r),l=0;l<r;l++)a[l]=arguments[l];return s||(s=!0,t=e(...a)),t}}let a=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,l=e=>a.test(e);function n(){let{protocol:e,hostname:t,port:s}=window.location;return e+"//"+t+(s?":"+s:"")}function i(){let{href:e}=window.location,t=n();return e.substring(t.length)}function o(e){return"string"==typeof e?e:e.displayName||e.name||"Unknown"}function c(e){return e.finished||e.headersSent}function d(e){let t=e.split("?");return t[0].replace(/\\/g,"/").replace(/\/\/+/g,"/")+(t[1]?"?"+t.slice(1).join("?"):"")}async function x(e,t){let s=t.res||t.ctx&&t.ctx.res;if(!e.getInitialProps)return t.ctx&&t.Component?{pageProps:await x(t.Component,t.ctx)}:{};let r=await e.getInitialProps(t);if(s&&c(s))return r;if(!r)throw Error('"'+o(e)+'.getInitialProps()" should resolve to an object. But found "'+r+'" instead.');return r}let m="undefined"!=typeof performance,u=m&&["mark","measure","getEntriesByName"].every(e=>"function"==typeof performance[e]);class h extends Error{}class p extends Error{}class g extends Error{constructor(e){super(),this.code="ENOENT",this.name="PageNotFoundError",this.message="Cannot find module for page: "+e}}class y extends Error{constructor(e,t){super(),this.message="Failed to load static file for page: "+e+" "+t}}class f extends Error{constructor(){super(),this.code="ENOENT",this.message="Cannot find the middleware module"}}function b(e){return JSON.stringify({message:e.message,stack:e.stack})}},7481:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var r=s(6621);let a=e=>[{type:"image/x-icon",sizes:"960x960",url:(0,r.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]}};var t=require("../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[948,507,850],()=>s(3353));module.exports=r})();