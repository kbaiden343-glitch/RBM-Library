exports.id=850,exports.ids=[850],exports.modules={5812:(e,r,t)=>{Promise.resolve().then(t.bind(t,3819)),Promise.resolve().then(t.bind(t,8896)),Promise.resolve().then(t.bind(t,2807)),Promise.resolve().then(t.bind(t,381))},8781:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,2994,23)),Promise.resolve().then(t.t.bind(t,6114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,9671,23)),Promise.resolve().then(t.t.bind(t,1868,23)),Promise.resolve().then(t.t.bind(t,4759,23))},3819:(e,r,t)=>{"use strict";t.d(r,{AuthProvider:()=>y,a:()=>p});var a=t(326),o=t(7577),s=t(381),n=t(6324);let i=(0,o.createContext)(null),l={user:null,isAuthenticated:!1,loading:!1,error:null},d=(e,r)=>{switch(r.type){case"LOGIN_START":return{...e,loading:!0,error:null};case"LOGIN_SUCCESS":return{...e,user:r.payload,isAuthenticated:!0,loading:!1,error:null};case"LOGIN_FAILURE":return{...e,user:null,isAuthenticated:!1,loading:!1,error:r.payload};case"LOGOUT":return{...e,user:null,isAuthenticated:!1,loading:!1,error:null};case"CLEAR_ERROR":return{...e,error:null};case"SET_LOADING":return{...e,loading:r.payload};default:return e}},c=e=>{switch(e){case"ADMIN":return["all"];case"LIBRARIAN":return["books:read","books:create","books:update","books:delete","members:read","members:create","members:update","members:delete","borrowing:read","borrowing:create","borrowing:update","reservations:read","reservations:create","reservations:update","attendance:read","attendance:create","manage_attendance","reports:read","dashboard:read","settings:read"];case"MEMBER":return["books:read","borrowing:read","reservations:read","reservations:create","attendance:create"];default:return[]}},y=({children:e})=>{let[r,t]=(0,o.useReducer)(d,l);(0,o.useEffect)(()=>{let e=localStorage.getItem("library_user"),r=localStorage.getItem("token");if(e&&r)try{let r=JSON.parse(e);r.id&&r.email&&r.role?t({type:"LOGIN_SUCCESS",payload:r}):(localStorage.removeItem("library_user"),localStorage.removeItem("token"))}catch(e){console.error("Error parsing saved user:",e),localStorage.removeItem("library_user"),localStorage.removeItem("token")}},[]);let y=async(e,r)=>{t({type:"LOGIN_START"});try{let a=await n.Z.post("/api/auth/login",{email:e,password:r});if(a.error)t({type:"LOGIN_FAILURE",payload:a.error}),s.ZP.error(a.error);else if(a.data){let e={...a.data.user,permissions:c(a.data.user.role)};t({type:"LOGIN_SUCCESS",payload:e}),localStorage.setItem("library_user",JSON.stringify(e)),localStorage.setItem("token",a.data.token),s.ZP.success(`Welcome back, ${e.name}!`)}}catch(e){t({type:"LOGIN_FAILURE",payload:"Login failed. Please try again."}),s.ZP.error("Login failed. Please try again.")}},p=async(e,r,a,o="MEMBER")=>{t({type:"LOGIN_START"});try{let i=await n.Z.post("/api/auth/register",{name:e,email:r,password:a,role:o});if(i.error)t({type:"LOGIN_FAILURE",payload:i.error}),s.ZP.error(i.error);else if(i.data){let e={...i.data.user,permissions:c(i.data.user.role)};t({type:"LOGIN_SUCCESS",payload:e}),localStorage.setItem("library_user",JSON.stringify(e)),localStorage.setItem("token",i.data.token),s.ZP.success(`Welcome, ${e.name}!`)}}catch(e){t({type:"LOGIN_FAILURE",payload:"Registration failed. Please try again."}),s.ZP.error("Registration failed. Please try again.")}};return a.jsx(i.Provider,{value:{state:r,login:y,register:p,logout:()=>{t({type:"LOGOUT"}),localStorage.removeItem("library_user"),localStorage.removeItem("token"),s.ZP.success("Logged out successfully")},clearError:()=>{t({type:"CLEAR_ERROR"})},hasPermission:e=>!!r.user&&(!!r.user.permissions.includes("all")||r.user.permissions.includes(e))},children:e})},p=()=>{let e=(0,o.useContext)(i);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},8896:(e,r,t)=>{"use strict";t.d(r,{LibraryProvider:()=>c,y:()=>y});var a=t(326),o=t(7577),s=t(381);let n=(0,o.createContext)(null),i={books:[],members:[],borrowings:[],reservations:[],attendance:[],currentUser:null,loading:!1,error:null},l=(e,r)=>{switch(r.type){case"SET_LOADING":return{...e,loading:r.payload};case"SET_ERROR":return{...e,error:r.payload};case"SET_BOOKS":return{...e,books:r.payload};case"ADD_BOOK":return{...e,books:[...e.books,r.payload]};case"UPDATE_BOOK":return{...e,books:e.books.map(e=>e.id===r.payload.id?r.payload:e)};case"DELETE_BOOK":return{...e,books:e.books.filter(e=>e.id!==r.payload)};case"SET_MEMBERS":return{...e,members:r.payload};case"ADD_MEMBER":return{...e,members:[...e.members,r.payload]};case"UPDATE_MEMBER":return{...e,members:e.members.map(e=>e.id===r.payload.id?r.payload:e)};case"DELETE_MEMBER":return{...e,members:e.members.filter(e=>e.id!==r.payload)};case"SET_BORROWINGS":return{...e,borrowings:r.payload};case"ADD_BORROWING":return{...e,borrowings:[...e.borrowings,r.payload]};case"RETURN_BOOK":return{...e,borrowings:e.borrowings.map(e=>e.id===r.payload.id?r.payload:e)};case"SET_RESERVATIONS":return{...e,reservations:r.payload};case"ADD_RESERVATION":return{...e,reservations:[...e.reservations,r.payload]};case"SET_ATTENDANCE":return{...e,attendance:r.payload};case"ADD_ATTENDANCE":return{...e,attendance:[...e.attendance,r.payload]};case"SET_CURRENT_USER":return{...e,currentUser:r.payload};default:return e}},d=async(e,r={})=>{let t=localStorage.getItem("token"),a=await fetch(e,{...r,headers:{"Content-Type":"application/json",...t&&{Authorization:`Bearer ${t}`},...r.headers}});if(!a.ok){let e=await a.json();throw console.error("API Error:",e),Error(e.error||"API call failed")}return a.json()},c=({children:e})=>{let[r,t]=(0,o.useReducer)(l,i),c=async()=>{try{t({type:"SET_LOADING",payload:!0});let e=await d("/api/books");t({type:"SET_BOOKS",payload:e.books||e})}catch(e){console.error("Error fetching books:",e),t({type:"SET_ERROR",payload:"Failed to fetch books"}),s.ZP.error("Failed to fetch books")}finally{t({type:"SET_LOADING",payload:!1})}},y=async()=>{try{t({type:"SET_LOADING",payload:!0});let e=await d("/api/persons?limit=100"),r=e.persons?.map(e=>({id:e.id,name:e.name,email:e.email,phone:e.phone||"",address:e.address||"",membershipDate:e.membershipDate||e.createdAt,status:"ACTIVE"===e.status?"ACTIVE":"INACTIVE",personType:e.personType,createdAt:e.createdAt,updatedAt:e.updatedAt}))||[];t({type:"SET_MEMBERS",payload:r})}catch(e){console.error("Error fetching members:",e),t({type:"SET_ERROR",payload:"Failed to fetch members"}),s.ZP.error("Failed to fetch members")}finally{t({type:"SET_LOADING",payload:!1})}},p=async()=>{try{t({type:"SET_LOADING",payload:!0});let e=await d("/api/borrowings");t({type:"SET_BORROWINGS",payload:e.borrowings||e})}catch(e){console.error("Error fetching borrowings:",e),t({type:"SET_ERROR",payload:"Failed to fetch borrowings"}),s.ZP.error("Failed to fetch borrowings")}finally{t({type:"SET_LOADING",payload:!1})}},u=async()=>{try{t({type:"SET_LOADING",payload:!0});let e=await d("/api/reservations");t({type:"SET_RESERVATIONS",payload:e.reservations||e})}catch(e){console.error("Error fetching reservations:",e),t({type:"SET_ERROR",payload:"Failed to fetch reservations"}),s.ZP.error("Failed to fetch reservations")}finally{t({type:"SET_LOADING",payload:!1})}},m=async()=>{try{t({type:"SET_LOADING",payload:!0});let e=await d("/api/attendance");t({type:"SET_ATTENDANCE",payload:e.attendance||e})}catch(e){console.error("Error fetching attendance:",e),t({type:"SET_ERROR",payload:"Failed to fetch attendance"}),s.ZP.error("Failed to fetch attendance")}finally{t({type:"SET_LOADING",payload:!1})}};return a.jsx(n.Provider,{value:{state:r,dispatch:t,addBook:async e=>{try{t({type:"SET_LOADING",payload:!0}),console.log("Adding book with data:",e);let r=await d("/api/books",{method:"POST",body:JSON.stringify(e)});t({type:"ADD_BOOK",payload:r}),s.ZP.success("Book added successfully!")}catch(e){if(console.error("Error adding book:",e),!e.message?.includes("already exists")&&!e.message?.includes("already exists")){let r=e.message||"Failed to add book";s.ZP.error(r)}throw e}finally{t({type:"SET_LOADING",payload:!1})}},updateBook:async e=>{try{t({type:"SET_LOADING",payload:!0});let r=await d(`/api/books/${e.id}`,{method:"PUT",body:JSON.stringify(e)});t({type:"UPDATE_BOOK",payload:r}),s.ZP.success("Book updated successfully!")}catch(e){console.error("Error updating book:",e),s.ZP.error("Failed to update book")}finally{t({type:"SET_LOADING",payload:!1})}},deleteBook:async e=>{try{t({type:"SET_LOADING",payload:!0}),await d(`/api/books/${e}`,{method:"DELETE"}),t({type:"DELETE_BOOK",payload:e}),s.ZP.success("Book deleted successfully!")}catch(e){console.error("Error deleting book:",e),s.ZP.error("Failed to delete book")}finally{t({type:"SET_LOADING",payload:!1})}},addMember:async e=>{try{t({type:"SET_LOADING",payload:!0});let r={name:e.name,email:e.email,phone:e.phone,address:e.address,personType:e.personType||"MEMBER",status:e.status||"ACTIVE"},a=await d("/api/persons",{method:"POST",body:JSON.stringify(r)});t({type:"ADD_MEMBER",payload:a}),s.ZP.success("Member added successfully!")}catch(e){throw console.error("Error adding member:",e),e.message?.includes("already exists")||e.message?.includes("already exists")||s.ZP.error("Failed to add member"),e}finally{t({type:"SET_LOADING",payload:!1})}},updateMember:async e=>{try{t({type:"SET_LOADING",payload:!0});let r={name:e.name,email:e.email,phone:e.phone,address:e.address,personType:e.personType,status:e.status,notes:e.notes,emergencyContact:e.emergencyContact},a=await d(`/api/persons/${e.id}`,{method:"PUT",body:JSON.stringify(r)});t({type:"UPDATE_MEMBER",payload:a}),s.ZP.success("Member updated successfully!")}catch(e){console.error("Error updating member:",e),s.ZP.error("Failed to update member")}finally{t({type:"SET_LOADING",payload:!1})}},deleteMember:async e=>{try{t({type:"SET_LOADING",payload:!0}),await d(`/api/persons/${e}`,{method:"DELETE"}),t({type:"DELETE_MEMBER",payload:e}),s.ZP.success("Member deleted successfully!")}catch(e){console.error("Error deleting member:",e),s.ZP.error("Failed to delete member")}finally{t({type:"SET_LOADING",payload:!1})}},borrowBook:async e=>{try{t({type:"SET_LOADING",payload:!0});let r=await d("/api/borrowings",{method:"POST",body:JSON.stringify(e)});t({type:"ADD_BORROWING",payload:r}),s.ZP.success("Book borrowed successfully!")}catch(e){throw console.error("Error borrowing book:",e),e.message?.includes("already")||e.message?.includes("not found")||s.ZP.error("Failed to borrow book"),e}finally{t({type:"SET_LOADING",payload:!1})}},returnBook:async e=>{try{t({type:"SET_LOADING",payload:!0});let r=await d(`/api/borrowings/${e}`,{method:"PUT",body:JSON.stringify({action:"return"})});t({type:"RETURN_BOOK",payload:r}),s.ZP.success("Book returned successfully!")}catch(e){console.error("Error returning book:",e),s.ZP.error("Failed to return book")}finally{t({type:"SET_LOADING",payload:!1})}},addReservation:async e=>{try{t({type:"SET_LOADING",payload:!0});let r=await d("/api/reservations",{method:"POST",body:JSON.stringify(e)});t({type:"ADD_RESERVATION",payload:r}),s.ZP.success("Book reserved successfully!")}catch(e){throw console.error("Error adding reservation:",e),e.message?.includes("already")||e.message?.includes("not found")||s.ZP.error("Failed to reserve book"),e}finally{t({type:"SET_LOADING",payload:!1})}},addAttendance:async e=>{try{t({type:"SET_LOADING",payload:!0});let r={action:"check-in",personId:e.personId,visitorName:e.visitorName,visitorEmail:e.visitorEmail,visitorPhone:e.visitorPhone},a=await d("/api/attendance",{method:"POST",body:JSON.stringify(r)});t({type:"ADD_ATTENDANCE",payload:a}),s.ZP.success("Attendance recorded successfully!")}catch(e){throw console.error("Error adding attendance:",e),e.message?.includes("already")||e.message?.includes("already checked in")||s.ZP.error("Failed to record attendance"),e}finally{t({type:"SET_LOADING",payload:!1})}},getRecommendations:e=>{let t=r.borrowings.filter(r=>r.personId===e).map(e=>r.books.find(r=>r.id===e.bookId)).filter(Boolean),a=t.map(e=>e.category),o=a.sort((e,r)=>a.filter(r=>r===e).length-a.filter(e=>e===r).length).pop();return r.books.filter(e=>e.category===o&&!t.some(r=>r.id===e.id)&&"AVAILABLE"===e.status).slice(0,3)},fetchBooks:c,fetchMembers:y,fetchBorrowings:p,fetchReservations:u,fetchAttendance:m},children:e})},y=()=>{let e=(0,o.useContext)(n);if(!e)throw Error("useLibrary must be used within a LibraryProvider");return e}},2807:(e,r,t)=>{"use strict";t.d(r,{NotificationProvider:()=>d,z:()=>c});var a=t(326),o=t(7577),s=t(381);let n=(0,o.createContext)(null),i={notifications:[],unreadCount:0},l=(e,r)=>{switch(r.type){case"ADD_NOTIFICATION":let t={...r.payload,id:Date.now().toString(),timestamp:new Date,read:!1};return{...e,notifications:[t,...e.notifications],unreadCount:e.unreadCount+1};case"MARK_AS_READ":return{...e,notifications:e.notifications.map(e=>e.id===r.payload?{...e,read:!0}:e),unreadCount:Math.max(0,e.unreadCount-1)};case"MARK_ALL_AS_READ":return{...e,notifications:e.notifications.map(e=>({...e,read:!0})),unreadCount:0};case"REMOVE_NOTIFICATION":let a=e.notifications.find(e=>e.id===r.payload);return{...e,notifications:e.notifications.filter(e=>e.id!==r.payload),unreadCount:a&&!a.read?Math.max(0,e.unreadCount-1):e.unreadCount};case"CLEAR_ALL_NOTIFICATIONS":return{...e,notifications:[],unreadCount:0};default:return e}},d=({children:e})=>{let[r,t]=(0,o.useReducer)(l,i);return(0,o.useEffect)(()=>{let e=localStorage.getItem("library_notifications");if(e)try{JSON.parse(e).forEach(e=>{t({type:"ADD_NOTIFICATION",payload:e})})}catch(e){localStorage.removeItem("library_notifications")}},[]),(0,o.useEffect)(()=>{localStorage.setItem("library_notifications",JSON.stringify(r.notifications))},[r.notifications]),a.jsx(n.Provider,{value:{state:r,addNotification:e=>{switch(t({type:"ADD_NOTIFICATION",payload:e}),e.type){case"success":s.ZP.success(e.message);break;case"error":s.ZP.error(e.message);break;case"warning":(0,s.ZP)(e.message,{icon:"⚠️"});break;default:(0,s.ZP)(e.message)}},markAsRead:e=>{t({type:"MARK_AS_READ",payload:e})},markAllAsRead:()=>{t({type:"MARK_ALL_AS_READ"})},removeNotification:e=>{t({type:"REMOVE_NOTIFICATION",payload:e})},clearAllNotifications:()=>{t({type:"CLEAR_ALL_NOTIFICATIONS"})}},children:e})},c=()=>{let e=(0,o.useContext)(n);if(!e)throw Error("useNotifications must be used within a NotificationProvider");return e}},6324:(e,r,t)=>{"use strict";t.d(r,{Z:()=>o});class a{constructor(){this.baseURL=""}async makeRequest(e,r={}){let t=localStorage.getItem("token"),a={...r,headers:{"Content-Type":"application/json",...t&&{Authorization:`Bearer ${t}`},...r.headers}};try{let r=await fetch(`${this.baseURL}${e}`,a);if(401===r.status)return this.handleUnauthorized(),{error:"Session expired. Please log in again.",status:401};let t=await r.json();if(!r.ok)return{error:t.error||`Request failed with status ${r.status}`,status:r.status};return{data:t,status:r.status}}catch(e){return console.error("API request failed:",e),{error:"Network error. Please check your connection.",status:0}}}handleUnauthorized(){localStorage.removeItem("token"),localStorage.removeItem("library_user")}async get(e){return this.makeRequest(e,{method:"GET"})}async post(e,r){return this.makeRequest(e,{method:"POST",body:r?JSON.stringify(r):void 0})}async put(e,r){return this.makeRequest(e,{method:"PUT",body:r?JSON.stringify(r):void 0})}async delete(e){return this.makeRequest(e,{method:"DELETE"})}isAuthenticated(){let e=localStorage.getItem("token"),r=localStorage.getItem("library_user");return!!(e&&r)}getCurrentUser(){try{let e=localStorage.getItem("library_user");return e?JSON.parse(e):null}catch{return null}}}let o=new a},7438:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>p,metadata:()=>y});var a=t(9510),o=t(7366),s=t.n(o);t(7272);var n=t(9125),i=t(8570);let l=(0,i.createProxy)(String.raw`C:\Users\USER\Desktop\Library Project\app\context\LibraryContext.tsx#LibraryProvider`);(0,i.createProxy)(String.raw`C:\Users\USER\Desktop\Library Project\app\context\LibraryContext.tsx#useLibrary`);let d=(0,i.createProxy)(String.raw`C:\Users\USER\Desktop\Library Project\app\context\AuthContext.tsx#AuthProvider`);(0,i.createProxy)(String.raw`C:\Users\USER\Desktop\Library Project\app\context\AuthContext.tsx#useAuth`);let c=(0,i.createProxy)(String.raw`C:\Users\USER\Desktop\Library Project\app\context\NotificationContext.tsx#NotificationProvider`);(0,i.createProxy)(String.raw`C:\Users\USER\Desktop\Library Project\app\context\NotificationContext.tsx#useNotifications`);let y={title:"Robert Aboagye Mensah Community Library",description:"Community Library Management System"};function p({children:e}){return a.jsx("html",{lang:"en",children:a.jsx("body",{className:s().className,children:a.jsx(d,{children:a.jsx(c,{children:(0,a.jsxs)(l,{children:[e,a.jsx(n.x7,{position:"top-right"})]})})})})})}},7272:()=>{}};