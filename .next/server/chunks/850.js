exports.id=850,exports.ids=[850],exports.modules={5812:(e,r,a)=>{Promise.resolve().then(a.bind(a,3819)),Promise.resolve().then(a.bind(a,8896)),Promise.resolve().then(a.bind(a,2807)),Promise.resolve().then(a.bind(a,381))},8781:(e,r,a)=>{Promise.resolve().then(a.t.bind(a,2994,23)),Promise.resolve().then(a.t.bind(a,6114,23)),Promise.resolve().then(a.t.bind(a,9727,23)),Promise.resolve().then(a.t.bind(a,9671,23)),Promise.resolve().then(a.t.bind(a,1868,23)),Promise.resolve().then(a.t.bind(a,4759,23))},3819:(e,r,a)=>{"use strict";a.d(r,{AuthProvider:()=>c,a:()=>y});var t=a(326),o=a(7577),s=a(381);let i=(0,o.createContext)(null),n={user:null,isAuthenticated:!1,loading:!1,error:null},l=(e,r)=>{switch(r.type){case"LOGIN_START":return{...e,loading:!0,error:null};case"LOGIN_SUCCESS":return{...e,user:r.payload,isAuthenticated:!0,loading:!1,error:null};case"LOGIN_FAILURE":return{...e,user:null,isAuthenticated:!1,loading:!1,error:r.payload};case"LOGOUT":return{...e,user:null,isAuthenticated:!1,loading:!1,error:null};case"CLEAR_ERROR":return{...e,error:null};case"SET_LOADING":return{...e,loading:r.payload};default:return e}},d=e=>{switch(e){case"ADMIN":return["all"];case"LIBRARIAN":return["books:read","books:create","books:update","books:delete","members:read","members:create","members:update","members:delete","borrowing:read","borrowing:create","borrowing:update","reservations:read","reservations:create","reservations:update","attendance:read","attendance:create","manage_attendance","reports:read","dashboard:read","settings:read"];case"MEMBER":return["books:read","borrowing:read","reservations:read","reservations:create","attendance:create"];default:return[]}},c=({children:e})=>{let[r,a]=(0,o.useReducer)(l,n);(0,o.useEffect)(()=>{let e=localStorage.getItem("library_user"),r=localStorage.getItem("token");if(e&&r)try{let r=JSON.parse(e);a({type:"LOGIN_SUCCESS",payload:r})}catch(e){localStorage.removeItem("library_user"),localStorage.removeItem("token")}},[]);let c=async(e,r)=>{a({type:"LOGIN_START"});try{let t=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:r})}),o=await t.json();if(t.ok){let e={...o.user,permissions:d(o.user.role)};a({type:"LOGIN_SUCCESS",payload:e}),localStorage.setItem("library_user",JSON.stringify(e)),localStorage.setItem("token",o.token),s.ZP.success(`Welcome back, ${e.name}!`)}else a({type:"LOGIN_FAILURE",payload:o.error||"Login failed"}),s.ZP.error(o.error||"Login failed")}catch(e){a({type:"LOGIN_FAILURE",payload:"Login failed. Please try again."}),s.ZP.error("Login failed. Please try again.")}},y=async(e,r,t,o="MEMBER")=>{a({type:"LOGIN_START"});try{let i=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:r,password:t,role:o})}),n=await i.json();if(i.ok){let e={...n.user,permissions:d(n.user.role)};a({type:"LOGIN_SUCCESS",payload:e}),localStorage.setItem("library_user",JSON.stringify(e)),localStorage.setItem("token",n.token),s.ZP.success(`Welcome, ${e.name}!`)}else a({type:"LOGIN_FAILURE",payload:n.error||"Registration failed"}),s.ZP.error(n.error||"Registration failed")}catch(e){a({type:"LOGIN_FAILURE",payload:"Registration failed. Please try again."}),s.ZP.error("Registration failed. Please try again.")}};return t.jsx(i.Provider,{value:{state:r,login:c,register:y,logout:()=>{a({type:"LOGOUT"}),localStorage.removeItem("library_user"),localStorage.removeItem("token"),s.ZP.success("Logged out successfully")},clearError:()=>{a({type:"CLEAR_ERROR"})},hasPermission:e=>!!r.user&&(!!r.user.permissions.includes("all")||r.user.permissions.includes(e))},children:e})},y=()=>{let e=(0,o.useContext)(i);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},8896:(e,r,a)=>{"use strict";a.d(r,{LibraryProvider:()=>c,y:()=>y});var t=a(326),o=a(7577),s=a(381);let i=(0,o.createContext)(null),n={books:[],members:[],borrowings:[],reservations:[],attendance:[],currentUser:null,loading:!1,error:null},l=(e,r)=>{switch(r.type){case"SET_LOADING":return{...e,loading:r.payload};case"SET_ERROR":return{...e,error:r.payload};case"SET_BOOKS":return{...e,books:r.payload};case"ADD_BOOK":return{...e,books:[...e.books,r.payload]};case"UPDATE_BOOK":return{...e,books:e.books.map(e=>e.id===r.payload.id?r.payload:e)};case"DELETE_BOOK":return{...e,books:e.books.filter(e=>e.id!==r.payload)};case"SET_MEMBERS":return{...e,members:r.payload};case"ADD_MEMBER":return{...e,members:[...e.members,r.payload]};case"UPDATE_MEMBER":return{...e,members:e.members.map(e=>e.id===r.payload.id?r.payload:e)};case"DELETE_MEMBER":return{...e,members:e.members.filter(e=>e.id!==r.payload)};case"SET_BORROWINGS":return{...e,borrowings:r.payload};case"ADD_BORROWING":return{...e,borrowings:[...e.borrowings,r.payload]};case"RETURN_BOOK":return{...e,borrowings:e.borrowings.map(e=>e.id===r.payload.id?r.payload:e)};case"SET_RESERVATIONS":return{...e,reservations:r.payload};case"ADD_RESERVATION":return{...e,reservations:[...e.reservations,r.payload]};case"SET_ATTENDANCE":return{...e,attendance:r.payload};case"ADD_ATTENDANCE":return{...e,attendance:[...e.attendance,r.payload]};case"SET_CURRENT_USER":return{...e,currentUser:r.payload};default:return e}},d=async(e,r={})=>{let a=localStorage.getItem("token"),t=await fetch(e,{...r,headers:{"Content-Type":"application/json",...a&&{Authorization:`Bearer ${a}`},...r.headers}});if(!t.ok){let e=await t.json();throw console.error("API Error:",e),Error(e.error||"API call failed")}return t.json()},c=({children:e})=>{let[r,a]=(0,o.useReducer)(l,n),c=async()=>{try{a({type:"SET_LOADING",payload:!0});let e=await d("/api/books");a({type:"SET_BOOKS",payload:e.books||e})}catch(e){console.error("Error fetching books:",e),a({type:"SET_ERROR",payload:"Failed to fetch books"}),s.ZP.error("Failed to fetch books")}finally{a({type:"SET_LOADING",payload:!1})}},y=async()=>{try{a({type:"SET_LOADING",payload:!0});let e=await d("/api/persons?limit=100"),r=e.persons?.map(e=>({id:e.id,name:e.name,email:e.email,phone:e.phone||"",address:e.address||"",membershipDate:e.membershipDate||e.createdAt,status:"ACTIVE"===e.status?"ACTIVE":"INACTIVE",personType:e.personType,createdAt:e.createdAt,updatedAt:e.updatedAt}))||[];a({type:"SET_MEMBERS",payload:r})}catch(e){console.error("Error fetching members:",e),a({type:"SET_ERROR",payload:"Failed to fetch members"}),s.ZP.error("Failed to fetch members")}finally{a({type:"SET_LOADING",payload:!1})}},p=async()=>{try{a({type:"SET_LOADING",payload:!0});let e=await d("/api/borrowings");a({type:"SET_BORROWINGS",payload:e.borrowings||e})}catch(e){console.error("Error fetching borrowings:",e),a({type:"SET_ERROR",payload:"Failed to fetch borrowings"}),s.ZP.error("Failed to fetch borrowings")}finally{a({type:"SET_LOADING",payload:!1})}},u=async()=>{try{a({type:"SET_LOADING",payload:!0});let e=await d("/api/reservations");a({type:"SET_RESERVATIONS",payload:e.reservations||e})}catch(e){console.error("Error fetching reservations:",e),a({type:"SET_ERROR",payload:"Failed to fetch reservations"}),s.ZP.error("Failed to fetch reservations")}finally{a({type:"SET_LOADING",payload:!1})}},E=async()=>{try{a({type:"SET_LOADING",payload:!0});let e=await d("/api/attendance");a({type:"SET_ATTENDANCE",payload:e.attendance||e})}catch(e){console.error("Error fetching attendance:",e),a({type:"SET_ERROR",payload:"Failed to fetch attendance"}),s.ZP.error("Failed to fetch attendance")}finally{a({type:"SET_LOADING",payload:!1})}};return(0,o.useEffect)(()=>{(async()=>{try{await Promise.all([c(),y()]),setTimeout(async()=>{try{await Promise.all([p(),u(),E()])}catch(e){console.error("Error loading secondary data:",e)}},100)}catch(e){console.error("Error loading initial data:",e),s.ZP.error("Error loading library data")}})()},[]),t.jsx(i.Provider,{value:{state:r,dispatch:a,addBook:async e=>{try{a({type:"SET_LOADING",payload:!0}),console.log("Adding book with data:",e);let r=await d("/api/books",{method:"POST",body:JSON.stringify(e)});a({type:"ADD_BOOK",payload:r}),s.ZP.success("Book added successfully!")}catch(e){if(console.error("Error adding book:",e),!e.message?.includes("already exists")&&!e.message?.includes("already exists")){let r=e.message||"Failed to add book";s.ZP.error(r)}throw e}finally{a({type:"SET_LOADING",payload:!1})}},updateBook:async e=>{try{a({type:"SET_LOADING",payload:!0});let r=await d(`/api/books/${e.id}`,{method:"PUT",body:JSON.stringify(e)});a({type:"UPDATE_BOOK",payload:r}),s.ZP.success("Book updated successfully!")}catch(e){console.error("Error updating book:",e),s.ZP.error("Failed to update book")}finally{a({type:"SET_LOADING",payload:!1})}},deleteBook:async e=>{try{a({type:"SET_LOADING",payload:!0}),await d(`/api/books/${e}`,{method:"DELETE"}),a({type:"DELETE_BOOK",payload:e}),s.ZP.success("Book deleted successfully!")}catch(e){console.error("Error deleting book:",e),s.ZP.error("Failed to delete book")}finally{a({type:"SET_LOADING",payload:!1})}},addMember:async e=>{try{a({type:"SET_LOADING",payload:!0});let r={name:e.name,email:e.email,phone:e.phone,address:e.address,personType:"MEMBER",status:"ACTIVE"},t=await d("/api/persons",{method:"POST",body:JSON.stringify(r)}),o={id:t.id,name:t.name,email:t.email,phone:t.phone||"",address:t.address||"",membershipDate:t.membershipDate||t.createdAt,status:"ACTIVE"===t.status?"ACTIVE":"INACTIVE",createdAt:t.createdAt,updatedAt:t.updatedAt};a({type:"ADD_MEMBER",payload:o}),s.ZP.success("Member added successfully!")}catch(e){throw console.error("Error adding member:",e),e.message?.includes("already exists")||e.message?.includes("already exists")||s.ZP.error("Failed to add member"),e}finally{a({type:"SET_LOADING",payload:!1})}},updateMember:async e=>{try{a({type:"SET_LOADING",payload:!0});let r={name:e.name,email:e.email,phone:e.phone,address:e.address,personType:"MEMBER",status:"ACTIVE"===e.status?"ACTIVE":"INACTIVE"},t=await d(`/api/persons/${e.id}`,{method:"PUT",body:JSON.stringify(r)}),o={id:t.id,name:t.name,email:t.email,phone:t.phone||"",address:t.address||"",membershipDate:t.membershipDate||t.createdAt,status:"ACTIVE"===t.status?"ACTIVE":"INACTIVE",createdAt:t.createdAt,updatedAt:t.updatedAt};a({type:"UPDATE_MEMBER",payload:o}),s.ZP.success("Member updated successfully!")}catch(e){console.error("Error updating member:",e),s.ZP.error("Failed to update member")}finally{a({type:"SET_LOADING",payload:!1})}},deleteMember:async e=>{try{a({type:"SET_LOADING",payload:!0}),await d(`/api/persons/${e}`,{method:"DELETE"}),a({type:"DELETE_MEMBER",payload:e}),s.ZP.success("Member deleted successfully!")}catch(e){console.error("Error deleting member:",e),s.ZP.error("Failed to delete member")}finally{a({type:"SET_LOADING",payload:!1})}},borrowBook:async e=>{try{a({type:"SET_LOADING",payload:!0});let r=await d("/api/borrowings",{method:"POST",body:JSON.stringify(e)});a({type:"ADD_BORROWING",payload:r}),s.ZP.success("Book borrowed successfully!")}catch(e){throw console.error("Error borrowing book:",e),e.message?.includes("already")||e.message?.includes("not found")||s.ZP.error("Failed to borrow book"),e}finally{a({type:"SET_LOADING",payload:!1})}},returnBook:async e=>{try{a({type:"SET_LOADING",payload:!0});let r=await d(`/api/borrowings/${e}`,{method:"PUT",body:JSON.stringify({action:"return"})});a({type:"RETURN_BOOK",payload:r}),s.ZP.success("Book returned successfully!")}catch(e){console.error("Error returning book:",e),s.ZP.error("Failed to return book")}finally{a({type:"SET_LOADING",payload:!1})}},addReservation:async e=>{try{a({type:"SET_LOADING",payload:!0});let r=await d("/api/reservations",{method:"POST",body:JSON.stringify(e)});a({type:"ADD_RESERVATION",payload:r}),s.ZP.success("Book reserved successfully!")}catch(e){throw console.error("Error adding reservation:",e),e.message?.includes("already")||e.message?.includes("not found")||s.ZP.error("Failed to reserve book"),e}finally{a({type:"SET_LOADING",payload:!1})}},addAttendance:async e=>{try{a({type:"SET_LOADING",payload:!0});let r={action:"check-in",personId:e.personId,memberId:e.memberId,visitorName:e.visitorName,visitorEmail:e.visitorEmail,visitorPhone:e.visitorPhone},t=await d("/api/attendance",{method:"POST",body:JSON.stringify(r)});a({type:"ADD_ATTENDANCE",payload:t}),s.ZP.success("Attendance recorded successfully!")}catch(e){throw console.error("Error adding attendance:",e),e.message?.includes("already")||e.message?.includes("already checked in")||s.ZP.error("Failed to record attendance"),e}finally{a({type:"SET_LOADING",payload:!1})}},getRecommendations:e=>{let a=r.borrowings.filter(r=>r.memberId===e).map(e=>r.books.find(r=>r.id===e.bookId)).filter(Boolean),t=a.map(e=>e.category),o=t.sort((e,r)=>t.filter(r=>r===e).length-t.filter(e=>e===r).length).pop();return r.books.filter(e=>e.category===o&&!a.some(r=>r.id===e.id)&&"AVAILABLE"===e.status).slice(0,3)},fetchBooks:c,fetchMembers:y,fetchBorrowings:p,fetchReservations:u,fetchAttendance:E},children:e})},y=()=>{let e=(0,o.useContext)(i);if(!e)throw Error("useLibrary must be used within a LibraryProvider");return e}},2807:(e,r,a)=>{"use strict";a.d(r,{NotificationProvider:()=>d,z:()=>c});var t=a(326),o=a(7577),s=a(381);let i=(0,o.createContext)(null),n={notifications:[],unreadCount:0},l=(e,r)=>{switch(r.type){case"ADD_NOTIFICATION":let a={...r.payload,id:Date.now().toString(),timestamp:new Date,read:!1};return{...e,notifications:[a,...e.notifications],unreadCount:e.unreadCount+1};case"MARK_AS_READ":return{...e,notifications:e.notifications.map(e=>e.id===r.payload?{...e,read:!0}:e),unreadCount:Math.max(0,e.unreadCount-1)};case"MARK_ALL_AS_READ":return{...e,notifications:e.notifications.map(e=>({...e,read:!0})),unreadCount:0};case"REMOVE_NOTIFICATION":let t=e.notifications.find(e=>e.id===r.payload);return{...e,notifications:e.notifications.filter(e=>e.id!==r.payload),unreadCount:t&&!t.read?Math.max(0,e.unreadCount-1):e.unreadCount};case"CLEAR_ALL_NOTIFICATIONS":return{...e,notifications:[],unreadCount:0};default:return e}},d=({children:e})=>{let[r,a]=(0,o.useReducer)(l,n);return(0,o.useEffect)(()=>{let e=localStorage.getItem("library_notifications");if(e)try{JSON.parse(e).forEach(e=>{a({type:"ADD_NOTIFICATION",payload:e})})}catch(e){localStorage.removeItem("library_notifications")}},[]),(0,o.useEffect)(()=>{localStorage.setItem("library_notifications",JSON.stringify(r.notifications))},[r.notifications]),t.jsx(i.Provider,{value:{state:r,addNotification:e=>{switch(a({type:"ADD_NOTIFICATION",payload:e}),e.type){case"success":s.ZP.success(e.message);break;case"error":s.ZP.error(e.message);break;case"warning":(0,s.ZP)(e.message,{icon:"⚠️"});break;default:(0,s.ZP)(e.message)}},markAsRead:e=>{a({type:"MARK_AS_READ",payload:e})},markAllAsRead:()=>{a({type:"MARK_ALL_AS_READ"})},removeNotification:e=>{a({type:"REMOVE_NOTIFICATION",payload:e})},clearAllNotifications:()=>{a({type:"CLEAR_ALL_NOTIFICATIONS"})}},children:e})},c=()=>{let e=(0,o.useContext)(i);if(!e)throw Error("useNotifications must be used within a NotificationProvider");return e}},7438:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>p,metadata:()=>y});var t=a(9510),o=a(7366),s=a.n(o);a(7272);var i=a(9125),n=a(8570);let l=(0,n.createProxy)(String.raw`C:\Users\USER\Desktop\Library Project\app\context\LibraryContext.tsx#LibraryProvider`);(0,n.createProxy)(String.raw`C:\Users\USER\Desktop\Library Project\app\context\LibraryContext.tsx#useLibrary`);let d=(0,n.createProxy)(String.raw`C:\Users\USER\Desktop\Library Project\app\context\AuthContext.tsx#AuthProvider`);(0,n.createProxy)(String.raw`C:\Users\USER\Desktop\Library Project\app\context\AuthContext.tsx#useAuth`);let c=(0,n.createProxy)(String.raw`C:\Users\USER\Desktop\Library Project\app\context\NotificationContext.tsx#NotificationProvider`);(0,n.createProxy)(String.raw`C:\Users\USER\Desktop\Library Project\app\context\NotificationContext.tsx#useNotifications`);let y={title:"Robert Aboagye Mensah Community Library",description:"Community Library Management System"};function p({children:e}){return t.jsx("html",{lang:"en",children:t.jsx("body",{className:s().className,children:t.jsx(d,{children:t.jsx(c,{children:(0,t.jsxs)(l,{children:[e,t.jsx(i.x7,{position:"top-right"})]})})})})})}},7272:()=>{}};