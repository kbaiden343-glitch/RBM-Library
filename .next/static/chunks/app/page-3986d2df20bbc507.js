(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{350:function(e,s,t){Promise.resolve().then(t.bind(t,5587))},5587:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return eW}});var a=t(7437),r=t(2265),l=t(6501),n=t(6124),i=t(7367),c=t(5617),o=t(5048),d=()=>{let{login:e,state:s}=(0,l.a)(),[t,d]=(0,r.useState)({email:"",password:""}),[x,m]=(0,r.useState)(!1),u=async s=>{s.preventDefault(),await e(t.email,t.password)},h=e=>{d(s=>({...s,[e.target.name]:e.target.value}))};return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mx-auto h-20 w-20 relative",children:[(0,a.jsx)("img",{src:"/ST peter.png",alt:"Robert Aboagye Mensah Community Library",className:"h-20 w-20 rounded-full object-cover border-4 border-yellow-400 shadow-lg",onError:e=>{e.currentTarget.style.display="none";let s=e.currentTarget.nextElementSibling;s&&(s.style.display="flex")}}),(0,a.jsx)("div",{className:"h-20 w-20 rounded-full bg-gradient-to-br from-blue-800 to-blue-600 border-4 border-yellow-400 hidden items-center justify-center text-white shadow-lg",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-red-400 text-2xl font-bold",children:"✚"}),(0,a.jsx)("div",{className:"text-sm font-bold text-yellow-200",children:"MC"})]})})]}),(0,a.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Sign in to your account"}),(0,a.jsx)("p",{className:"mt-2 text-center text-lg font-semibold text-blue-800",children:"Robert Aboagye Mensah"}),(0,a.jsx)("p",{className:"text-center text-sm text-gray-600",children:"Community Library"})]}),(0,a.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:u,children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700",children:"Username"}),(0,a.jsxs)("div",{className:"mt-1 relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(n.Z,{className:"h-5 w-5 text-gray-400"})}),(0,a.jsx)("input",{id:"username",name:"email",type:"email",required:!0,value:t.email,onChange:h,className:"appearance-none rounded-lg relative block w-full pl-10 pr-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Enter your email"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,a.jsxs)("div",{className:"mt-1 relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(i.Z,{className:"h-5 w-5 text-gray-400"})}),(0,a.jsx)("input",{id:"password",name:"password",type:x?"text":"password",required:!0,value:t.password,onChange:h,className:"appearance-none rounded-lg relative block w-full pl-10 pr-10 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Enter your password"}),(0,a.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:(0,a.jsx)("button",{type:"button",onClick:()=>m(!x),className:"text-gray-400 hover:text-gray-600",children:x?(0,a.jsx)(c.Z,{className:"h-5 w-5"}):(0,a.jsx)(o.Z,{className:"h-5 w-5"})})})]})]})]}),s.error&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,a.jsx)("p",{className:"text-sm text-red-600",children:s.error})}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{type:"submit",disabled:s.loading,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:s.loading?(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Signing in..."]}):"Sign in"})}),(0,a.jsx)("div",{className:"mt-6",children:(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-blue-800 mb-2",children:"Demo Accounts:"}),(0,a.jsxs)("div",{className:"text-xs text-blue-700 space-y-1",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Admin:"})," username: admin, password: password"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Librarian:"})," username: librarian, password: password"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Member:"})," username: member, password: password"]})]})]})})]})]})})},x=e=>{let{children:s,requiredPermissions:t=[]}=e,{state:r,hasPermission:n}=(0,l.a)();return r.isAuthenticated?t.length>0&&!t.every(e=>n(e))?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"mx-auto h-16 w-16 bg-red-100 rounded-full flex items-center justify-center mb-4",children:(0,a.jsx)("svg",{className:"h-8 w-8 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),(0,a.jsx)("p",{className:"text-gray-600",children:"You don't have permission to access this page."})]})}):(0,a.jsx)(a.Fragment,{children:s}):(0,a.jsx)(d,{})},m=t(4891),u=t(420),h=t(217),g=t(3883),p=t(6606),b=()=>{let{state:e,logout:s}=(0,l.a)(),[t,i]=(0,r.useState)(!1);return e.user?(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>i(!t),className:"flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-100 transition-colors",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center",children:(0,a.jsx)(n.Z,{className:"h-5 w-5 text-white"})}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.user.name}),(0,a.jsx)("p",{className:"text-xs text-gray-600 capitalize",children:e.user.role})]})]}),t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>i(!1)}),(0,a.jsxs)("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 z-20",children:[(0,a.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center",children:(0,a.jsx)(n.Z,{className:"h-6 w-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:e.user.name}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.user.email}),(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full mt-1 ".concat((e=>{switch(e){case"admin":return"bg-red-100 text-red-800";case"librarian":return"bg-blue-100 text-blue-800";case"member":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}})(e.user.role)),children:e.user.role})]})]})}),(0,a.jsxs)("div",{className:"py-2",children:[(0,a.jsxs)("button",{className:"w-full flex items-center space-x-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[(0,a.jsx)(h.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Notifications"})]}),(0,a.jsxs)("button",{className:"w-full flex items-center space-x-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[(0,a.jsx)(g.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Settings"})]}),(0,a.jsx)("hr",{className:"my-2"}),(0,a.jsxs)("button",{onClick:s,className:"w-full flex items-center space-x-3 px-4 py-2 text-sm text-red-600 hover:bg-red-50",children:[(0,a.jsx)(p.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Sign out"})]})]})]})]})]}):null},y=t(9124),j=t(1914),f=t(8279),N=t(3869),v=t(607),w=t(4754),k=()=>{let{state:e,markAsRead:s,markAllAsRead:t,removeNotification:l,clearAllNotifications:n}=(0,y.z)(),[i,c]=(0,r.useState)(!1),o=e=>{switch(e){case"success":return(0,a.jsx)(j.Z,{className:"h-5 w-5 text-green-600"});case"error":return(0,a.jsx)(f.Z,{className:"h-5 w-5 text-red-600"});case"warning":return(0,a.jsx)(N.Z,{className:"h-5 w-5 text-yellow-600"});default:return(0,a.jsx)(v.Z,{className:"h-5 w-5 text-blue-600"})}};return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>c(!i),className:"relative p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:[(0,a.jsx)(h.Z,{className:"h-5 w-5"}),e.unreadCount>0&&(0,a.jsx)("span",{className:"absolute top-1 right-1 h-2 w-2 bg-red-500 rounded-full"})]}),i&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>c(!1)}),(0,a.jsxs)("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-200 z-20 max-h-96 overflow-hidden",children:[(0,a.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Notifications"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[e.unreadCount>0&&(0,a.jsx)("button",{onClick:t,className:"text-sm text-blue-600 hover:text-blue-700",children:"Mark all read"}),(0,a.jsx)("button",{onClick:n,className:"text-sm text-gray-500 hover:text-gray-700",children:"Clear all"})]})]})}),(0,a.jsx)("div",{className:"max-h-80 overflow-y-auto",children:0===e.notifications.length?(0,a.jsxs)("div",{className:"p-6 text-center text-gray-500",children:[(0,a.jsx)(h.Z,{className:"h-8 w-8 mx-auto mb-2 text-gray-400"}),(0,a.jsx)("p",{children:"No notifications"})]}):(0,a.jsx)("div",{className:"divide-y divide-gray-200",children:e.notifications.map(e=>(0,a.jsx)("div",{className:"p-4 hover:bg-gray-50 transition-colors ".concat(e.read?"":"bg-blue-50"),children:(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:o(e.type)}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.title}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[!e.read&&(0,a.jsx)("div",{className:"h-2 w-2 bg-blue-600 rounded-full"}),(0,a.jsx)("button",{onClick:()=>l(e.id),className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(m.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.message}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,a.jsx)("p",{className:"text-xs text-gray-500",children:e.timestamp.toLocaleString()}),!e.read&&(0,a.jsxs)("button",{onClick:()=>s(e.id),className:"text-xs text-blue-600 hover:text-blue-700 flex items-center space-x-1",children:[(0,a.jsx)(w.Z,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:"Mark as read"})]})]}),e.action&&(0,a.jsx)("button",{onClick:e.action.onClick,className:"mt-2 text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700",children:e.action.label})]})]})},e.id))})})]})]})]})},C=t(1338),S=t(4166),D=t(9150),A=t(8470),E=t(8399),Z=e=>{let{onNavigate:s}=e,{hasPermission:t}=(0,l.a)(),[i,c]=(0,r.useState)(!1),[o,d]=(0,r.useState)(""),[x,u]=(0,r.useState)([]),[h,g]=(0,r.useState)(!1),[p,b]=(0,r.useState)(-1),y=(0,r.useRef)(null),j=(0,r.useRef)(null);if(!t("members:read")&&!t("users:read"))return null;(0,r.useEffect)(()=>{let e=e=>{y.current&&!y.current.contains(e.target)&&(c(!1),b(-1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,r.useEffect)(()=>{let e=setTimeout(async()=>{if(o.trim().length<2){u([]);return}g(!0);try{let e=localStorage.getItem("token"),s=await fetch("/api/search?q=".concat(encodeURIComponent(o),"&limit=8"),{headers:{Authorization:"Bearer ".concat(e)}});if(s.ok){let e=await s.json();u(e.results||[])}else u([])}catch(e){console.error("Search error:",e),u([])}finally{g(!1)}},300);return()=>clearTimeout(e)},[o]);let f=e=>{c(!1),d(""),u([]),b(-1),s(e.navigateTo,e.id),sessionStorage.setItem("highlightPersonId",e.id)},N=e=>{switch(e){case"member":case"legacy_member":return(0,a.jsx)(n.Z,{className:"h-4 w-4 text-blue-600"});case"visitor":return(0,a.jsx)(C.Z,{className:"h-4 w-4 text-green-600"});case"user":return(0,a.jsx)(S.Z,{className:"h-4 w-4 text-purple-600"});default:return(0,a.jsx)(n.Z,{className:"h-4 w-4 text-gray-600"})}},v=e=>{switch(e){case"member":case"legacy_member":return"border-l-blue-500 bg-blue-50";case"visitor":return"border-l-green-500 bg-green-50";case"user":return"border-l-purple-500 bg-purple-50";default:return"border-l-gray-500 bg-gray-50"}},w=e=>e?new Date(e).toLocaleDateString():"";return(0,a.jsxs)("div",{className:"relative",ref:y,children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(D.Z,{className:"h-4 w-4 text-gray-400"})}),(0,a.jsx)("input",{ref:j,type:"text",placeholder:"Search people, members, visitors...",value:o,onChange:e=>{d(e.target.value),c(!0),b(-1)},onFocus:()=>c(!0),onKeyDown:e=>{if("ArrowDown"===e.key)e.preventDefault(),b(e=>Math.min(e+1,x.length-1));else if("ArrowUp"===e.key)e.preventDefault(),b(e=>Math.max(e-1,-1));else if("Enter"===e.key)e.preventDefault(),p>=0&&x[p]&&f(x[p]);else if("Escape"===e.key){var s;c(!1),b(-1),null===(s=j.current)||void 0===s||s.blur()}},className:"w-full pl-10 pr-10 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),o&&(0,a.jsx)("button",{onClick:()=>{d(""),u([]),c(!1),b(-1)},className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:(0,a.jsx)(m.Z,{className:"h-4 w-4 text-gray-400 hover:text-gray-600"})})]}),i&&(o.length>=2||x.length>0)&&(0,a.jsxs)("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-50 max-h-96 overflow-y-auto",children:[h&&(0,a.jsxs)("div",{className:"px-4 py-3 text-center text-gray-500",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600 mx-auto mb-2"}),"Searching..."]}),!h&&o.length>=2&&0===x.length&&(0,a.jsxs)("div",{className:"px-4 py-6 text-center text-gray-500",children:[(0,a.jsx)(D.Z,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),(0,a.jsxs)("p",{className:"text-sm",children:['No people found for "',o,'"']}),(0,a.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Try searching by name, email, phone, or library ID"})]}),!h&&x.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"px-3 py-2 bg-gray-50 border-b border-gray-200",children:(0,a.jsxs)("p",{className:"text-xs font-medium text-gray-600",children:["Found ",x.length," people • Click to navigate"]})}),x.map((e,s)=>(0,a.jsx)("div",{onClick:()=>f(e),className:"px-4 py-3 cursor-pointer border-l-4 transition-colors ".concat(s===p?"".concat(v(e.type)," border-l-4"):"hover:bg-gray-50 border-l-transparent"),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[N(e.type),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.name}),e.libraryId&&(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800",children:e.libraryId}),(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ".concat("ACTIVE"===e.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.status})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 truncate",children:e.subtitle}),e.membershipDate&&(0,a.jsxs)("div",{className:"flex items-center space-x-1 mt-1",children:[(0,a.jsx)(A.Z,{className:"h-3 w-3 text-gray-400"}),(0,a.jsxs)("p",{className:"text-xs text-gray-400",children:["Member since ",w(e.membershipDate)]})]})]})]}),(0,a.jsx)(E.Z,{className:"h-4 w-4 text-gray-400"})]})},"".concat(e.type,"-").concat(e.id))),x.length>=8&&(0,a.jsx)("div",{className:"px-4 py-2 bg-gray-50 border-t border-gray-200",children:(0,a.jsx)("p",{className:"text-xs text-gray-500 text-center",children:"Showing first 8 results. Be more specific to narrow down."})})]}),o.length<2&&o.length>0&&(0,a.jsx)("div",{className:"px-4 py-3 text-center text-gray-500",children:(0,a.jsx)("p",{className:"text-sm",children:"Type at least 2 characters to search"})})]})]})},I=e=>{let{onNavigate:s,onMenuToggle:t,isSidebarOpen:n}=e,{state:i}=(0,l.a)(),[c,o]=(0,r.useState)(!1);return(0,a.jsxs)("nav",{className:"bg-white shadow-sm border-b border-gray-200 px-6 py-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("button",{onClick:t,className:"md:hidden p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:n?(0,a.jsx)(m.Z,{className:"h-5 w-5"}):(0,a.jsx)(u.Z,{className:"h-5 w-5"})}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("img",{src:"/ST peter.png",alt:"Robert Aboagye Mensah Community Library",className:"h-8 w-8 md:h-12 md:w-12 rounded-full object-cover border-2 border-yellow-400",onError:e=>{e.currentTarget.style.display="none";let s=e.currentTarget.nextElementSibling;s&&(s.style.display="flex")}}),(0,a.jsx)("div",{className:"h-8 w-8 md:h-12 md:w-12 rounded-full bg-gradient-to-br from-blue-800 to-blue-600 border-2 border-yellow-400 hidden items-center justify-center text-white shadow-lg",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-red-400 text-sm md:text-lg font-bold",children:"✚"}),(0,a.jsx)("div",{className:"text-xs font-bold text-yellow-200",children:"MC"})]})})]}),(0,a.jsxs)("div",{className:"hidden sm:block",children:[(0,a.jsx)("h1",{className:"text-lg md:text-xl font-bold text-gray-900",children:"Robert Aboagye Mensah"}),(0,a.jsx)("p",{className:"text-xs md:text-sm text-gray-600",children:"Community Library"})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 md:space-x-4",children:[(0,a.jsx)("div",{className:"hidden md:block w-80",children:(0,a.jsx)(Z,{onNavigate:s})}),(0,a.jsx)(k,{}),i.user&&(0,a.jsx)(b,{})]})]}),c&&(0,a.jsx)("div",{className:"md:hidden mt-4",children:(0,a.jsx)(Z,{onNavigate:s})})]})},T=t(2009),B=t(1451),R=t(4923),L=t(5809),P=t(7941),M=t(7189),O=e=>{let{activePage:s,setActivePage:t,onClose:r}=e,{state:n,hasPermission:i}=(0,l.a)(),c=[{key:"dashboard",icon:T.Z,label:"Dashboard",permission:"dashboard:read"},{key:"catalog",icon:B.Z,label:"Book Catalog",permission:"books:read"},{key:"people",icon:C.Z,label:"People Management",permission:"members:read"},{key:"borrowing",icon:R.Z,label:"Borrowing System",permission:"borrowing:read"},{key:"attendance",icon:L.Z,label:"Attendance (Unified)",permission:"manage_attendance"},{key:"users",icon:S.Z,label:"User Management",permission:"all"},{key:"reports",icon:P.Z,label:"Reports & Analytics",permission:"reports:read"},{key:"settings",icon:g.Z,label:"Settings",permission:"settings:read"}],o=[{icon:M.Z,label:"Attendance Analytics",action:()=>t("tracking"),permission:"attendance:read"}],d=c.filter(e=>i(e.permission)),x=o.filter(e=>i(e.permission)),m=e=>{t(e),r&&r()};return(0,a.jsx)("aside",{className:"w-64 bg-white shadow-sm border-r border-gray-200 min-h-screen",children:(0,a.jsxs)("div",{className:"p-4 md:p-6",children:[(0,a.jsx)("nav",{className:"space-y-2",children:d.map(e=>{let t=e.icon,r=s===e.key;return(0,a.jsxs)("button",{onClick:()=>m(e.key),className:"flex items-center space-x-3 px-3 py-2 rounded-lg transition-colors w-full text-left ".concat(r?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"),children:[(0,a.jsx)(t,{className:"h-5 w-5"}),(0,a.jsx)("span",{className:"font-medium",children:e.label})]},e.key)})}),x.length>0&&(0,a.jsxs)("div",{className:"mt-8 pt-6 border-t border-gray-200",children:[(0,a.jsx)("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3",children:"Quick Actions"}),(0,a.jsx)("div",{className:"space-y-2",children:x.map((e,s)=>{let t=e.icon;return(0,a.jsxs)("button",{onClick:e.action,className:"flex items-center space-x-3 px-3 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors w-full text-left",children:[(0,a.jsx)(t,{className:"h-5 w-5"}),(0,a.jsx)("span",{className:"font-medium",children:e.label})]},s)})})]}),n.user&&(0,a.jsxs)("div",{className:"mt-8 pt-6 border-t border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,a.jsx)(S.Z,{className:"h-4 w-4 text-gray-500"}),(0,a.jsx)("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Your Role"})]}),(0,a.jsxs)("div",{className:"bg-blue-50 rounded-lg p-3",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-blue-900 capitalize",children:n.user.role}),(0,a.jsx)("p",{className:"text-xs text-blue-700",children:n.user.name})]})]})]})})},F=()=>{let{addNotification:e}=(0,y.z)();return(0,r.useEffect)(()=>{localStorage.getItem("library_welcome_shown")||(setTimeout(()=>{e({type:"info",title:"Welcome to the Library System!",message:"You can now manage books, members, and borrowing activities. Explore the different sections using the sidebar.",action:{label:"Get Started",onClick:()=>console.log("Getting started...")}})},2e3),setTimeout(()=>{e({type:"warning",title:"System Maintenance",message:"Scheduled maintenance will occur tonight from 2 AM to 4 AM. Some features may be temporarily unavailable."})},5e3),setTimeout(()=>{e({type:"success",title:"New Features Available",message:"Check out the new QR code scanner and enhanced reporting features in the latest update!"})},8e3),localStorage.setItem("library_welcome_shown","true"))},[e]),null},V=t(700),U=t(6325),z=t(2782),q=t(1359),Y=t(5972),J=t(9421),G=()=>{let{state:e,addBook:s,addMember:t,borrowBook:n,addAttendance:i}=(0,V.y)(),{hasPermission:c}=(0,l.a)(),{addNotification:o}=(0,y.z)(),{books:d,members:x,borrowings:m,reservations:u,attendance:h}=e,[g,p]=(0,r.useState)({totalBooks:0,totalMembers:0,borrowedBooks:0,overdueBooks:0,todayAttendance:0,pendingReservations:0,availableBooks:0,totalBorrowings:0,monthlyBorrowings:0,popularCategories:[]}),[b,j]=(0,r.useState)([]),[f,v]=(0,r.useState)(!1),[w,k]=(0,r.useState)("7days");(0,r.useEffect)(()=>{S(),D()},[d,x,m,u,h]);let S=()=>{let e=m.filter(e=>"BORROWED"===e.status),s=e.filter(e=>new Date(e.dueDate)<new Date),t=new Date().toDateString(),a=h.filter(e=>new Date(e.checkInTime).toDateString()===t),r=new Date;r.setDate(r.getDate()-30);let l=m.filter(e=>new Date(e.borrowDate)>=r).length,n=Object.entries(d.reduce((e,s)=>(e[s.category]=(e[s.category]||0)+1,e),{})).map(e=>{let[s,t]=e;return{category:s,count:t}}).sort((e,s)=>s.count-e.count).slice(0,5);p({totalBooks:d.length,totalMembers:x.length,borrowedBooks:e.length,overdueBooks:s.length,todayAttendance:a.length,pendingReservations:u.filter(e=>"WAITING"===e.status).length,availableBooks:d.filter(e=>"AVAILABLE"===e.status).length,totalBorrowings:m.length,monthlyBorrowings:l,popularCategories:n})},D=()=>{let e=[];e.push(...m.sort((e,s)=>new Date(s.borrowDate).getTime()-new Date(e.borrowDate).getTime()).slice(0,5).map(e=>{let s=d.find(s=>s.id===e.bookId),t=x.find(s=>s.id===(e.memberId||e.personId));return{type:"borrow",message:"".concat((null==t?void 0:t.name)||"Unknown",' borrowed "').concat((null==s?void 0:s.title)||"Unknown Book",'"'),time:new Date(e.borrowDate).toLocaleString(),icon:R.Z,color:"text-blue-600"}}),...m.filter(e=>"RETURNED"===e.status&&e.returnDate).sort((e,s)=>new Date(s.returnDate).getTime()-new Date(e.returnDate).getTime()).slice(0,3).map(e=>{let s=d.find(s=>s.id===e.bookId),t=x.find(s=>s.id===(e.memberId||e.personId));return{type:"return",message:"".concat((null==t?void 0:t.name)||"Unknown",' returned "').concat((null==s?void 0:s.title)||"Unknown Book",'"'),time:new Date(e.returnDate).toLocaleString(),icon:B.Z,color:"text-green-600"}}),...h.sort((e,s)=>new Date(s.checkInTime).getTime()-new Date(e.checkInTime).getTime()).slice(0,3).map(e=>{let s=x.find(s=>s.id===e.memberId);return{type:"attendance",message:"".concat((null==s?void 0:s.name)||"Unknown"," checked in"),time:new Date(e.checkInTime).toLocaleString(),icon:C.Z,color:"text-purple-600"}})),j(e.sort((e,s)=>new Date(s.time).getTime()-new Date(e.time).getTime()).slice(0,8))},E=async()=>{v(!0),await new Promise(e=>setTimeout(e,1e3)),S(),D(),v(!1),o({type:"success",title:"Dashboard Refreshed",message:"All statistics have been updated."})},Z=[{title:"Add New Book",description:"Add a new book to the catalog",icon:U.Z,action:()=>{o({type:"info",title:"Quick Action",message:"Navigate to Book Catalog to add a new book."})},color:"bg-blue-500",permission:"books:write"},{title:"Scan QR Code",description:"Quick book checkout/return",icon:z.Z,action:()=>{o({type:"info",title:"Quick Action",message:"Navigate to QR Scanner for quick operations."})},color:"bg-green-500",permission:"scanner:use"},{title:"Record Attendance",description:"Log member library visit",icon:M.Z,action:()=>{let e=x[0];e&&i({personId:e.id,memberId:e.id})},color:"bg-purple-500",permission:"attendance:write"},{title:"View Reports",description:"Generate library reports",icon:q.Z,action:()=>{o({type:"info",title:"Quick Action",message:"Navigate to Reports for detailed analytics."})},color:"bg-orange-500",permission:"reports:read"}].filter(e=>c(e.permission));return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard"}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:"Welcome to Robert Aboagye Mensah Community Library"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsxs)("select",{value:w,onChange:e=>k(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600",children:[(0,a.jsx)("option",{value:"7days",children:"Last 7 days"}),(0,a.jsx)("option",{value:"30days",children:"Last 30 days"}),(0,a.jsx)("option",{value:"90days",children:"Last 90 days"})]}),(0,a.jsxs)("button",{onClick:E,disabled:f,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[(0,a.jsx)(Y.Z,{className:"h-4 w-4 ".concat(f?"animate-spin":"")}),(0,a.jsx)("span",{children:"Refresh"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Books"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:g.totalBooks}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[g.availableBooks," available"]})]}),(0,a.jsx)("div",{className:"p-3 bg-blue-100 rounded-lg",children:(0,a.jsx)(B.Z,{className:"h-6 w-6 text-blue-600"})})]})}),(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Members"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:g.totalMembers}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[g.todayAttendance," visited today"]})]}),(0,a.jsx)("div",{className:"p-3 bg-green-100 rounded-lg",children:(0,a.jsx)(C.Z,{className:"h-6 w-6 text-green-600"})})]})}),(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Active Loans"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:g.borrowedBooks}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[g.overdueBooks," overdue"]})]}),(0,a.jsx)("div",{className:"p-3 bg-yellow-100 rounded-lg",children:(0,a.jsx)(R.Z,{className:"h-6 w-6 text-yellow-600"})})]})}),(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Monthly Activity"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:g.monthlyBorrowings}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"borrowings this month"})]}),(0,a.jsx)("div",{className:"p-3 bg-purple-100 rounded-lg",children:(0,a.jsx)(J.Z,{className:"h-6 w-6 text-purple-600"})})]})})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Quick Actions"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:Z.map((e,s)=>{let t=e.icon;return(0,a.jsxs)("button",{onClick:e.action,className:"p-4 border border-gray-200 rounded-lg hover:shadow-md transition-shadow text-left group",children:[(0,a.jsx)("div",{className:"p-3 ".concat(e.color," rounded-lg inline-block mb-3 group-hover:scale-110 transition-transform"),children:(0,a.jsx)(t,{className:"h-6 w-6 text-white"})}),(0,a.jsx)("h3",{className:"font-medium text-gray-900 mb-1",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]},s)})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Popular Categories"}),(0,a.jsx)("div",{className:"space-y-3",children:g.popularCategories.map((e,s)=>{let t=e.count/g.totalBooks*100;return(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-600 capitalize",children:e.category}),(0,a.jsxs)("span",{className:"font-medium text-gray-900",children:[e.count," books"]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-500",style:{width:"".concat(t,"%")}})})]},s)})})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Activities"}),(0,a.jsx)("div",{className:"space-y-3",children:b.length>0?b.map((e,s)=>{let t=e.icon;return(0,a.jsxs)("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"p-2 rounded-lg ".concat(e.color.replace("text-","bg-").replace("-600","-100")),children:(0,a.jsx)(t,{className:"h-4 w-4 ".concat(e.color)})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm text-gray-900",children:e.message}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:e.time})]})]},s)}):(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsx)(J.Z,{className:"h-8 w-8 mx-auto mb-2 text-gray-400"}),(0,a.jsx)("p",{children:"No recent activities"})]})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Overdue Books"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-red-600",children:g.overdueBooks})]}),(0,a.jsx)(N.Z,{className:"h-8 w-8 text-red-600"})]})}),(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Pending Reservations"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:g.pendingReservations})]}),(0,a.jsx)(A.Z,{className:"h-8 w-8 text-yellow-600"})]})}),(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Borrowings"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:g.totalBorrowings})]}),(0,a.jsx)(q.Z,{className:"h-8 w-8 text-blue-600"})]})})]})]})},W=t(3922),Q=t(2095),H=t(7089),_=t(5964),K=t(2478),$=t(6850),X=t(3739),ee=t(2643),es=t(1340);let et=e=>["Title,Author,ISBN,Category,Published Year,Status,Description",...e.map(e=>['"'.concat(e.title.replace(/"/g,'""'),'"'),'"'.concat(e.author.replace(/"/g,'""'),'"'),'"'.concat(e.isbn,'"'),'"'.concat(e.category,'"'),e.publishedYear,'"'.concat(e.status,'"'),'"'.concat((e.description||"").replace(/"/g,'""'),'"')].join(","))].join("\n"),ea=e=>JSON.stringify(e,null,2),er=(e,s,t)=>{let a=new Blob([e],{type:t}),r=URL.createObjectURL(a),l=document.createElement("a");l.href=r,l.download=s,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(r)},el=e=>{if(e)switch(e.toLowerCase()){case"available":return"AVAILABLE";case"borrowed":return"BORROWED";case"reserved":return"RESERVED";default:return}},en=e=>{let s=e.split("\n").filter(e=>e.trim());if(s.length<2)return[];let t=s[0].split(",").map(e=>e.replace(/"/g,"").trim()),a=[];for(let e=1;e<s.length;e++){let r=ei(s[e]);if(r.length!==t.length)continue;let l={title:r[0]||"",author:r[1]||"",isbn:r[2]||"",category:r[3]||"fiction",publishedYear:parseInt(r[4])||new Date().getFullYear(),description:r[6]||"",status:el(r[5])||"AVAILABLE"};a.push(l)}return a},ei=e=>{let s=[],t="",a=!1;for(let r=0;r<e.length;r++){let l=e[r];'"'===l?a&&'"'===e[r+1]?(t+='"',r++):a=!a:","!==l||a?t+=l:(s.push(t.trim()),t="")}return s.push(t.trim()),s},ec=e=>{let s=[];return e.title&&0!==e.title.trim().length||s.push("Title is required"),e.author&&0!==e.author.trim().length||s.push("Author is required"),e.category&&0!==e.category.trim().length||s.push("Category is required"),(!e.publishedYear||e.publishedYear<1e3||e.publishedYear>new Date().getFullYear()+1)&&s.push("Published year must be between 1000 and "+(new Date().getFullYear()+1)),e.isbn&&e.isbn.length>0&&!eo(e.isbn)&&s.push("Invalid ISBN format"),s},eo=e=>{let s=e.replace(/[-\s]/g,"");return/^(978|979)?\d{9}[\dX]$/.test(s)},ed=e=>{let s={success:!0,imported:0,errors:[],warnings:[]};return e.forEach((e,t)=>{let a=ec(e);a.length>0?(s.errors.push("Row ".concat(t+2,": ").concat(a.join(", "))),s.success=!1):s.imported++}),0===s.imported&&e.length>0&&(s.success=!1),s},ex=()=>"Title,Author,ISBN,Category,Published Year,Status,Description\nThe Great Gatsby,F. Scott Fitzgerald,9780743273565,fiction,1925,available,A classic American novel\n1984,George Orwell,9780451524935,fiction,1949,available,A dystopian social science fiction novel\nTo Kill a Mockingbird,Harper Lee,9780061120084,fiction,1960,available,A novel about racial injustice";var em=e=>{let{isOpen:s,onClose:t,mode:l,onImportSuccess:n}=e,{state:i,addBook:c}=(0,V.y)(),{addNotification:o}=(0,y.z)(),[d,x]=(0,r.useState)([]),[u,h]=(0,r.useState)(null),[g,p]=(0,r.useState)(!1),b=(0,r.useRef)(null),N=async()=>{if(0===d.length)return;p(!0);let e=ed(d);if(h(e),e.success){let s=0;for(let t of d)0===e.errors.filter(e=>e.includes("Row ".concat(d.indexOf(t)+2))).length&&(c({...t,status:t.status||"AVAILABLE"}),s++);o({type:"success",title:"Import Successful",message:"Successfully imported ".concat(s," books.")}),n&&n()}else o({type:"error",title:"Import Failed",message:"Found ".concat(e.errors.length," errors. Please fix them and try again.")});p(!1)},w=e=>{let s=i.books,t=new Date().toISOString().split("T")[0];"csv"===e?er(et(s),"books-export-".concat(t,".csv"),"text/csv"):er(ea(s),"books-export-".concat(t,".json"),"application/json"),o({type:"success",title:"Export Successful",message:"Books exported as ".concat(e.toUpperCase()," file.")})};return s?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsx)("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-900",children:"import"===l?"Import Books":"Export Books"}),(0,a.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(m.Z,{className:"h-6 w-6"})})]}),"import"===l?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload File"}),(0,a.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[(0,a.jsx)(W.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"Upload a CSV or JSON file to import books"}),(0,a.jsx)("input",{ref:b,type:"file",accept:".csv,.json",onChange:e=>{var s;let t=null===(s=e.target.files)||void 0===s?void 0:s[0];if(!t)return;let a=new FileReader;a.onload=e=>{var s;let a=null===(s=e.target)||void 0===s?void 0:s.result;try{if(t.name.endsWith(".csv")){let e=en(a);x(e),h(null)}else if(t.name.endsWith(".json")){let e=JSON.parse(a);x(e),h(null)}else o({type:"error",title:"Invalid File Format",message:"Please upload a CSV or JSON file."})}catch(e){o({type:"error",title:"File Parse Error",message:"Could not parse the uploaded file. Please check the format."})}},a.readAsText(t)},className:"hidden"}),(0,a.jsx)("button",{onClick:()=>{var e;return null===(e=b.current)||void 0===e?void 0:e.click()},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Choose File"})]})]}),(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)(v.Z,{className:"h-5 w-5 text-blue-600"}),(0,a.jsx)("h3",{className:"font-medium text-blue-900",children:"Need a Template?"})]}),(0,a.jsx)("p",{className:"text-sm text-blue-700 mb-3",children:"Download our CSV template to see the correct format for importing books."}),(0,a.jsxs)("button",{onClick:()=>{er(ex(),"books-import-template.csv","text/csv"),o({type:"info",title:"Template Downloaded",message:"Import template downloaded. Use this format for importing books."})},className:"flex items-center space-x-2 text-blue-600 hover:text-blue-700 text-sm",children:[(0,a.jsx)(Q.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Download Template"})]})]}),d.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:["Import Preview (",d.length," books)"]}),(0,a.jsx)("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:(0,a.jsxs)("div",{className:"max-h-60 overflow-y-auto",children:[(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Title"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Author"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Category"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Year"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:d.slice(0,10).map((e,s)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-4 py-2 text-sm text-gray-900",children:e.title}),(0,a.jsx)("td",{className:"px-4 py-2 text-sm text-gray-900",children:e.author}),(0,a.jsx)("td",{className:"px-4 py-2 text-sm text-gray-900 capitalize",children:e.category}),(0,a.jsx)("td",{className:"px-4 py-2 text-sm text-gray-900",children:e.publishedYear})]},s))})]}),d.length>10&&(0,a.jsxs)("div",{className:"px-4 py-2 text-sm text-gray-500 text-center",children:["... and ",d.length-10," more books"]})]})})]}),u&&(0,a.jsxs)("div",{className:"border rounded-lg p-4 ".concat(u.success?"border-green-200 bg-green-50":"border-red-200 bg-red-50"),children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[u.success?(0,a.jsx)(j.Z,{className:"h-5 w-5 text-green-600"}):(0,a.jsx)(f.Z,{className:"h-5 w-5 text-red-600"}),(0,a.jsxs)("h3",{className:"font-medium ".concat(u.success?"text-green-900":"text-red-900"),children:["Import ",u.success?"Successful":"Failed"]})]}),(0,a.jsxs)("p",{className:"text-sm ".concat(u.success?"text-green-700":"text-red-700"),children:[u.imported," books imported successfully"]}),u.errors.length>0&&(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-red-700 mb-1",children:"Errors:"}),(0,a.jsxs)("ul",{className:"text-sm text-red-600 space-y-1",children:[u.errors.slice(0,5).map((e,s)=>(0,a.jsxs)("li",{children:["• ",e]},s)),u.errors.length>5&&(0,a.jsxs)("li",{children:["• ... and ",u.errors.length-5," more errors"]})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,a.jsx)("button",{onClick:t,className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),(0,a.jsx)("button",{onClick:N,disabled:0===d.length||g,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Importing...":"Import ".concat(d.length," Books")})]})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Choose Export Format"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("button",{onClick:()=>w("csv"),className:"flex items-center space-x-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50",children:[(0,a.jsx)(ee.Z,{className:"h-8 w-8 text-green-600"}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:"CSV Format"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Compatible with Excel, Google Sheets"})]})]}),(0,a.jsxs)("button",{onClick:()=>w("json"),className:"flex items-center space-x-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50",children:[(0,a.jsx)(es.Z,{className:"h-8 w-8 text-blue-600"}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:"JSON Format"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Machine-readable format"})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Export Information"}),(0,a.jsxs)("ul",{className:"text-sm text-gray-600 space-y-1",children:[(0,a.jsxs)("li",{children:["• Total books to export: ",i.books.length]}),(0,a.jsxs)("li",{children:["• Available books: ",i.books.filter(e=>"AVAILABLE"===e.status).length]}),(0,a.jsxs)("li",{children:["• Borrowed books: ",i.books.filter(e=>"BORROWED"===e.status).length]}),(0,a.jsxs)("li",{children:["• Reserved books: ",i.books.filter(e=>"RESERVED"===e.status).length]})]})]}),(0,a.jsx)("div",{className:"flex justify-end space-x-3",children:(0,a.jsx)("button",{onClick:t,className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Close"})})]})]})})}):null},eu=()=>{let{state:e,addBook:s,updateBook:t,deleteBook:n,fetchBooks:i}=(0,V.y)(),{hasPermission:c}=(0,l.a)(),{books:d,borrowings:x}=e,[u,h]=(0,r.useState)(""),[g,p]=(0,r.useState)("all"),[b,y]=(0,r.useState)("all"),[j,f]=(0,r.useState)("title"),[N,v]=(0,r.useState)(!1),[w,k]=(0,r.useState)(null),[C,S]=(0,r.useState)(null),[A,E]=(0,r.useState)("grid"),[Z,I]=(0,r.useState)([]),[T,R]=(0,r.useState)(!1),[L,P]=(0,r.useState)(!1),M=["all","fiction","non-fiction","science","history","biography","children","technology","art","philosophy"];(0,r.useEffect)(()=>{i()},[]);let O=d.filter(e=>{let s=e.title.toLowerCase().includes(u.toLowerCase())||e.author.toLowerCase().includes(u.toLowerCase())||e.isbn.toLowerCase().includes(u.toLowerCase()),t="all"===g||e.category===g,a="all"===b||e.status===b;return s&&t&&a}).sort((e,s)=>{switch(j){case"title":return e.title.localeCompare(s.title);case"author":return e.author.localeCompare(s.author);case"publishedYear":return s.publishedYear-e.publishedYear;case"category":return e.category.localeCompare(s.category);default:return 0}}),F=async e=>{try{await s(e),v(!1)}catch(e){console.error("Failed to add book:",e)}},z=async e=>{await t(e),k(null)},q=e=>{S(e)},J=async e=>{let s=d.find(s=>s.id===e),t=s?s.title:"this book";if(confirm('Are you sure you want to delete "'.concat(t,'"? This action cannot be undone.')))try{await n(e),setTimeout(()=>i(),500)}catch(e){console.error("Failed to delete book:",e)}},G=async()=>{if(0!==Z.length&&confirm("Are you sure you want to delete ".concat(Z.length," books? This action cannot be undone.")))try{for(let e of Z)await n(e);I([]),setTimeout(()=>i(),500)}catch(e){console.error("Failed to delete books:",e)}},ee=e=>{I(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},es=()=>{Z.length===O.length?I([]):I(O.map(e=>e.id))},et=e=>x.filter(s=>s.bookId===e).length;return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Book Catalog"}),(0,a.jsxs)("p",{className:"text-gray-600 mt-2",children:["Manage your library's book collection (",O.length," books)"]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[c("books:write")&&(0,a.jsxs)("button",{onClick:()=>v(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2",children:[(0,a.jsx)(U.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Add Book"})]}),(0,a.jsxs)("button",{onClick:i,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2",children:[(0,a.jsx)(Y.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Refresh"})]}),(0,a.jsxs)("button",{onClick:()=>R(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center space-x-2",children:[(0,a.jsx)(W.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Import"})]}),(0,a.jsxs)("button",{onClick:()=>P(!0),className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 flex items-center space-x-2",children:[(0,a.jsx)(Q.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Export"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(D.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Search books...",value:u,onChange:e=>h(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-transparent w-full"})]}),(0,a.jsx)("select",{value:g,onChange:e=>p(e.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600",children:M.map(e=>(0,a.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))}),(0,a.jsx)("select",{value:b,onChange:e=>y(e.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600",children:["all","AVAILABLE","BORROWED","RESERVED"].map(e=>(0,a.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))}),(0,a.jsxs)("select",{value:j,onChange:e=>f(e.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-600",children:[(0,a.jsx)("option",{value:"title",children:"Sort by Title"}),(0,a.jsx)("option",{value:"author",children:"Sort by Author"}),(0,a.jsx)("option",{value:"publishedYear",children:"Sort by Year"}),(0,a.jsx)("option",{value:"category",children:"Sort by Category"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>E("grid"),className:"p-2 rounded-lg ".concat("grid"===A?"bg-blue-100 text-blue-600":"text-gray-400 hover:text-gray-600"),children:(0,a.jsx)(H.Z,{className:"h-5 w-5"})}),(0,a.jsx)("button",{onClick:()=>E("list"),className:"p-2 rounded-lg ".concat("list"===A?"bg-blue-100 text-blue-600":"text-gray-400 hover:text-gray-600"),children:(0,a.jsx)(_.Z,{className:"h-5 w-5"})})]}),c("books:write")&&(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsxs)("button",{onClick:es,className:"flex items-center space-x-2 px-3 py-2 text-sm text-gray-600 hover:text-gray-800",children:[(0,a.jsx)(K.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Select All"})]})})]}),Z.length>0&&c("books:delete")&&(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-center justify-between mt-4",children:[(0,a.jsxs)("span",{className:"text-blue-800 font-medium",children:[Z.length," book",Z.length>1?"s":""," selected"]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:G,className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700",children:"Delete Selected"}),(0,a.jsx)("button",{onClick:()=>I([]),className:"bg-gray-600 text-white px-3 py-1 rounded text-sm hover:bg-gray-700",children:"Clear Selection"})]})]})]}),"grid"===A?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:O.map(e=>(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[c("books:delete")&&(0,a.jsx)("input",{type:"checkbox",checked:Z.includes(e.id),onChange:()=>ee(e.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,a.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,a.jsx)(B.Z,{className:"h-6 w-6 text-blue-600"})})]}),c("books:delete")&&(0,a.jsxs)("div",{className:"flex space-x-1",children:[(0,a.jsx)("button",{onClick:()=>k(e),className:"p-1 text-gray-400 hover:text-blue-600",children:(0,a.jsx)($.Z,{className:"h-4 w-4"})}),(0,a.jsx)("button",{onClick:()=>J(e.id),className:"p-1 text-gray-400 hover:text-red-600",children:(0,a.jsx)(X.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsx)("h3",{className:"font-semibold text-gray-900 mb-2 line-clamp-2",children:e.title}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:["by ",e.author]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mb-3 capitalize",children:e.category}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Published:"}),(0,a.jsx)("span",{className:"font-medium",children:e.publishedYear})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Borrowed:"}),(0,a.jsxs)("span",{className:"font-medium",children:[et(e.id)," times"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("AVAILABLE"===e.status?"bg-green-100 text-green-800":"BORROWED"===e.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:e.status.charAt(0)+e.status.slice(1).toLowerCase()}),(0,a.jsxs)("button",{onClick:()=>q(e),className:"flex items-center space-x-1 text-blue-600 hover:text-blue-700 text-sm",children:[(0,a.jsx)(o.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"View"})]})]})]})},e.id))}):(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[c("books:delete")&&(0,a.jsx)("th",{className:"px-6 py-3 text-left",children:(0,a.jsx)("input",{type:"checkbox",checked:Z.length===O.length&&O.length>0,onChange:es,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Book"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Author"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Year"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Borrowed"}),c("books:delete")&&(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:O.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[c("books:delete")&&(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("input",{type:"checkbox",checked:Z.includes(e.id),onChange:()=>ee(e.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,a.jsx)("div",{className:"h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center",children:(0,a.jsx)(B.Z,{className:"h-5 w-5 text-blue-600"})})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.title}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["ISBN: ",e.isbn]})]})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.author}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 capitalize",children:e.category}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.publishedYear}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("AVAILABLE"===e.status?"bg-green-100 text-green-800":"BORROWED"===e.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:e.status.charAt(0)+e.status.slice(1).toLowerCase()})}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[et(e.id)," times"]}),c("books:delete")&&(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>q(e),className:"text-green-600 hover:text-green-900",title:"View book details",children:(0,a.jsx)(o.Z,{className:"h-4 w-4"})}),(0,a.jsx)("button",{onClick:()=>k(e),className:"text-blue-600 hover:text-blue-900",title:"Edit book",children:(0,a.jsx)($.Z,{className:"h-4 w-4"})}),(0,a.jsx)("button",{onClick:()=>J(e.id),className:"text-red-600 hover:text-red-900",title:"Delete book",children:(0,a.jsx)(X.Z,{className:"h-4 w-4"})})]})})]},e.id))})]})})}),0===O.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(B.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No books found"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Try adjusting your search or filter criteria"})]}),N&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Add New Book"}),(0,a.jsxs)("form",{onSubmit:e=>{var s,t,a,r,l,n,i;e.preventDefault();let c=new FormData(e.target);F({title:(null===(s=c.get("title"))||void 0===s?void 0:s.toString())||"",author:(null===(t=c.get("author"))||void 0===t?void 0:t.toString())||"",isbn:(null===(a=c.get("isbn"))||void 0===a?void 0:a.toString())||"",category:(null===(r=c.get("category"))||void 0===r?void 0:r.toString())||"",publishedYear:parseInt((null===(l=c.get("publishedYear"))||void 0===l?void 0:l.toString())||"0")||new Date().getFullYear(),description:(null===(n=c.get("description"))||void 0===n?void 0:n.toString())||null,coverImage:(null===(i=c.get("coverImage"))||void 0===i?void 0:i.toString())||null})},children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("input",{name:"title",placeholder:"Book Title",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"}),(0,a.jsx)("input",{name:"author",placeholder:"Author",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"}),(0,a.jsx)("input",{name:"isbn",placeholder:"ISBN (e.g., 978-0-123456-78-9)",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"}),(0,a.jsxs)("select",{name:"category",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600",children:[(0,a.jsx)("option",{value:"",children:"Select Category"}),M.slice(1).map(e=>(0,a.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))]}),(0,a.jsx)("input",{name:"publishedYear",type:"number",placeholder:"Published Year",min:"1000",max:new Date().getFullYear()+1,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"}),(0,a.jsx)("textarea",{name:"description",placeholder:"Description",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"}),(0,a.jsx)("input",{name:"coverImage",placeholder:"Cover Image URL (optional)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,a.jsx)("button",{type:"button",onClick:()=>v(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Add Book"})]})]})]})}),w&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Edit Book"}),(0,a.jsxs)("form",{onSubmit:e=>{var s,t,a,r,l,n,i,c;e.preventDefault();let o=new FormData(e.target);z({...w,title:(null===(s=o.get("title"))||void 0===s?void 0:s.toString())||"",author:(null===(t=o.get("author"))||void 0===t?void 0:t.toString())||"",isbn:(null===(a=o.get("isbn"))||void 0===a?void 0:a.toString())||"",category:(null===(r=o.get("category"))||void 0===r?void 0:r.toString())||"",publishedYear:parseInt((null===(l=o.get("publishedYear"))||void 0===l?void 0:l.toString())||"")||new Date().getFullYear(),description:(null===(n=o.get("description"))||void 0===n?void 0:n.toString())||null,coverImage:(null===(i=o.get("coverImage"))||void 0===i?void 0:i.toString())||null,status:(null===(c=o.get("status"))||void 0===c?void 0:c.toString())||"AVAILABLE"})},children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("input",{name:"title",defaultValue:w.title,placeholder:"Book Title",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"}),(0,a.jsx)("input",{name:"author",defaultValue:w.author,placeholder:"Author",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"}),(0,a.jsx)("input",{name:"isbn",defaultValue:w.isbn,placeholder:"ISBN (e.g., 978-0-123456-78-9)",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"}),(0,a.jsx)("select",{name:"category",defaultValue:w.category,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600",children:M.slice(1).map(e=>(0,a.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))}),(0,a.jsx)("input",{name:"publishedYear",type:"number",defaultValue:w.publishedYear,placeholder:"Published Year",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"}),(0,a.jsxs)("select",{name:"status",defaultValue:w.status,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600",children:[(0,a.jsx)("option",{value:"AVAILABLE",children:"Available"}),(0,a.jsx)("option",{value:"BORROWED",children:"Borrowed"}),(0,a.jsx)("option",{value:"RESERVED",children:"Reserved"})]}),(0,a.jsx)("textarea",{name:"description",defaultValue:w.description||"",placeholder:"Description",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"}),(0,a.jsx)("input",{name:"coverImage",defaultValue:w.coverImage||"",placeholder:"Cover Image URL (optional)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,a.jsx)("button",{type:"button",onClick:()=>k(null),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Update Book"})]})]})]})}),(0,a.jsx)(em,{isOpen:T,onClose:()=>R(!1),mode:"import",onImportSuccess:()=>{i(),R(!1)}}),(0,a.jsx)(em,{isOpen:L,onClose:()=>P(!1),mode:"export"}),C&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Book Details"}),(0,a.jsx)("button",{onClick:()=>S(null),className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(m.Z,{className:"h-6 w-6"})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsx)("div",{className:"flex justify-center",children:C.coverImage?(0,a.jsx)("img",{src:C.coverImage,alt:C.title,className:"w-48 h-64 object-cover rounded-lg shadow-md"}):(0,a.jsx)("div",{className:"w-48 h-64 bg-gray-200 rounded-lg flex items-center justify-center",children:(0,a.jsx)(B.Z,{className:"h-16 w-16 text-gray-400"})})}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:C.title}),(0,a.jsxs)("p",{className:"text-gray-600",children:["by ",C.author]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"ISBN:"}),(0,a.jsx)("span",{className:"text-gray-900",children:C.isbn})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"Category:"}),(0,a.jsx)("span",{className:"text-gray-900 capitalize",children:C.category})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"Published Year:"}),(0,a.jsx)("span",{className:"text-gray-900",children:C.publishedYear})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"Status:"}),(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("AVAILABLE"===C.status?"bg-green-100 text-green-800":"BORROWED"===C.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:C.status.charAt(0)+C.status.slice(1).toLowerCase()})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"Borrowed:"}),(0,a.jsxs)("span",{className:"text-gray-900",children:[et(C.id)," times"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"Added:"}),(0,a.jsx)("span",{className:"text-gray-900",children:new Date(C.createdAt).toLocaleDateString()})]})]}),C.description&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Description:"}),(0,a.jsx)("p",{className:"text-gray-900 text-sm leading-relaxed",children:C.description})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 mt-6 pt-6 border-t border-gray-200",children:[(0,a.jsx)("button",{onClick:()=>S(null),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Close"}),c("books:update")&&(0,a.jsx)("button",{onClick:()=>{S(null),k(C)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Edit Book"})]})]})})]})},eh=t(9778),eg=t(6680),ep=t(7537),eb=t(6820),ey=t(9811),ej=t(5763),ef=t(9064),eN=()=>{var e,s,t,l;let{state:n,addMember:i,updateMember:c,deleteMember:d,fetchMembers:x}=(0,V.y)(),[u,h]=(0,r.useState)([]),[g,p]=(0,r.useState)(!1),[b,y]=(0,r.useState)(""),[N,v]=(0,r.useState)("all"),[w,k]=(0,r.useState)("all"),[S,E]=(0,r.useState)(!1),[Z,I]=(0,r.useState)(null),[T,B]=(0,r.useState)(null),[R,L]=(0,r.useState)("table"),[O,F]=(0,r.useState)(null),[z,J]=(0,r.useState)(!1),[G,W]=(0,r.useState)({name:"",email:"",phone:"",address:"",personType:"VISITOR",status:"ACTIVE",notes:"",emergencyContact:""});(0,r.useEffect)(()=>{ee(),K()},[]);let K=async()=>{try{let e=await fetch("/api/persons/stats");if(e.ok){let s=await e.json();F(s)}}catch(e){console.error("Error fetching stats:",e)}},ee=async()=>{p(!0);try{let e=await fetch("/api/persons");if(e.ok){let s=await e.json();h(s.persons||[])}else ef.default.error("Failed to fetch people data")}catch(e){console.error("Error fetching persons:",e),ef.default.error("Failed to fetch people data")}finally{p(!1)}},es=(u||[]).filter(e=>{let s=e.name.toLowerCase().includes(b.toLowerCase())||e.email.toLowerCase().includes(b.toLowerCase())||e.phone&&e.phone.includes(b),t="all"===N||e.personType===N,a="all"===w||e.status===w;return s&&t&&a}),et=async e=>{e.preventDefault(),p(!0);try{let e=await fetch("/api/persons",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(G)});if(e.ok)ef.default.success("Person added successfully!"),W({name:"",email:"",phone:"",address:"",personType:"VISITOR",status:"ACTIVE",notes:"",emergencyContact:""}),E(!1),ee();else{let s=await e.json();ef.default.error(s.error||"Failed to add person")}}catch(e){console.error("Error adding person:",e),ef.default.error("Failed to add person")}finally{p(!1)}},ea=async e=>{if(e.preventDefault(),Z){p(!0);try{let e=await fetch("/api/persons/".concat(Z.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Z)});if(e.ok)ef.default.success("Person updated successfully!"),I(null),ee();else{let s=await e.json();ef.default.error(s.error||"Failed to update person")}}catch(e){console.error("Error updating person:",e),ef.default.error("Failed to update person")}finally{p(!1)}}},er=async e=>{if(confirm("Are you sure you want to delete this person?")){p(!0);try{let s=await fetch("/api/persons/".concat(e),{method:"DELETE"});if(s.ok)ef.default.success("Person deleted successfully!"),ee();else{let e=await s.json();ef.default.error(e.error||"Failed to delete person")}}catch(e){console.error("Error deleting person:",e),ef.default.error("Failed to delete person")}finally{p(!1)}}},el=e=>{switch(e){case"ACTIVE":return"bg-green-100 text-green-800";case"INACTIVE":default:return"bg-gray-100 text-gray-800";case"BANNED":return"bg-red-100 text-red-800";case"SUSPENDED":return"bg-yellow-100 text-yellow-800"}},en=e=>{switch(e){case"MEMBER":return"bg-blue-100 text-blue-800";case"VISITOR":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-center gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl lg:text-3xl font-bold text-gray-900",children:"People Management"}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:"Manage library members and visitors"})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,a.jsxs)("button",{onClick:ee,disabled:g,className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2 w-full sm:w-auto justify-center",children:[g?(0,a.jsx)(Y.Z,{className:"h-5 w-5 animate-spin"}):(0,a.jsx)(Y.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Refresh"})]}),(0,a.jsxs)("button",{onClick:()=>J(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center space-x-2 w-full sm:w-auto justify-center",children:[(0,a.jsx)(P.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Statistics"})]}),(0,a.jsxs)("button",{onClick:()=>E(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2 w-full sm:w-auto justify-center",children:[(0,a.jsx)(U.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Add Person"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white p-4 lg:p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsx)("div",{className:"lg:col-span-1",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(D.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),(0,a.jsx)("input",{type:"text",placeholder:"Search people...",value:b,onChange:e=>y(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})]})}),(0,a.jsx)("div",{children:(0,a.jsx)("select",{value:N,onChange:e=>v(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",children:["all","MEMBER","VISITOR"].map(e=>(0,a.jsx)("option",{value:e,children:"all"===e?"All Types":e},e))})}),(0,a.jsx)("div",{children:(0,a.jsx)("select",{value:w,onChange:e=>k(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",children:["all","ACTIVE","INACTIVE","BANNED","SUSPENDED"].map(e=>(0,a.jsx)("option",{value:e,children:"all"===e?"All Statuses":e},e))})})]}),(0,a.jsx)("div",{className:"flex justify-end mt-4",children:(0,a.jsxs)("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[(0,a.jsxs)("button",{onClick:()=>L("table"),className:"px-3 py-1 rounded-md flex items-center space-x-2 text-sm ".concat("table"===R?"bg-white text-gray-900 shadow-sm":"text-gray-600"),children:[(0,a.jsx)(_.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Table"})]}),(0,a.jsxs)("button",{onClick:()=>L("cards"),className:"px-3 py-1 rounded-md flex items-center space-x-2 text-sm ".concat("cards"===R?"bg-white text-gray-900 shadow-sm":"text-gray-600"),children:[(0,a.jsx)(H.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Cards"})]})]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsx)("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,a.jsx)(C.Z,{className:"h-6 w-6 text-blue-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total People"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:(u||[]).length}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"All registered"})]})]})}),(0,a.jsx)("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,a.jsx)(j.Z,{className:"h-6 w-6 text-green-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Active"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:(u||[]).filter(e=>"ACTIVE"===e.status).length}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[((u||[]).filter(e=>"ACTIVE"===e.status).length/Math.max((u||[]).length,1)*100).toFixed(1),"%"]})]})]})}),(0,a.jsx)("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,a.jsx)(eh.Z,{className:"h-6 w-6 text-purple-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Members"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:(u||[]).filter(e=>"MEMBER"===e.personType).length}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[((u||[]).filter(e=>"MEMBER"===e.personType).length/Math.max((u||[]).length,1)*100).toFixed(1),"%"]})]})]})}),(0,a.jsx)("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-orange-100 rounded-lg",children:(0,a.jsx)(C.Z,{className:"h-6 w-6 text-orange-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Visitors"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:(u||[]).filter(e=>"VISITOR"===e.personType).length}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[((u||[]).filter(e=>"VISITOR"===e.personType).length/Math.max((u||[]).length,1)*100).toFixed(1),"%"]})]})]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsx)("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-gray-100 rounded-lg",children:(0,a.jsx)(eg.Z,{className:"h-6 w-6 text-gray-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Inactive"}),(0,a.jsx)("p",{className:"text-xl font-bold text-gray-900",children:(u||[]).filter(e=>"INACTIVE"===e.status).length})]})]})}),(0,a.jsx)("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-red-100 rounded-lg",children:(0,a.jsx)(ep.Z,{className:"h-6 w-6 text-red-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Banned"}),(0,a.jsx)("p",{className:"text-xl font-bold text-gray-900",children:(u||[]).filter(e=>"BANNED"===e.status).length})]})]})}),(0,a.jsx)("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-yellow-100 rounded-lg",children:(0,a.jsx)(eb.Z,{className:"h-6 w-6 text-yellow-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Suspended"}),(0,a.jsx)("p",{className:"text-xl font-bold text-gray-900",children:(u||[]).filter(e=>"SUSPENDED"===e.status).length})]})]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[g?(0,a.jsxs)("div",{className:"flex items-center justify-center h-64",children:[(0,a.jsx)(Y.Z,{className:"h-8 w-8 animate-spin text-blue-600"}),(0,a.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading people..."})]}):"table"===R?(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Person"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:es.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,a.jsx)("div",{className:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center",children:(0,a.jsx)(C.Z,{className:"h-5 w-5 text-gray-600"})})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.email})]})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(en(e.personType)),children:e.personType})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(el(e.status)),children:e.status})}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[e.phone&&(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(ey.Z,{className:"h-4 w-4 mr-1"}),e.phone]}),e.address&&(0,a.jsxs)("div",{className:"flex items-center mt-1",children:[(0,a.jsx)(ej.Z,{className:"h-4 w-4 mr-1"}),(0,a.jsx)("span",{className:"truncate max-w-32",children:e.address})]})]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>B(e),className:"text-blue-600 hover:text-blue-900",children:(0,a.jsx)(o.Z,{className:"h-4 w-4"})}),(0,a.jsx)("button",{onClick:()=>I(e),className:"text-indigo-600 hover:text-indigo-900",children:(0,a.jsx)($.Z,{className:"h-4 w-4"})}),(0,a.jsx)("button",{onClick:()=>er(e.id),className:"text-red-600 hover:text-red-900",children:(0,a.jsx)(X.Z,{className:"h-4 w-4"})})]})})]},e.id))})]})}):(0,a.jsx)("div",{className:"p-4 lg:p-6",children:(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:es.map(e=>(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 hover:bg-gray-100 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center",children:(0,a.jsx)(C.Z,{className:"h-5 w-5 text-gray-600"})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:e.email})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("button",{onClick:()=>B(e),className:"text-blue-600 hover:text-blue-900",children:(0,a.jsx)(o.Z,{className:"h-4 w-4"})}),(0,a.jsx)("button",{onClick:()=>I(e),className:"text-indigo-600 hover:text-indigo-900",children:(0,a.jsx)($.Z,{className:"h-4 w-4"})}),(0,a.jsx)("button",{onClick:()=>er(e.id),className:"text-red-600 hover:text-red-900",children:(0,a.jsx)(X.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"mt-3 flex flex-wrap gap-2",children:[(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(en(e.personType)),children:e.personType}),(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(el(e.status)),children:e.status})]}),e.phone&&(0,a.jsxs)("div",{className:"mt-2 flex items-center text-sm text-gray-500",children:[(0,a.jsx)(ey.Z,{className:"h-4 w-4 mr-1"}),e.phone]})]},e.id))})}),0===es.length&&!g&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(C.Z,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,a.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No people found"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:b||"all"!==N||"all"!==w?"Try adjusting your search or filters.":"Get started by adding a new person."})]})]}),S&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsx)("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Add New Person"}),(0,a.jsxs)("form",{onSubmit:et,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name *"}),(0,a.jsx)("input",{type:"text",required:!0,value:G.name,onChange:e=>W({...G,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),(0,a.jsx)("input",{type:"email",required:!0,value:G.email,onChange:e=>W({...G,email:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),(0,a.jsx)("input",{type:"tel",value:G.phone,onChange:e=>W({...G,phone:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),(0,a.jsx)("textarea",{value:G.address,onChange:e=>W({...G,address:e.target.value}),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Person Type *"}),(0,a.jsxs)("select",{required:!0,value:G.personType,onChange:e=>W({...G,personType:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",children:[(0,a.jsx)("option",{value:"VISITOR",children:"Visitor"}),(0,a.jsx)("option",{value:"MEMBER",children:"Member"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,a.jsxs)("select",{value:G.status,onChange:e=>W({...G,status:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",children:[(0,a.jsx)("option",{value:"ACTIVE",children:"Active"}),(0,a.jsx)("option",{value:"INACTIVE",children:"Inactive"}),(0,a.jsx)("option",{value:"BANNED",children:"Banned"}),(0,a.jsx)("option",{value:"SUSPENDED",children:"Suspended"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),(0,a.jsx)("textarea",{value:G.notes,onChange:e=>W({...G,notes:e.target.value}),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Emergency Contact"}),(0,a.jsx)("input",{type:"text",value:G.emergencyContact,onChange:e=>W({...G,emergencyContact:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,a.jsx)("button",{type:"button",onClick:()=>E(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:g,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg",children:g?"Adding...":"Add Person"})]})]})]})})}),Z&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsx)("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Edit Person"}),(0,a.jsxs)("form",{onSubmit:ea,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name *"}),(0,a.jsx)("input",{type:"text",required:!0,value:Z.name,onChange:e=>I({...Z,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),(0,a.jsx)("input",{type:"email",required:!0,value:Z.email,onChange:e=>I({...Z,email:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),(0,a.jsx)("input",{type:"tel",value:Z.phone||"",onChange:e=>I({...Z,phone:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),(0,a.jsx)("textarea",{value:Z.address||"",onChange:e=>I({...Z,address:e.target.value}),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Person Type *"}),(0,a.jsxs)("select",{required:!0,value:Z.personType,onChange:e=>I({...Z,personType:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",children:[(0,a.jsx)("option",{value:"VISITOR",children:"Visitor"}),(0,a.jsx)("option",{value:"MEMBER",children:"Member"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,a.jsxs)("select",{value:Z.status,onChange:e=>I({...Z,status:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",children:[(0,a.jsx)("option",{value:"ACTIVE",children:"Active"}),(0,a.jsx)("option",{value:"INACTIVE",children:"Inactive"}),(0,a.jsx)("option",{value:"BANNED",children:"Banned"}),(0,a.jsx)("option",{value:"SUSPENDED",children:"Suspended"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),(0,a.jsx)("textarea",{value:Z.notes||"",onChange:e=>I({...Z,notes:e.target.value}),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Emergency Contact"}),(0,a.jsx)("input",{type:"text",value:Z.emergencyContact||"",onChange:e=>I({...Z,emergencyContact:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,a.jsx)("button",{type:"button",onClick:()=>I(null),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:g,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg",children:g?"Updating...":"Update Person"})]})]})]})})}),T&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsx)("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Person Details"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:T.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:T.email})]}),T.phone&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:T.phone})]}),T.address&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:T.address})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Person Type"}),(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(en(T.personType)),children:T.personType})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(el(T.status)),children:T.status})]}),T.notes&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Notes"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:T.notes})]}),T.emergencyContact&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Emergency Contact"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:T.emergencyContact})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Created"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:new Date(T.createdAt).toLocaleDateString()})]})]}),(0,a.jsx)("div",{className:"flex justify-end pt-4",children:(0,a.jsx)("button",{onClick:()=>B(null),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg",children:"Close"})})]})})}),z&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsx)("div",{className:"bg-white rounded-lg max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"People Analytics Dashboard"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Comprehensive statistics and insights"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("button",{onClick:()=>{let e=new Blob([JSON.stringify(O,null,2)],{type:"application/json"}),s=URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download="people-statistics-".concat(new Date().toISOString().split("T")[0],".json"),t.click(),URL.revokeObjectURL(s),ef.default.success("Statistics exported successfully!")},className:"bg-green-600 text-white px-3 py-2 rounded-lg hover:bg-green-700 flex items-center space-x-2",children:[(0,a.jsx)(Q.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Export"})]}),(0,a.jsx)("button",{onClick:()=>J(!1),className:"text-gray-400 hover:text-gray-600 p-2",children:(0,a.jsx)(m.Z,{className:"h-6 w-6"})})]})]}),O&&(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 p-6 rounded-xl border border-blue-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-blue-600",children:"Total People"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-blue-900",children:O.overview.totalPeople}),(0,a.jsx)("p",{className:"text-xs text-blue-700 mt-1",children:"All registered"})]}),(0,a.jsx)(C.Z,{className:"h-12 w-12 text-blue-600 opacity-80"})]})}),(0,a.jsx)("div",{className:"bg-gradient-to-r from-green-50 to-green-100 p-6 rounded-xl border border-green-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-green-600",children:"Active"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-green-900",children:O.overview.activePeople}),(0,a.jsxs)("p",{className:"text-xs text-green-700 mt-1",children:[(O.overview.activePeople/Math.max(O.overview.totalPeople,1)*100).toFixed(1),"% of total"]})]}),(0,a.jsx)(j.Z,{className:"h-12 w-12 text-green-600 opacity-80"})]})}),(0,a.jsx)("div",{className:"bg-gradient-to-r from-purple-50 to-purple-100 p-6 rounded-xl border border-purple-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-purple-600",children:"Members"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-purple-900",children:O.overview.totalMembers}),(0,a.jsxs)("p",{className:"text-xs text-purple-700 mt-1",children:[(O.overview.totalMembers/Math.max(O.overview.totalPeople,1)*100).toFixed(1),"% of total"]})]}),(0,a.jsx)(eh.Z,{className:"h-12 w-12 text-purple-600 opacity-80"})]})}),(0,a.jsx)("div",{className:"bg-gradient-to-r from-orange-50 to-orange-100 p-6 rounded-xl border border-orange-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-orange-600",children:"Visitors"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-orange-900",children:O.overview.totalVisitors}),(0,a.jsxs)("p",{className:"text-xs text-orange-700 mt-1",children:[(O.overview.totalVisitors/Math.max(O.overview.totalPeople,1)*100).toFixed(1),"% of total"]})]}),(0,a.jsx)(C.Z,{className:"h-12 w-12 text-orange-600 opacity-80"})]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,a.jsx)(P.Z,{className:"h-5 w-5 mr-2 text-blue-600"}),"Person Types Distribution"]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-4 h-4 bg-purple-500 rounded-full mr-3"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Members"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("span",{className:"text-lg font-bold text-gray-900",children:O.overview.totalMembers}),(0,a.jsx)("div",{className:"w-32 bg-gray-200 rounded-full h-2 mt-1",children:(0,a.jsx)("div",{className:"bg-purple-500 h-2 rounded-full",style:{width:"".concat(O.overview.totalMembers/Math.max(O.overview.totalPeople,1)*100,"%")}})})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-4 h-4 bg-orange-500 rounded-full mr-3"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Visitors"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("span",{className:"text-lg font-bold text-gray-900",children:O.overview.totalVisitors}),(0,a.jsx)("div",{className:"w-32 bg-gray-200 rounded-full h-2 mt-1",children:(0,a.jsx)("div",{className:"bg-orange-500 h-2 rounded-full",style:{width:"".concat(O.overview.totalVisitors/Math.max(O.overview.totalPeople,1)*100,"%")}})})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,a.jsx)(f.Z,{className:"h-5 w-5 mr-2 text-green-600"}),"Status Breakdown"]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(j.Z,{className:"h-4 w-4 text-green-600 mr-3"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Active"})]}),(0,a.jsx)("span",{className:"text-lg font-bold text-green-600",children:O.overview.activePeople})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(eg.Z,{className:"h-4 w-4 text-gray-600 mr-3"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Inactive"})]}),(0,a.jsx)("span",{className:"text-lg font-bold text-gray-600",children:O.overview.inactivePeople})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(ep.Z,{className:"h-4 w-4 text-red-600 mr-3"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Banned"})]}),(0,a.jsx)("span",{className:"text-lg font-bold text-red-600",children:O.overview.bannedPeople||0})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(eb.Z,{className:"h-4 w-4 text-yellow-600 mr-3"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Suspended"})]}),(0,a.jsx)("span",{className:"text-lg font-bold text-yellow-600",children:O.overview.suspendedPeople||0})]})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,a.jsx)(q.Z,{className:"h-5 w-5 mr-2 text-blue-600"}),"Recent Activity"]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(M.Z,{className:"h-4 w-4 text-blue-600 mr-3"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"New people (last 30 days)"})]}),(0,a.jsx)("span",{className:"text-xl font-bold text-blue-600",children:O.overview.recentPeople})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(A.Z,{className:"h-4 w-4 text-green-600 mr-3"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Growth rate"})]}),(0,a.jsxs)("span",{className:"text-xl font-bold text-green-600",children:[O.overview.totalPeople>0?(O.overview.recentPeople/O.overview.totalPeople*100).toFixed(1):0,"%"]})]})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,a.jsx)(P.Z,{className:"h-5 w-5 mr-2 text-purple-600"}),"Quick Insights"]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("div",{className:"p-3 bg-gray-50 rounded-lg",children:(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,a.jsx)("strong",{children:"Member Conversion Rate:"})," ",(null===(e=O.insights)||void 0===e?void 0:e.memberConversionRate)||0,"%"]})}),(0,a.jsx)("div",{className:"p-3 bg-gray-50 rounded-lg",children:(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,a.jsx)("strong",{children:"Active Rate:"})," ",(null===(s=O.insights)||void 0===s?void 0:s.activeRate)||0,"%"]})}),(0,a.jsx)("div",{className:"p-3 bg-gray-50 rounded-lg",children:(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,a.jsx)("strong",{children:"Average Daily Registrations:"})," ",(null===(t=O.insights)||void 0===t?void 0:t.averageDailyRegistrations)||0," people/day"]})}),(0,a.jsx)("div",{className:"p-3 bg-gray-50 rounded-lg",children:(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,a.jsx)("strong",{children:"Growth Rate (30 days):"})," ",(null===(l=O.insights)||void 0===l?void 0:l.growthRate)||0,"%"]})})]})]})]})]})]})})})]})},ev=()=>{let{state:e,borrowBook:s,returnBook:t,fetchBooks:l,fetchMembers:n,fetchBorrowings:i}=(0,V.y)(),{books:c,members:o,borrowings:d}=e,[x,m]=(0,r.useState)(""),[u,h]=(0,r.useState)(!1);(0,r.useEffect)(()=>{l(),n(),i()},[]);let g=d.filter(e=>"BORROWED"===e.status),p=g.filter(e=>new Date(e.dueDate)<new Date),b=g.filter(e=>{let s=c.find(s=>s.id===e.bookId),t=o.find(s=>s.id===(e.memberId||e.personId));if(!x)return!0;let a=x.toLowerCase();return(null==s?void 0:s.title.toLowerCase().includes(a))||(null==s?void 0:s.author.toLowerCase().includes(a))||(null==t?void 0:t.name.toLowerCase().includes(a))||(null==t?void 0:t.email.toLowerCase().includes(a))||e.id.toLowerCase().includes(a)}),y=e=>{let t=new Date;t.setDate(t.getDate()+14),console.log("Borrowing data:",e);let a={bookId:e.bookId,personId:e.personId,memberId:e.memberId,dueDate:t.toISOString()};console.log("Borrowing payload:",a),s(a),h(!1)},f=e=>{t(e)};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Borrowing System"}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:"Manage book loans and returns"})]}),(0,a.jsxs)("button",{onClick:()=>h(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2",children:[(0,a.jsx)(U.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"New Loan"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-3 bg-blue-100 rounded-lg",children:(0,a.jsx)(R.Z,{className:"h-6 w-6 text-blue-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Active Loans"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:g.length})]})]})}),(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-3 bg-red-100 rounded-lg",children:(0,a.jsx)(N.Z,{className:"h-6 w-6 text-red-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Overdue"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:p.length})]})]})}),(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-3 bg-green-100 rounded-lg",children:(0,a.jsx)(j.Z,{className:"h-6 w-6 text-green-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Available Books"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:c.filter(e=>"AVAILABLE"===e.status).length})]})]})})]}),(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(D.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Search by book title, member name, or loan ID...",value:x,onChange:e=>m(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-transparent w-full"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Book"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Member"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Borrow Date"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Due Date"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:b.map(e=>{let s=c.find(s=>s.id===e.bookId),t=o.find(s=>s.id===(e.memberId||e.personId)),r=new Date(e.dueDate)<new Date;return(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:null==s?void 0:s.title}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["by ",null==s?void 0:s.author]})]}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,a.jsx)("div",{className:"text-sm text-gray-900",children:null==t?void 0:t.name}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:null==t?void 0:t.email})]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(e.borrowDate).toLocaleDateString()}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,a.jsx)("div",{className:"text-sm ".concat(r?"text-red-600 font-medium":"text-gray-900"),children:new Date(e.dueDate).toLocaleDateString()}),r&&(0,a.jsxs)("div",{className:"text-xs text-red-500 flex items-center",children:[(0,a.jsx)(A.Z,{className:"h-3 w-3 mr-1"}),"Overdue"]})]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(r?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:r?"Overdue":"Borrowed"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,a.jsx)("button",{onClick:()=>f(e.id),className:"text-green-600 hover:text-green-900",children:"Return"})})]},e.id)})})]})})}),0===g.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(R.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No active loans"}),(0,a.jsx)("p",{className:"text-gray-600",children:"All books are currently available"})]}),g.length>0&&0===b.length&&x&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(D.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No loans found"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Try adjusting your search criteria"})]}),u&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Borrow Book"}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault();let s=new FormData(e.target);y({bookId:s.get("bookId"),personId:s.get("personId")})},children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("select",{name:"bookId",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600",children:[(0,a.jsx)("option",{value:"",children:"Select Book"}),c.filter(e=>"AVAILABLE"===e.status).map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.title," by ",e.author]},e.id))]}),(0,a.jsxs)("select",{name:"personId",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600",children:[(0,a.jsx)("option",{value:"",children:"Select Member"}),o.filter(e=>"ACTIVE"===e.status).map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," (",e.email,")"]},e.id))]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,a.jsx)("button",{type:"button",onClick:()=>h(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Borrow Book"})]})]})]})})]})},ew=t(5043);let ek=e=>{let{onSubmit:s,onClose:t}=e;return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Add Person & Check In"}),(0,a.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(U.Z,{className:"h-6 w-6 transform rotate-45"})})]}),(0,a.jsxs)("form",{onSubmit:e=>{var t,a,r,l,n,i;e.preventDefault();let c=new FormData(e.target),o={name:(null===(t=c.get("name"))||void 0===t?void 0:t.toString())||"",email:(null===(a=c.get("email"))||void 0===a?void 0:a.toString())||"",phone:(null===(r=c.get("phone"))||void 0===r?void 0:r.toString())||"",address:(null===(l=c.get("address"))||void 0===l?void 0:l.toString())||"",personType:(null===(n=c.get("personType"))||void 0===n?void 0:n.toString())||"VISITOR",notes:(null===(i=c.get("notes"))||void 0===i?void 0:i.toString())||""};if(!o.name||!o.email){ef.default.error("Name and email are required");return}s(o)},children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name *"}),(0,a.jsx)("input",{name:"name",type:"text",required:!0,placeholder:"Enter person's full name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address *"}),(0,a.jsx)("input",{name:"email",type:"email",required:!0,placeholder:"Enter person's email",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),(0,a.jsx)("input",{name:"phone",type:"tel",placeholder:"Enter phone number (optional)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Person Type"}),(0,a.jsxs)("select",{name:"personType",defaultValue:"VISITOR",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600",children:[(0,a.jsx)("option",{value:"VISITOR",children:"Visitor"}),(0,a.jsx)("option",{value:"MEMBER",children:"Member"}),(0,a.jsx)("option",{value:"STUDENT",children:"Student"}),(0,a.jsx)("option",{value:"VIP",children:"VIP"}),(0,a.jsx)("option",{value:"STAFF",children:"Staff"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),(0,a.jsx)("textarea",{name:"address",placeholder:"Enter address (optional)",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,a.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),(0,a.jsxs)("button",{type:"submit",className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[(0,a.jsx)(ew.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Add & Check In"})]})]})]})]})})};var eC=()=>{let{hasPermission:e}=(0,l.a)(),[s,t]=(0,r.useState)([]),[n,i]=(0,r.useState)([]),[c,o]=(0,r.useState)(!1),[d,x]=(0,r.useState)(""),[m,u]=(0,r.useState)(new Date().toISOString().split("T")[0]),[h,g]=(0,r.useState)(!1);if(!e("manage_attendance"))return(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(f.Z,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),(0,a.jsx)("p",{className:"text-gray-600",children:"You need librarian privileges to access attendance management."})]})});(0,r.useEffect)(()=>{b(),y()},[m]);let b=async()=>{try{o(!0);let e=localStorage.getItem("token"),s=await fetch("/api/persons?limit=100",{headers:{Authorization:"Bearer ".concat(e)}});if(s.ok){let e=await s.json();t(e.persons||[])}else ef.default.error("Failed to fetch persons")}catch(e){console.error("Error fetching persons:",e),ef.default.error("Failed to fetch persons")}finally{o(!1)}},y=async()=>{try{let e=localStorage.getItem("token"),s=await fetch("/api/attendance?date=".concat(m,"&limit=100"),{headers:{Authorization:"Bearer ".concat(e)}});if(s.ok){let e=await s.json();i(e.attendance||[])}else ef.default.error("Failed to fetch attendance records")}catch(e){console.error("Error fetching attendance:",e),ef.default.error("Failed to fetch attendance records")}},j=async e=>{try{let s=localStorage.getItem("token"),t=await fetch("/api/attendance",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify({action:"check-in",personId:e})});if(t.ok)ef.default.success("Person checked in successfully!"),y();else{let e=await t.json();ef.default.error(e.error||"Failed to check in person")}}catch(e){console.error("Error checking in person:",e),ef.default.error("Failed to check in person")}},N=async e=>{try{let s=localStorage.getItem("token"),t=await fetch("/api/attendance",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify({action:"check-out",personId:e.personId})});if(t.ok)ef.default.success("Check-out successful!"),y();else{let e=await t.json();ef.default.error(e.error||"Failed to check out")}}catch(e){console.error("Error checking out:",e),ef.default.error("Failed to check out")}},v=async e=>{try{let a=localStorage.getItem("token"),r=await fetch("/api/persons",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify(e)});if(r.ok){let e=await r.json();t([e,...s]),g(!1),ef.default.success("Person added successfully!"),j(e.id)}else{let e=await r.json();ef.default.error(e.error||"Failed to add person")}}catch(e){console.error("Error adding person:",e),ef.default.error("Failed to add person")}},w=s.filter(e=>e.name.toLowerCase().includes(d.toLowerCase())||e.email.toLowerCase().includes(d.toLowerCase())||e.phone&&e.phone.includes(d)),k=e=>n.find(s=>s.personId===e&&!s.checkOutTime),S=e=>new Date(e).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),E=(e,s)=>{let t=new Date(e),a=(s?new Date(s):new Date).getTime()-t.getTime();return"".concat(Math.floor(a/36e5),"h ").concat(Math.floor(a%36e5/6e4),"m")},Z=e=>{switch(e){case"MEMBER":return"bg-blue-100 text-blue-800";case"VISITOR":return"bg-green-100 text-green-800";case"VIP":return"bg-purple-100 text-purple-800";case"STUDENT":return"bg-yellow-100 text-yellow-800";case"STAFF":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-4xl font-bold text-gray-900",children:"\uD83D\uDCCB Daily Attendance System"}),(0,a.jsx)("p",{className:"text-lg text-gray-600 mt-2",children:"Search, Sign In & Sign Out Library Visitors"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("input",{type:"date",value:m,onChange:e=>u(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"}),(0,a.jsxs)("button",{onClick:()=>g(!0),className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[(0,a.jsx)(eh.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Add Person"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,a.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"\uD83D\uDC65 Search & Sign In People"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-sm font-semibold text-blue-600 bg-blue-50 px-3 py-1 rounded-lg",children:[(0,a.jsx)(C.Z,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:[w.length," registered people"]})]})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(D.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,a.jsx)("input",{type:"text",placeholder:"Search by name, email, or phone...",value:d,onChange:e=>x(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"})]})]}),(0,a.jsx)("div",{className:"max-h-80 overflow-y-auto border-t border-gray-100 scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100",children:c?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:"Loading people..."})]}):0===d.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(D.Z,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Start typing to search for people"}),(0,a.jsx)("p",{className:"text-gray-500",children:"Type a person's name, email, or phone number to find them and sign them in"})]}):(0,a.jsxs)("div",{children:[w.length>5&&(0,a.jsxs)("div",{className:"bg-blue-50 px-4 py-2 text-sm text-blue-700 font-medium border-b border-blue-100",children:["\uD83D\uDCDD Found ",w.length," people - scroll to see all results"]}),(0,a.jsxs)("div",{className:"divide-y divide-gray-200",children:[w.map(e=>{let s=k(e.id),t=!!s;return(0,a.jsx)("div",{className:"p-4 hover:bg-gray-50",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,a.jsx)("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:(0,a.jsx)(C.Z,{className:"h-5 w-5 text-blue-600"})})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-lg font-bold text-gray-900 mb-1",children:e.name}),(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:e.email}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-lg text-xs font-semibold ".concat(Z(e.personType)," border"),children:e.personType}),e.libraryId&&(0,a.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-mono font-semibold bg-gray-100 text-gray-800 border",children:["ID: ",e.libraryId]})]})]})]}),(0,a.jsx)("div",{className:"flex items-center space-x-3",children:t?(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)("div",{className:"inline-flex items-center px-3 py-2 rounded-lg text-sm font-semibold bg-green-100 text-green-800 border border-green-200",children:[(0,a.jsx)(A.Z,{className:"h-4 w-4 mr-2"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-bold",children:"CHECKED IN"}),(0,a.jsxs)("div",{className:"text-xs",children:["at ",S(s.checkInTime)]})]})]})}),(0,a.jsxs)("button",{onClick:()=>N(s),className:"flex items-center space-x-2 px-4 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 text-sm font-semibold shadow-md transition-all duration-200 hover:shadow-lg",children:[(0,a.jsx)(p.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"SIGN OUT"})]})]}):(0,a.jsxs)("button",{onClick:()=>j(e.id),className:"flex items-center space-x-2 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm font-semibold shadow-md transition-all duration-200 hover:shadow-lg",children:[(0,a.jsx)(ew.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"SIGN IN"})]})})]})},e.id)}),d.length>0&&0===w.length&&(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(C.Z,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-700 mb-2",children:"No people found"}),(0,a.jsxs)("p",{className:"text-gray-500 mb-4",children:['No one matches "',d,'"']}),(0,a.jsxs)("button",{onClick:()=>g(!0),className:"inline-flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm font-semibold",children:[(0,a.jsx)(eh.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Add New Person"})]})]})]})]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,a.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold text-gray-900",children:["\uD83D\uDD50 ",m===new Date().toISOString().split("T")[0]?"Today's Attendance":"Daily Attendance"]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-sm font-semibold text-green-600 bg-green-50 px-3 py-1 rounded-lg",children:[(0,a.jsx)(L.Z,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:[n.length," total visits"]})]})]})}),(0,a.jsx)("div",{className:"max-h-96 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100",children:0===n.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(M.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No attendance records"}),(0,a.jsx)("p",{className:"text-gray-600",children:"No one has visited the library on this date"})]}):(0,a.jsxs)("div",{children:[n.length>5&&(0,a.jsxs)("div",{className:"bg-green-50 px-4 py-2 text-sm text-green-700 font-medium border-b border-green-100",children:["\uD83D\uDCCB ",n.length," total visits today - scroll to see all records"]}),(0,a.jsx)("div",{className:"divide-y divide-gray-200",children:n.map(e=>{var s,t,r;return(0,a.jsx)("div",{className:"p-4 hover:bg-gray-50",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,a.jsx)("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:(0,a.jsx)(C.Z,{className:"h-5 w-5 text-blue-600"})})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-lg font-bold text-gray-900 mb-1",children:(null===(s=e.person)||void 0===s?void 0:s.name)||"Unknown Person"}),(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:(null===(t=e.person)||void 0===t?void 0:t.email)||"No email"}),(null===(r=e.person)||void 0===r?void 0:r.libraryId)&&(0,a.jsxs)("div",{className:"text-xs font-mono font-semibold text-blue-600 mb-2",children:["Library ID: ",e.person.libraryId]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 text-sm font-medium text-gray-700 bg-gray-50 px-3 py-2 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-green-600 font-semibold",children:"IN:"}),(0,a.jsx)("span",{className:"ml-1",children:S(e.checkInTime)})]}),e.checkOutTime&&(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-red-600 font-semibold",children:"OUT:"}),(0,a.jsx)("span",{className:"ml-1",children:S(e.checkOutTime)})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-blue-600 font-semibold",children:"TIME:"}),(0,a.jsx)("span",{className:"ml-1",children:E(e.checkInTime,e.checkOutTime)})]})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[e.person&&(0,a.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-lg text-xs font-semibold ".concat(Z(e.person.personType)," border"),children:e.person.personType}),!e.checkOutTime&&(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-lg text-xs font-semibold bg-green-100 text-green-800 border border-green-200",children:"✓ CURRENTLY IN LIBRARY"}),(0,a.jsxs)("button",{onClick:()=>N(e),className:"flex items-center space-x-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 text-sm font-semibold shadow-md transition-all duration-200 hover:shadow-lg",children:[(0,a.jsx)(p.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"SIGN OUT"})]})]}),e.checkOutTime&&(0,a.jsx)("span",{className:"inline-flex items-center px-3 py-2 rounded-lg text-sm font-semibold bg-gray-100 text-gray-800 border border-gray-200",children:"✓ VISIT COMPLETED"})]})]})},e.id)})})]})})]})]}),h&&(0,a.jsx)(ek,{onSubmit:v,onClose:()=>g(!1)})]})},eS=t(65),eD=t(512),eA=t(5534),eE=()=>{var e,s,t;let{hasPermission:n}=(0,l.a)(),[i,c]=(0,r.useState)(null),[o,d]=(0,r.useState)(!1),[x,m]=(0,r.useState)("week"),[u,h]=(0,r.useState)(""),[g,p]=(0,r.useState)("");if(!n("attendance:read"))return(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(f.Z,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),(0,a.jsx)("p",{className:"text-gray-600",children:"You need appropriate privileges to view attendance analytics."})]})});(0,r.useEffect)(()=>{b()},[x]);let b=async()=>{try{d(!0);let e=localStorage.getItem("token"),s="/api/attendance/stats?period=".concat(x);u&&g&&(s+="&startDate=".concat(u,"&endDate=").concat(g));let t=await fetch(s,{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();c(e)}else ef.default.error("Failed to fetch attendance statistics")}catch(e){console.error("Error fetching attendance stats:",e),ef.default.error("Failed to fetch attendance statistics")}finally{d(!1)}},y=async e=>{ef.default.success("Exporting ".concat(e.toUpperCase()," report..."))},j=e=>{let s=Math.floor(e/60),t=e%60;return s>0?"".concat(s,"h ").concat(t,"m"):"".concat(t,"m")},N=()=>(null==i?void 0:i.hourlyStats)?Object.entries(i.hourlyStats).map(e=>{let[s,t]=e;return{hour:parseInt(s),count:t,timeSlot:"".concat(s,":00 - ").concat(parseInt(s)+1,":00")}}).sort((e,s)=>s.count-e.count).slice(0,5):[],v=()=>(null==i?void 0:i.dailyStats)?Object.entries(i.dailyStats).map(e=>{let[s,t]=e;return{date:new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric"}),visits:t}}).sort((e,s)=>new Date(e.date).getTime()-new Date(s.date).getTime()):[];return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-center gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900",children:"\uD83D\uDCCA Attendance Analytics"}),(0,a.jsx)("p",{className:"text-sm sm:text-base lg:text-lg text-gray-600 mt-1 sm:mt-2",children:"Track patterns, insights, and generate reports"})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,a.jsxs)("select",{value:x,onChange:e=>m(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-base w-full sm:w-auto",children:[(0,a.jsx)("option",{value:"week",children:"Last 7 Days"}),(0,a.jsx)("option",{value:"month",children:"Last 30 Days"}),(0,a.jsx)("option",{value:"year",children:"Last Year"}),(0,a.jsx)("option",{value:"custom",children:"Custom Range"})]}),"custom"===x&&(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,a.jsx)("input",{type:"date",value:u,onChange:e=>h(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-base w-full sm:w-auto"}),(0,a.jsx)("input",{type:"date",value:g,onChange:e=>p(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-base w-full sm:w-auto"})]}),(0,a.jsxs)("button",{onClick:b,className:"flex items-center justify-center space-x-2 px-3 sm:px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm sm:text-base w-full sm:w-auto",children:[(0,a.jsx)(Y.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Refresh"})]})]})]}),o?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"text-gray-600 mt-4",children:"Loading analytics..."})]}):i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Visits"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:i.summary.totalVisits})]}),(0,a.jsx)("div",{className:"bg-blue-100 rounded-full p-3",children:(0,a.jsx)(C.Z,{className:"h-6 w-6 text-blue-600"})})]}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"week"===x?"Past 7 days":"month"===x?"Past 30 days":"year"===x?"Past year":"Custom period"})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Currently In Library"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-green-600",children:i.summary.activeVisitors})]}),(0,a.jsx)("div",{className:"bg-green-100 rounded-full p-3",children:(0,a.jsx)(eS.Z,{className:"h-6 w-6 text-green-600"})})]}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"Right now"})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Avg. Visit Duration"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-purple-600",children:j(i.summary.averageDuration)})]}),(0,a.jsx)("div",{className:"bg-purple-100 rounded-full p-3",children:(0,a.jsx)(A.Z,{className:"h-6 w-6 text-purple-600"})})]}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"Completed visits only"})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Completed Visits"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-orange-600",children:i.summary.completedVisits})]}),(0,a.jsx)("div",{className:"bg-orange-100 rounded-full p-3",children:(0,a.jsx)(eD.Z,{className:"h-6 w-6 text-orange-600"})})]}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:[Math.round(i.summary.completedVisits/i.summary.totalVisits*100),"% completion rate"]})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"\uD83D\uDCC8 Daily Attendance Trend"}),(0,a.jsx)(P.Z,{className:"h-5 w-5 text-gray-400"})]}),(0,a.jsx)("div",{className:"space-y-4",children:v().slice(-7).map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700 w-20",children:e.date}),(0,a.jsx)("div",{className:"flex-1 mx-4",children:(0,a.jsx)("div",{className:"bg-gray-200 rounded-full h-4 relative overflow-hidden",children:(0,a.jsx)("div",{className:"bg-blue-600 h-full rounded-full transition-all duration-500",style:{width:"".concat(Math.max(e.visits/Math.max(...v().map(e=>e.visits))*100,5),"%")}})})}),(0,a.jsx)("span",{className:"text-sm font-bold text-gray-900 w-12 text-right",children:e.visits})]},e.date))})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"\uD83C\uDFC6 Most Frequent Visitors"}),(0,a.jsx)(eD.Z,{className:"h-5 w-5 text-gray-400"})]}),(0,a.jsx)("div",{className:"space-y-3",children:i.topVisitors.slice(0,8).map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ".concat(0===s?"bg-yellow-100 text-yellow-800":1===s?"bg-gray-100 text-gray-800":2===s?"bg-orange-100 text-orange-800":"bg-blue-100 text-blue-800"),children:s+1}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:e.type})]})]}),(0,a.jsx)("div",{className:"text-right",children:(0,a.jsxs)("div",{className:"text-sm font-bold text-gray-900",children:[e.visits," visits"]})})]},e.id))})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"\uD83D\uDD50 Peak Hours Analysis"}),(0,a.jsx)(A.Z,{className:"h-5 w-5 text-gray-400"})]}),(0,a.jsx)("div",{className:"space-y-3",children:N().map((e,s)=>{var t;return(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ".concat(0===s?"bg-red-100 text-red-800":1===s?"bg-orange-100 text-orange-800":"bg-blue-100 text-blue-800"),children:s+1}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:e.timeSlot})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-20 bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"".concat(e.count/(null===(t=N()[0])||void 0===t?void 0:t.count)*100,"%")}})}),(0,a.jsx)("span",{className:"text-sm font-bold text-gray-900 w-8",children:e.count})]})]},e.hour)})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"\uD83D\uDC65 Visitor Type Breakdown"}),(0,a.jsx)(eA.Z,{className:"h-5 w-5 text-gray-400"})]}),(0,a.jsx)("div",{className:"space-y-4",children:i.typeBreakdown.map(e=>{let s=Math.round(e.count/i.summary.totalVisits*100);return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:[e.type,"s"]}),(0,a.jsxs)("span",{className:"text-sm font-bold text-gray-900",children:[e.count," (",s,"%)"]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3",children:(0,a.jsx)("div",{className:"h-3 rounded-full transition-all duration-500 ".concat("Member"===e.type?"bg-blue-600":"bg-green-600"),style:{width:"".concat(s,"%")}})})]},e.type)})}),0===i.typeBreakdown.length&&(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(eA.Z,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-500",children:"No visitor data available for this period"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"\uD83D\uDCC4 Export Reports"}),(0,a.jsx)(Q.Z,{className:"h-5 w-5 text-gray-400"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("button",{onClick:()=>y("pdf"),className:"flex items-center justify-center space-x-2 px-4 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[(0,a.jsx)(Q.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Export PDF Report"})]}),(0,a.jsxs)("button",{onClick:()=>y("excel"),className:"flex items-center justify-center space-x-2 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[(0,a.jsx)(Q.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Export Excel Data"})]}),(0,a.jsxs)("button",{onClick:()=>{let e=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),s=URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download="attendance-data-".concat(new Date().toISOString().split("T")[0],".json"),t.click(),URL.revokeObjectURL(s),ef.default.success("JSON data downloaded!")},className:"flex items-center justify-center space-x-2 px-4 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:[(0,a.jsx)(Q.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Export JSON Data"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"\uD83D\uDCA1 Insights & Recommendations"}),(0,a.jsx)(q.Z,{className:"h-5 w-5 text-gray-400"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"\uD83D\uDCCA Key Insights"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-blue-600 rounded-full mt-2"}),(0,a.jsxs)("p",{className:"text-sm text-gray-700",children:[(0,a.jsx)("span",{className:"font-semibold",children:"Busiest time:"})," ",(null===(e=N()[0])||void 0===e?void 0:e.timeSlot)||"No data","(",(null===(s=N()[0])||void 0===s?void 0:s.count)||0," visits)"]})]}),(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-green-600 rounded-full mt-2"}),(0,a.jsxs)("p",{className:"text-sm text-gray-700",children:[(0,a.jsx)("span",{className:"font-semibold",children:"Completion rate:"})," ",Math.round(i.summary.completedVisits/i.summary.totalVisits*100),"% of visitors properly sign out"]})]}),(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-purple-600 rounded-full mt-2"}),(0,a.jsxs)("p",{className:"text-sm text-gray-700",children:[(0,a.jsx)("span",{className:"font-semibold",children:"Average stay:"})," ",j(i.summary.averageDuration)," per visit"]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"\uD83C\uDFAF Recommendations"}),(0,a.jsxs)("div",{className:"space-y-3",children:[i.summary.completedVisits/i.summary.totalVisits<.8&&(0,a.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:(0,a.jsxs)("p",{className:"text-sm text-yellow-800",children:[(0,a.jsx)("span",{className:"font-semibold",children:"⚠️ Low sign-out rate:"})," Consider reminding visitors to sign out when leaving."]})}),N().length>0&&(0,a.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:(0,a.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,a.jsx)("span",{className:"font-semibold",children:"\uD83D\uDCCA Peak hours:"})," Consider having more staff during ",null===(t=N()[0])||void 0===t?void 0:t.timeSlot," for better service."]})}),(0,a.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:(0,a.jsxs)("p",{className:"text-sm text-green-800",children:[(0,a.jsx)("span",{className:"font-semibold",children:"✅ Good attendance:"})," ",i.summary.totalVisits," total visits show healthy library usage."]})})]})]})]})]})]}):(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(P.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No data available"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Try selecting a different time period or check if there are attendance records."})]})]})},eZ=t(6967),eI=t(8626);let eT=e=>{let{title:s,user:t,onSubmit:l,onClose:n}=e,[i,d]=(0,r.useState)(!1);return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:s}),(0,a.jsxs)("form",{onSubmit:e=>{var s,t,a,r;e.preventDefault();let n=new FormData(e.target),i={name:(null===(s=n.get("name"))||void 0===s?void 0:s.toString())||"",email:(null===(t=n.get("email"))||void 0===t?void 0:t.toString())||"",role:(null===(a=n.get("role"))||void 0===a?void 0:a.toString())||"LIBRARIAN"},c=null===(r=n.get("password"))||void 0===r?void 0:r.toString();c&&(i.password=c),l(i)},children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("input",{name:"name",defaultValue:(null==t?void 0:t.name)||"",placeholder:"Full Name",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"}),(0,a.jsx)("input",{name:"email",type:"email",defaultValue:(null==t?void 0:t.email)||"",placeholder:"Email Address",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"}),(0,a.jsxs)("select",{name:"role",defaultValue:(null==t?void 0:t.role)||"LIBRARIAN",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600",children:[(0,a.jsx)("option",{value:"ADMIN",children:"Admin"}),(0,a.jsx)("option",{value:"LIBRARIAN",children:"Librarian"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{name:"password",type:i?"text":"password",placeholder:t?"New Password (leave blank to keep current)":"Password",required:!t,className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"}),(0,a.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:(0,a.jsx)("button",{type:"button",onClick:()=>d(!i),className:"text-gray-400 hover:text-gray-600 focus:outline-none",children:i?(0,a.jsx)(c.Z,{className:"h-5 w-5"}):(0,a.jsx)(o.Z,{className:"h-5 w-5"})})})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,a.jsx)("button",{type:"button",onClick:n,className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:t?"Update User":"Create User"})]})]})]})})};var eB=()=>{let{hasPermission:e}=(0,l.a)(),[s,t]=(0,r.useState)([]),[n,i]=(0,r.useState)(!1),[c,o]=(0,r.useState)(""),[d,x]=(0,r.useState)("all"),[m,u]=(0,r.useState)(!1),[h,g]=(0,r.useState)(null);if(!e("all"))return(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(f.Z,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),(0,a.jsx)("p",{className:"text-gray-600",children:"You need admin privileges to access user management."})]})});(0,r.useEffect)(()=>{p()},[d]);let p=async()=>{try{if(i(!0),!eI.Z.isAuthenticated()){ef.default.error("Please log in to view users");return}let s=await eI.Z.get("/api/users?role=".concat(d));if(s.error)ef.default.error(s.error);else{var e;t((null===(e=s.data)||void 0===e?void 0:e.users)||[])}}catch(e){console.error("Error fetching users:",e),ef.default.error("Failed to fetch users")}finally{i(!1)}},b=async e=>{try{let a=await eI.Z.post("/api/users",e);a.error?ef.default.error(a.error):(t([a.data,...s]),u(!1),ef.default.success("User created successfully!"))}catch(e){console.error("Error creating user:",e),ef.default.error("Failed to create user")}},y=async e=>{if(h)try{let a=await eI.Z.put("/api/users/".concat(h.id),e);a.error?ef.default.error(a.error):(t(s.map(e=>e.id===a.data.id?a.data:e)),g(null),ef.default.success("User updated successfully!"))}catch(e){console.error("Error updating user:",e),ef.default.error("Failed to update user")}},j=async e=>{if(confirm("Are you sure you want to delete this user? This action cannot be undone."))try{let a=await eI.Z.delete("/api/users/".concat(e));a.error?ef.default.error(a.error):(t(s.filter(s=>s.id!==e)),ef.default.success("User deleted successfully!"))}catch(e){console.error("Error deleting user:",e),ef.default.error("Failed to delete user")}},N=s.filter(e=>e.name.toLowerCase().includes(c.toLowerCase())||e.email.toLowerCase().includes(c.toLowerCase())),v=e=>{switch(e){case"ADMIN":return(0,a.jsx)(S.Z,{className:"h-4 w-4 text-red-500"});case"LIBRARIAN":return(0,a.jsx)(eZ.Z,{className:"h-4 w-4 text-blue-500"});case"MEMBER":return(0,a.jsx)(L.Z,{className:"h-4 w-4 text-green-500"});default:return(0,a.jsx)(L.Z,{className:"h-4 w-4 text-gray-500"})}},w=e=>{switch(e){case"ADMIN":return"bg-red-100 text-red-800";case"LIBRARIAN":return"bg-blue-100 text-blue-800";case"MEMBER":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"User Management"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage admin and librarian accounts"})]}),(0,a.jsxs)("button",{onClick:()=>u(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[(0,a.jsx)(U.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Add User"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,a.jsxs)("div",{className:"flex-1 relative",children:[(0,a.jsx)(D.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,a.jsx)("input",{type:"text",placeholder:"Search users...",value:c,onChange:e=>o(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600"})]}),(0,a.jsx)("select",{value:d,onChange:e=>x(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600",children:["all","ADMIN","LIBRARIAN","MEMBER"].map(e=>(0,a.jsx)("option",{value:e,children:"all"===e?"All Roles":e.charAt(0)+e.slice(1).toLowerCase()},e))})]}),n?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"text-gray-600 mt-4",children:"Loading users..."})]}):(0,a.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:N.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,a.jsx)("div",{className:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center",children:(0,a.jsx)(C.Z,{className:"h-5 w-5 text-gray-600"})})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.email})]})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[v(e.role),(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(w(e.role)),children:e.role})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.createdAt).toLocaleDateString()}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex items-center justify-end space-x-2",children:[(0,a.jsx)("button",{onClick:()=>g(e),className:"text-blue-600 hover:text-blue-900",children:(0,a.jsx)($.Z,{className:"h-4 w-4"})}),e.id!==(null==e?void 0:e.id)&&(0,a.jsx)("button",{onClick:()=>j(e.id),className:"text-red-600 hover:text-red-900",children:(0,a.jsx)(X.Z,{className:"h-4 w-4"})})]})})]},e.id))})]})}),0===N.length&&!n&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(C.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No users found"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Try adjusting your search or filter criteria"})]}),m&&(0,a.jsx)(eT,{title:"Add New User",onSubmit:b,onClose:()=>u(!1)}),h&&(0,a.jsx)(eT,{title:"Edit User",user:h,onSubmit:y,onClose:()=>g(null)})]})},eR=t(3669),eL=()=>{let{state:e}=(0,V.y)(),{books:s,members:t,borrowings:l,attendance:n}=e,[i,c]=(0,r.useState)("30days"),d=s.length,x=t.length,m=l.filter(e=>"BORROWED"===e.status).length,u=l.filter(e=>new Date(e.dueDate)<new Date&&"BORROWED"===e.status).length,h=new Date(new Date().getTime()-2592e6),g=l.filter(e=>new Date(e.borrowDate)>=h).length,p=n.filter(e=>new Date(e.checkInTime)>=h).length,b=s.reduce((e,s)=>(e[s.category]=(e[s.category]||0)+1,e),{}),y=[{title:"Library Overview",icon:B.Z,stats:[{label:"Total Books",value:d,color:"text-blue-600"},{label:"Total Members",value:x,color:"text-green-600"},{label:"Active Loans",value:m,color:"text-yellow-600"},{label:"Overdue Books",value:u,color:"text-red-600"}]},{title:"Activity (Last 30 Days)",icon:q.Z,stats:[{label:"New Borrowings",value:g,color:"text-blue-600"},{label:"Library Visits",value:p,color:"text-green-600"},{label:"Available Books",value:d-m,color:"text-purple-600"},{label:"Return Rate",value:"94%",color:"text-orange-600"}]}];return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-center gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Reports & Analytics"}),(0,a.jsx)("p",{className:"text-sm sm:text-base text-gray-600 mt-1 sm:mt-2",children:"Library performance and usage statistics"})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,a.jsxs)("select",{value:i,onChange:e=>c(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-base w-full sm:w-auto",children:[(0,a.jsx)("option",{value:"7days",children:"Last 7 days"}),(0,a.jsx)("option",{value:"30days",children:"Last 30 days"}),(0,a.jsx)("option",{value:"90days",children:"Last 90 days"}),(0,a.jsx)("option",{value:"1year",children:"Last year"})]}),(0,a.jsxs)("button",{className:"bg-blue-600 text-white px-3 sm:px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center justify-center space-x-2 text-sm sm:text-base w-full sm:w-auto",children:[(0,a.jsx)(Q.Z,{className:"h-4 w-4 sm:h-5 sm:w-5"}),(0,a.jsx)("span",{children:"Export"})]})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:y.map((e,s)=>(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,a.jsx)(e.icon,{className:"h-6 w-6 text-blue-600"})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 ml-3",children:e.title})]}),(0,a.jsx)("div",{className:"space-y-3",children:e.stats.map((e,s)=>(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:e.label}),(0,a.jsx)("span",{className:"text-lg font-bold ".concat(e.color),children:e.value})]},s))})]},s))}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Books by Category"}),(0,a.jsx)("div",{className:"space-y-3",children:Object.entries(b).map(e=>{let[s,t]=e,r=t/d*100;return(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-600 capitalize",children:s}),(0,a.jsxs)("span",{className:"font-medium text-gray-900",children:[t," books"]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"".concat(r,"%")}})})]},s)})})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Activity"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,a.jsx)(B.Z,{className:"h-4 w-4 text-blue-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"New Book Added"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:'"The Great Gatsby" by F. Scott Fitzgerald'})]})]}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"2 hours ago"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,a.jsx)(C.Z,{className:"h-4 w-4 text-green-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"New Member Registered"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"John Doe joined the library"})]})]}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"4 hours ago"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-yellow-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"p-2 bg-yellow-100 rounded-lg",children:(0,a.jsx)(q.Z,{className:"h-4 w-4 text-yellow-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Book Returned"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:'"1984" by George Orwell'})]})]}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"6 hours ago"})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Detailed Reports"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{className:"p-2 text-gray-400 hover:text-gray-600",children:(0,a.jsx)(eR.Z,{className:"h-4 w-4"})}),(0,a.jsx)("button",{className:"p-2 text-gray-400 hover:text-gray-600",children:(0,a.jsx)(o.Z,{className:"h-4 w-4"})})]})]})}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Report Type"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Period"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Generated"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsxs)("tbody",{className:"bg-white divide-y divide-gray-200",children:[(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"Borrowing Report"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"Last 30 days"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date().toLocaleDateString()}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,a.jsx)("button",{className:"text-blue-600 hover:text-blue-900",children:"View"})})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"Member Activity"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"Last 30 days"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date().toLocaleDateString()}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,a.jsx)("button",{className:"text-blue-600 hover:text-blue-900",children:"View"})})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"Overdue Books"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"Current"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date().toLocaleDateString()}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,a.jsx)("button",{className:"text-blue-600 hover:text-blue-900",children:"View"})})]})]})]})})]})]})},eP=t(2543),eM=t(5956),eO=t(6339),eF=t(1456),eV=t(4767),eU=t(6746);class ez{isChannelEnabled(e){return this.settings[e]||!1}isNotificationEnabled(e){return this.settings[e]||!1}isInQuietHours(){if(!this.settings.quietHours.enabled)return!1;let e=new Date,s=60*e.getHours()+e.getMinutes(),[t,a]=this.settings.quietHours.start.split(":").map(Number),[r,l]=this.settings.quietHours.end.split(":").map(Number),n=60*t+a,i=60*r+l;return n>i?s>=n||s<=i:s>=n&&s<=i}async sendEmailNotification(e,s,t){if(!this.isChannelEnabled("email")||this.isInQuietHours())return!1;try{return console.log("\uD83D\uDCE7 Email sent to ".concat(e,": ").concat(s)),console.log("Message: ".concat(t)),(await fetch("/api/notifications/email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:e,subject:s,message:t})})).ok}catch(e){return console.error("Failed to send email notification:",e),!1}}async sendSMSNotification(e,s){if(!this.isChannelEnabled("sms")||this.isInQuietHours())return!1;try{return console.log("\uD83D\uDCF1 SMS sent to ".concat(e,": ").concat(s)),(await fetch("/api/notifications/sms",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:e,message:s})})).ok}catch(e){return console.error("Failed to send SMS notification:",e),!1}}async sendPushNotification(e,s,t){if(!this.isChannelEnabled("push")||this.isInQuietHours())return!1;try{if(!("Notification"in window))return console.warn("This browser does not support notifications"),!1;if("default"===Notification.permission){let e=await Notification.requestPermission();if("granted"!==e)return console.warn("Notification permission denied"),!1}if("granted"===Notification.permission){let a=new Notification(e,{body:s,icon:"/favicon.ico",data:t});return setTimeout(()=>a.close(),5e3),!0}return!1}catch(e){return console.error("Failed to send push notification:",e),!1}}async sendNotification(e,s,t,a){if(!this.isNotificationEnabled(e))return{email:!1,sms:!1,push:!1};let r={email:!1,sms:!1,push:!1};return this.isChannelEnabled("email")&&(null==a?void 0:a.email)&&(r.email=await this.sendEmailNotification(a.email,s,t)),this.isChannelEnabled("sms")&&(null==a?void 0:a.phone)&&(r.sms=await this.sendSMSNotification(a.phone,t)),this.isChannelEnabled("push")&&(r.push=await this.sendPushNotification(s,t)),r}updateSettings(e){this.settings={...this.settings,...e}}getSettings(){return{...this.settings}}constructor(e){this.settings=e}}let eq=()=>{var e;let{user:s}=(0,l.a)(),[t,a]=(0,r.useState)(null);(0,r.useEffect)(()=>{var e;a(new ez((null==s?void 0:null===(e=s.settings)||void 0===e?void 0:e.notifications)||{email:!0,sms:!0,push:!0,overdue:!0,reservations:!0,newBooks:!0,systemUpdates:!0,borrowingReminders:!0,returnReminders:!0,overdueAlerts:!0,frequency:"immediate",quietHours:{enabled:!1,start:"22:00",end:"08:00"},emailSettings:{overdueReminders:!0,reservationAlerts:!0,borrowingConfirmations:!0,returnReminders:!0}}))},[null==s?void 0:null===(e=s.settings)||void 0===e?void 0:e.notifications]);let n=(0,r.useCallback)(async()=>"Notification"in window?"granted"===Notification.permission||("denied"===Notification.permission?(ef.default.error("Notification permission denied. Please enable notifications in your browser settings."),!1):"granted"===await Notification.requestPermission()?(ef.default.success("✅ Notification permission granted!"),!0):(ef.default.error("❌ Notification permission denied"),!1)):(ef.default.error("This browser does not support notifications"),!1),[]),i=(0,r.useCallback)(async(e,s,a,r)=>{if(!t){console.warn("Notification service not initialized");return}try{let l=await t.sendNotification(e,s,a,r),n=Object.values(l).filter(Boolean).length;n>0?ef.default.success("✅ Notification sent via ".concat(n," channel(s)")):ef.default.error("❌ Failed to send notification")}catch(e){console.error("Error sending notification:",e),ef.default.error("❌ Error sending notification")}},[t]),c=(0,r.useCallback)(async()=>{if(!t){ef.default.error("Notification service not initialized");return}try{await t.sendEmailNotification((null==s?void 0:s.email)||"test@example.com","Test Email Notification","This is a test email notification from the library management system.")?ef.default.success("✅ Test email notification sent successfully!"):ef.default.error("❌ Failed to send test email notification")}catch(e){ef.default.error("❌ Error sending test email notification")}},[t,null==s?void 0:s.email]),o=(0,r.useCallback)(async()=>{if(!t){ef.default.error("Notification service not initialized");return}try{await t.sendSMSNotification((null==s?void 0:s.phone)||"+1234567890","Test SMS notification from library system")?ef.default.success("✅ Test SMS notification sent successfully!"):ef.default.error("❌ Failed to send test SMS notification")}catch(e){ef.default.error("❌ Error sending test SMS notification")}},[t,null==s?void 0:s.phone]),d=(0,r.useCallback)(async()=>{if(!t){ef.default.error("Notification service not initialized");return}try{await t.sendPushNotification("Test Push Notification","This is a test push notification from the library management system.")?ef.default.success("✅ Test push notification sent successfully!"):ef.default.error("❌ Failed to send test push notification")}catch(e){ef.default.error("❌ Error sending test push notification")}},[t]);return{notificationService:t,sendNotification:i,testEmailNotification:c,testSMSNotification:o,testPushNotification:d,requestNotificationPermission:n}},eY=()=>{let{sendNotification:e}=eq(),{user:s}=(0,l.a)();return{notifyBookBorrowed:async(t,a,r)=>{await e("borrowingReminders","\uD83D\uDCDA Book Borrowed","".concat(a,' has borrowed "').concat(t,'". Due date: ').concat(r),{email:null==s?void 0:s.email})},notifyBookReturned:async(t,a)=>{await e("returnReminders","\uD83D\uDCD6 Book Returned","".concat(a,' has returned "').concat(t,'"'),{email:null==s?void 0:s.email})},notifyBookOverdue:async(t,a,r)=>{await e("overdueAlerts","⚠️ Book Overdue",'"'.concat(t,'" borrowed by ').concat(a," is ").concat(r," days overdue"),{email:null==s?void 0:s.email,phone:null==s?void 0:s.phone})},notifyNewBookAdded:async(t,a)=>{await e("newBooks","\uD83C\uDD95 New Book Added",'New book "'.concat(t,'" by ').concat(a," has been added to the library"),{email:null==s?void 0:s.email})},notifyReservationMade:async(t,a)=>{await e("reservations","\uD83D\uDCCB Book Reserved","".concat(a,' has reserved "').concat(t,'"'),{email:null==s?void 0:s.email})},notifyReservationReady:async(t,a)=>{await e("reservations","✅ Reservation Ready",'"'.concat(t,'" is now available for ').concat(a),{email:null==s?void 0:s.email,phone:null==s?void 0:s.phone})},notifySystemUpdate:async t=>{await e("systemUpdates","⚙️ System Update",t,{email:null==s?void 0:s.email})},notifyMaintenance:async t=>{await e("systemUpdates","\uD83D\uDD27 System Maintenance",t,{email:null==s?void 0:s.email})},notifyReminder:async function(t,a){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"borrowingReminders";await e(r,"\uD83D\uDD14 ".concat(t),a,{email:null==s?void 0:s.email,phone:null==s?void 0:s.phone})}}};var eJ=()=>{let{notificationService:e,testEmailNotification:s,testSMSNotification:t,testPushNotification:l,requestNotificationPermission:n}=eq(),{notifyBookBorrowed:i,notifyBookReturned:c,notifyBookOverdue:o,notifyNewBookAdded:d,notifyReservationMade:x}=eY(),[m,u]=(0,r.useState)([]),[g,p]=(0,r.useState)(!1),[b,y]=(0,r.useState)(!0);(0,r.useEffect)(()=>{e&&y(!1)},[e]);let f=e=>{let s={...e,id:Date.now().toString(),timestamp:new Date};u(e=>[s,...e.slice(0,49)])},N=async()=>{p(!0);try{await s(),f({type:"email",title:"Test Email Notification",message:"This is a test email notification",status:"sent",channels:{email:!0,sms:!1,push:!1}}),await t(),f({type:"sms",title:"Test SMS Notification",message:"This is a test SMS notification",status:"sent",channels:{email:!1,sms:!0,push:!1}}),await l(),f({type:"push",title:"Test Push Notification",message:"This is a test push notification",status:"sent",channels:{email:!1,sms:!1,push:!0}}),await i("Test Book","John Doe","2025-10-23"),f({type:"borrowingReminders",title:"Book Borrowed",message:'John Doe has borrowed "Test Book"',status:"sent",channels:{email:!0,sms:!1,push:!0}}),await d("New Test Book","Test Author"),f({type:"newBooks",title:"New Book Added",message:'New book "New Test Book" by Test Author has been added',status:"sent",channels:{email:!0,sms:!1,push:!0}})}catch(e){console.error("Error testing notifications:",e)}finally{p(!1)}},v=e=>{switch(e){case"sent":return(0,a.jsx)(j.Z,{className:"w-4 h-4 text-green-500"});case"failed":return(0,a.jsx)(eg.Z,{className:"w-4 h-4 text-red-500"});case"pending":return(0,a.jsx)(A.Z,{className:"w-4 h-4 text-yellow-500"});default:return(0,a.jsx)(A.Z,{className:"w-4 h-4 text-gray-500"})}},w=e=>{switch(e){case"email":return(0,a.jsx)(eF.Z,{className:"w-3 h-3 text-blue-500"});case"sms":return(0,a.jsx)(eV.Z,{className:"w-3 h-3 text-green-500"});case"push":return(0,a.jsx)(eU.Z,{className:"w-3 h-3 text-purple-500"});default:return null}};return b?(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-6 h-6 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),(0,a.jsx)("span",{className:"text-gray-600",children:"Initializing notification service..."})]})})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(h.Z,{className:"w-6 h-6 text-blue-600"}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Notification Dashboard"})]}),(0,a.jsx)("button",{onClick:N,disabled:g,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:g?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),(0,a.jsx)("span",{children:"Testing..."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Test All Notifications"})]})})]}),e&&(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Current Settings"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(eF.Z,{className:"w-5 h-5 text-blue-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Email Notifications"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:e.isChannelEnabled("email")?"Enabled":"Disabled"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(eV.Z,{className:"w-5 h-5 text-green-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"SMS Notifications"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:e.isChannelEnabled("sms")?"Enabled":"Disabled"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(eU.Z,{className:"w-5 h-5 text-purple-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Push Notifications"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:e.isChannelEnabled("push")?"Enabled":"Disabled"})]})]})]}),e.isInQuietHours()&&(0,a.jsx)("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,a.jsx)("p",{className:"text-sm text-yellow-800",children:"\uD83D\uDD15 Currently in quiet hours - notifications are suppressed"})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200",children:[(0,a.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Notifications"})}),(0,a.jsx)("div",{className:"divide-y divide-gray-200",children:0===m.length?(0,a.jsxs)("div",{className:"p-6 text-center text-gray-500",children:[(0,a.jsx)(h.Z,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),(0,a.jsx)("p",{children:"No notifications sent yet"}),(0,a.jsx)("p",{className:"text-sm",children:'Click "Test All Notifications" to see how notifications work'})]}):m.map(e=>(0,a.jsx)("div",{className:"p-6 hover:bg-gray-50",children:(0,a.jsx)("div",{className:"flex items-start justify-between",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[v(e.status),(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-900",children:e.title}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:e.timestamp.toLocaleTimeString()})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:e.message}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"Channels:"}),Object.entries(e.channels).map(e=>{let[s,t]=e;return t&&(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[w(s),(0,a.jsx)("span",{className:"text-xs text-gray-600 capitalize",children:s})]},s)})]}),(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:["Type: ",e.type]})]})]})})},e.id))})]})]})},eG=()=>{let[e,s]=(0,r.useState)("general"),[t,l]=(0,r.useState)(!1),[i,d]=(0,r.useState)(!1),[x,m]=(0,r.useState)({current:!1,new:!1,confirm:!1}),{testEmailNotification:u,testSMSNotification:p,testPushNotification:b,requestNotificationPermission:y}=eq(),[j,f]=(0,r.useState)({libraryName:"Robert Aboagye Mensah Community Library",libraryAddress:"",libraryEmail:"",libraryPhone:"",maxBorrowDays:14,maxBooksPerMember:5,overdueFinePerDay:.5,notifications:{email:!0,sms:!1,push:!0,overdue:!0,reservations:!0,newBooks:!0,systemUpdates:!0,borrowingReminders:!0,returnReminders:!0,overdueAlerts:!0,frequency:"immediate",quietHours:{enabled:!1,start:"22:00",end:"08:00"},emailSettings:{overdueReminders:!0,weeklyDigest:!1,systemAlerts:!0,marketingEmails:!1}},theme:"light",language:"en"}),[N,v]=(0,r.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),w=[{id:"general",label:"General",icon:g.Z},{id:"borrowing",label:"Borrowing Rules",icon:n.Z},{id:"notifications",label:"Notifications",icon:h.Z},{id:"security",label:"Security",icon:S.Z},{id:"backup",label:"Backup & Export",icon:es.Z},{id:"appearance",label:"Appearance",icon:eP.Z}];(0,r.useEffect)(()=>{k()},[]),(0,r.useEffect)(()=>{localStorage.setItem("theme",j.theme),document.documentElement.setAttribute("data-theme",j.theme),"dark"===j.theme?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[j.theme]);let k=async()=>{l(!0);try{let e=await fetch("/api/settings");if(e.ok){let s=await e.json();f(s)}else ef.default.error("Failed to load settings")}catch(e){console.error("Error loading settings:",e),ef.default.error("Failed to load settings")}finally{l(!1)}},C=(e,s)=>{if(e.includes(".")){let[t,a]=e.split(".");f(e=>({...e,[t]:{...e[t],[a]:s}}))}else f(t=>({...t,[e]:s}))},D=async()=>{if(!j.libraryName.trim()){ef.default.error("Library name is required");return}if(j.maxBorrowDays<1){ef.default.error("Maximum borrow days must be at least 1");return}if(j.maxBooksPerMember<1){ef.default.error("Maximum books per member must be at least 1");return}if(j.overdueFinePerDay<0){ef.default.error("Overdue fine cannot be negative");return}d(!0);try{let e=await fetch("/api/settings",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(j)});if(e.ok){let s=await e.json();f(s),ef.default.success("Settings saved successfully!")}else{let s=await e.json();ef.default.error(s.error||"Failed to save settings")}}catch(e){console.error("Error saving settings:",e),ef.default.error("Failed to save settings. Please check your connection.")}finally{d(!1)}},A=async()=>{try{let e=await fetch("/api/settings/backup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"export"})});if(e.ok){let s=await e.blob(),t=window.URL.createObjectURL(s),a=document.createElement("a");a.href=t,a.download="library-export-".concat(new Date().toISOString().split("T")[0],".json"),a.style.display="none",document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(t),document.body.removeChild(a),ef.default.success("Library data exported successfully!")}else{let s=await e.json();ef.default.error(s.error||"Failed to export data")}}catch(e){console.error("Error exporting data:",e),ef.default.error("Failed to export data. Please check your connection.")}},E=async()=>{try{let e=await fetch("/api/settings/backup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"backup"})});if(e.ok){let s=await e.blob(),t=window.URL.createObjectURL(s),a=document.createElement("a");a.href=t,a.download="library-backup-".concat(new Date().toISOString().replace(/[:.]/g,"-"),".json"),a.style.display="none",document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(t),document.body.removeChild(a),ef.default.success("Backup created successfully!")}else{let s=await e.json();ef.default.error(s.error||"Failed to create backup")}}catch(e){console.error("Error creating backup:",e),ef.default.error("Failed to create backup. Please check your connection.")}},Z=async e=>{if(e.preventDefault(),N.newPassword!==N.confirmPassword){ef.default.error("New passwords do not match");return}if(N.newPassword.length<6){ef.default.error("New password must be at least 6 characters long");return}try{let e=await fetch("/api/auth/change-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:N.currentPassword,newPassword:N.newPassword})});if(e.ok)ef.default.success("Password changed successfully!"),v({currentPassword:"",newPassword:"",confirmPassword:""});else{let s=await e.json();ef.default.error(s.error||"Failed to change password")}}catch(e){console.error("Error changing password:",e),ef.default.error("Failed to change password")}},I=e=>{m(s=>({...s,[e]:!s[e]}))},T=()=>(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Library Name *"}),(0,a.jsx)("input",{type:"text",value:j.libraryName,onChange:e=>C("libraryName",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Library Address"}),(0,a.jsx)("textarea",{rows:3,value:j.libraryAddress,onChange:e=>C("libraryAddress",e.target.value),placeholder:"Enter library address...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsx)("div",{children:(0,a.jsx)("input",{type:"email",value:j.libraryEmail,onChange:e=>C("libraryEmail",e.target.value),placeholder:"Email address",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})}),(0,a.jsx)("div",{children:(0,a.jsx)("input",{type:"tel",value:j.libraryPhone,onChange:e=>C("libraryPhone",e.target.value),placeholder:"Phone number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white"})})]})]})]}),B=()=>(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Maximum Borrow Days *"}),(0,a.jsx)("input",{type:"number",min:"1",value:j.maxBorrowDays,onChange:e=>C("maxBorrowDays",parseInt(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",required:!0}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Number of days a book can be borrowed"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Maximum Books Per Member *"}),(0,a.jsx)("input",{type:"number",min:"1",value:j.maxBooksPerMember,onChange:e=>C("maxBooksPerMember",parseInt(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",required:!0}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Maximum number of books a member can borrow at once"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Overdue Fine Per Day ($) *"}),(0,a.jsx)("input",{type:"number",step:"0.01",min:"0",value:j.overdueFinePerDay,onChange:e=>C("overdueFinePerDay",parseFloat(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",required:!0}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Fine amount charged per day for overdue books"})]})]}),R=()=>(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Change Password"}),(0,a.jsxs)("form",{onSubmit:Z,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Password"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:x.current?"text":"password",value:N.currentPassword,onChange:e=>v(s=>({...s,currentPassword:e.target.value})),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",required:!0}),(0,a.jsx)("button",{type:"button",onClick:()=>I("current"),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:x.current?(0,a.jsx)(c.Z,{className:"h-5 w-5 text-gray-400"}):(0,a.jsx)(o.Z,{className:"h-5 w-5 text-gray-400"})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:x.new?"text":"password",value:N.newPassword,onChange:e=>v(s=>({...s,newPassword:e.target.value})),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",required:!0,minLength:6}),(0,a.jsx)("button",{type:"button",onClick:()=>I("new"),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:x.new?(0,a.jsx)(c.Z,{className:"h-5 w-5 text-gray-400"}):(0,a.jsx)(o.Z,{className:"h-5 w-5 text-gray-400"})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm New Password"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:x.confirm?"text":"password",value:N.confirmPassword,onChange:e=>v(s=>({...s,confirmPassword:e.target.value})),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",required:!0,minLength:6}),(0,a.jsx)("button",{type:"button",onClick:()=>I("confirm"),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:x.confirm?(0,a.jsx)(c.Z,{className:"h-5 w-5 text-gray-400"}):(0,a.jsx)(o.Z,{className:"h-5 w-5 text-gray-400"})})]})]}),(0,a.jsxs)("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2",children:[(0,a.jsx)(S.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Change Password"})]})]})]})}),L=()=>(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Backup & Export"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"p-4 border border-gray-200 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,a.jsx)(Q.Z,{className:"h-8 w-8 text-green-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Export Library Data"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Download all library data as JSON"})]})]}),(0,a.jsxs)("button",{onClick:A,className:"w-full bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center justify-center space-x-2",children:[(0,a.jsx)(Q.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Export Data"})]})]}),(0,a.jsxs)("div",{className:"p-4 border border-gray-200 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,a.jsx)(es.Z,{className:"h-8 w-8 text-blue-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Create Backup"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Create a complete backup with timestamp"})]})]}),(0,a.jsxs)("button",{onClick:E,className:"w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center justify-center space-x-2",children:[(0,a.jsx)(es.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Create Backup"})]})]})]})]})}),P=()=>(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Appearance"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Theme"}),(0,a.jsxs)("select",{value:j.theme,onChange:e=>C("theme",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",children:[(0,a.jsx)("option",{value:"light",children:"Light"}),(0,a.jsx)("option",{value:"dark",children:"Dark"}),(0,a.jsx)("option",{value:"auto",children:"Auto (System)"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Language"}),(0,a.jsxs)("select",{value:j.language,onChange:e=>C("language",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-gray-900 bg-white",children:[(0,a.jsx)("option",{value:"en",children:"English"}),(0,a.jsx)("option",{value:"es",children:"Espa\xf1ol"}),(0,a.jsx)("option",{value:"fr",children:"Fran\xe7ais"}),(0,a.jsx)("option",{value:"de",children:"Deutsch"})]})]})]})]})});return t?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 space-y-4",children:[(0,a.jsx)(eM.Z,{className:"h-8 w-8 animate-spin text-blue-600"}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-gray-600 font-medium",children:"Loading settings..."}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Please wait while we fetch your preferences"})]})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-center gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl lg:text-3xl font-bold text-gray-900",children:"Settings"}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:"Manage your library system preferences"})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,a.jsxs)("button",{onClick:D,disabled:i,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2 w-full sm:w-auto justify-center",children:[i?(0,a.jsx)(eM.Z,{className:"h-5 w-5 animate-spin"}):(0,a.jsx)(eO.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:i?"Saving...":"Save Changes"})]}),(0,a.jsxs)("button",{onClick:k,disabled:t,className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2 w-full sm:w-auto justify-center",children:[t?(0,a.jsx)(eM.Z,{className:"h-5 w-5 animate-spin"}):(0,a.jsx)(Y.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Reset"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,a.jsx)("div",{className:"lg:col-span-1",children:(0,a.jsx)("nav",{className:"space-y-1",children:w.map(t=>{let r=t.icon;return(0,a.jsxs)("button",{onClick:()=>s(t.id),className:"w-full flex items-center space-x-3 px-3 py-2 text-left rounded-lg transition-colors ".concat(e===t.id?"bg-blue-100 text-blue-700":"text-gray-700 hover:bg-gray-100"),children:[(0,a.jsx)(r,{className:"h-5 w-5"}),(0,a.jsx)("span",{className:"font-medium",children:t.label})]},t.id)})})}),(0,a.jsx)("div",{className:"lg:col-span-3",children:(0,a.jsx)("div",{className:"bg-white p-4 lg:p-6 rounded-lg shadow-sm border border-gray-200",children:(()=>{switch(e){case"general":default:return T();case"borrowing":return B();case"notifications":return(0,a.jsx)(eJ,{});case"security":return R();case"backup":return L();case"appearance":return P()}})()})})]})]})};function eW(){let[e,s]=(0,r.useState)("dashboard"),[t,n]=(0,r.useState)(!1),{state:i}=(0,l.a)();return(0,r.useEffect)(()=>{let e=()=>{window.innerWidth>=768&&n(!1)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,a.jsxs)(x,{children:[(0,a.jsx)(F,{}),(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(I,{onNavigate:(e,t)=>{s(e),n(!1),t&&(sessionStorage.setItem("highlightPersonId",t),setTimeout(()=>{let e=document.getElementById("person-".concat(t));e&&(e.scrollIntoView({behavior:"smooth",block:"center"}),e.classList.add("bg-yellow-100","border-yellow-300","border-2"),setTimeout(()=>{e.classList.remove("bg-yellow-100","border-yellow-300","border-2")},3e3))},500))},onMenuToggle:()=>n(!t),isSidebarOpen:t}),t&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden",onClick:()=>n(!1)}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"\n            ".concat(t?"translate-x-0":"-translate-x-full","\n            md:translate-x-0\n            fixed md:relative \n            z-50 md:z-auto\n            transition-transform duration-300 ease-in-out\n            w-64\n          "),children:(0,a.jsx)(O,{activePage:e,setActivePage:e=>{s(e),n(!1)},onClose:()=>n(!1)})}),(0,a.jsx)("main",{className:"flex-1 p-4 md:p-6 min-h-screen",children:(()=>{switch(e){case"dashboard":default:return(0,a.jsx)(G,{});case"catalog":return(0,a.jsx)(eu,{});case"people":return(0,a.jsx)(eN,{});case"borrowing":return(0,a.jsx)(ev,{});case"attendance":return(0,a.jsx)(eC,{});case"tracking":return(0,a.jsx)(eE,{});case"users":return(0,a.jsx)(eB,{});case"reports":return(0,a.jsx)(eL,{});case"settings":return(0,a.jsx)(eG,{})}})()})]})]})]})}}},function(e){e.O(0,[64,355,997,971,117,744],function(){return e(e.s=350)}),_N_E=e.O()}]);